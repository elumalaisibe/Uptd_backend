/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../layers/support/fieldUtils","./Renderer","./mixins/VisualVariablesMixin","./support/DictionaryLoader"],(function(e,r,t,i,s,o,n,a,l,c,p){"use strict";var u;let d=u=function(r){function i(e){var t;return(t=r.call(this,e)||this).config=null,t.fieldMap=null,t.scaleExpression=null,t.scaleExpressionTitle=null,t.url=null,t.type="dictionary",t}e._inherits(i,r);var s=i.prototype;return s.writeData=function(e,r){e&&(r.scalingExpressionInfo={expression:e,returnType:"number"})},s.writeVisualVariables=function(r,t,s,o){o?.origin||e._get(e._getPrototypeOf(i.prototype),"writeVisualVariables",this).call(this,r,t,s,o)},s.clone=function(){return new u({config:t.clone(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:t.clone(this.fieldMap),url:t.clone(this.url),visualVariables:t.clone(this.visualVariables)})},s.getSymbolAsync=async function(e,r){return this._loader.getSymbolAsync(e,r)},s.collectRequiredFields=async function(e,r){await this.collectVVRequiredFields(e,r),this.scaleExpression&&await a.collectArcadeFieldNames(e,r,this.scaleExpression);for(const t in this.fieldMap){const i=this.fieldMap[t];r.has(i)&&e.add(i)}},s.getSymbol=function(){return null},s.getSymbols=function(){return[]},s.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(((e,r)=>e+r.getAttributeHash()),"")},s.getMeshHash=function(){return`${this.url}-${JSON.stringify(this.fieldMap)}`},s.getSymbolFields=function(){return this._loader.getSymbolFields()},e._createClass(i,[{key:"_loader",get:function(){return new p.DictionaryLoader(this.url,this.config,this.fieldMap)}},{key:"arcadeRequired",get:function(){return!0}}]),i}(c.VisualVariablesMixin(l));r.__decorate([i.property({type:p.DictionaryLoader})],d.prototype,"_loader",null),r.__decorate([i.property({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],d.prototype,"config",void 0),r.__decorate([i.property({type:Object,json:{write:!0}})],d.prototype,"fieldMap",void 0),r.__decorate([i.property({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],d.prototype,"scaleExpression",void 0),r.__decorate([n.writer("scaleExpression")],d.prototype,"writeData",null),r.__decorate([i.property({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],d.prototype,"scaleExpressionTitle",void 0),r.__decorate([i.property({type:String,json:{write:!0}})],d.prototype,"url",void 0),r.__decorate([n.writer("visualVariables")],d.prototype,"writeVisualVariables",null),d=u=r.__decorate([o.subclass("esri.renderers.DictionaryRenderer")],d);return d}));
