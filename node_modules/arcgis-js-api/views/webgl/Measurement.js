/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe","./capabilities/DisjointTimerQuery"],(function(e,t,i,r){"use strict";function s(e){const t=e.capabilities.disjointTimerQuery;return null==t?null:t.timestampBits()>0?new n(t):r.hasRunningElapsedTimer?null:new u(t)}let u=function(){function e(e){this._timer=e,this._timer.disjoint(),this._query=this._timer.createQuery(),this._timer.beginTimeElapsed(this._query)}var r=e.prototype;return r.stop=function(e,t=50){this._timer.endTimeElapsed(),this._checkQueryResult(e,t)},r.abort=function(){this._deleteQuery()},r._deleteQuery=function(){this._query&&(this._timer.deleteQuery(this._query),this._query=null)},r._checkQueryResult=function(e,t){if(this._timer.disjoint())return this._deleteQuery(),void e(null);const r=i.unwrapOrThrow(this._query);if(!this._timer.resultAvailable(r))return void setTimeout((()=>this._checkQueryResult(e,t)),t);const s=this._timer.getResult(r);this._deleteQuery(),e(s/1e6)},t._createClass(e)}(),n=function(){function e(e){this._timer=e,this._timer.disjoint(),this._start=this._timer.createQuery(),this._end=this._timer.createQuery(),this._timer.createTimestamp(this._start)}var r=e.prototype;return r.abort=function(){this._deleteQueries()},r.stop=function(e,t=50){this._timer.createTimestamp(i.unwrapOrThrow(this._end)),this._checkQueryResult(e,t)},r._deleteQueries=function(){this._start&&(this._timer.deleteQuery(this._start),this._start=null),this._end&&(this._timer.deleteQuery(this._end),this._end=null)},r._checkQueryResult=function(e,t){if(this._timer.disjoint())return this._deleteQueries(),void e(null);if(!(this._end&&this._timer.resultAvailable(this._end)))return void setTimeout((()=>this._checkQueryResult(e,t)),t);const r=this._timer.getResult(i.unwrapOrThrow(this._start)),s=this._timer.getResult(i.unwrapOrThrow(this._end));this._deleteQueries(),e((s-r)/1e6)},t._createClass(e)}();e.startMeasurement=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
