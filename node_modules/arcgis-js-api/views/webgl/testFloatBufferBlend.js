/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../3d/webgl-engine/lib/OrderIndependentTransparency","./BufferObject","./contextUtils","./enums","./FramebufferObject","./renderState","./TextureDescriptor","./VertexArrayObject","./VertexElementDescriptor","./WebGLDriverTestModule"],(function(e,t,r,n,o,i,a,s,l,p,u,c){"use strict";let b=function(e){function c(r){var n;if((n=e.call(this)||this)._rctx=r,!r.gl)return t._possibleConstructorReturn(n);if(r.type===o.ContextType.WEBGL1)return n._result=!(!r.capabilities.textureFloat?.textureFloat||!r.capabilities.colorBufferFloat?.textureFloat),t._possibleConstructorReturn(n);if(!(r.capabilities.textureFloat?.textureFloat&&r.capabilities.colorBufferFloat?.textureFloat&&r.capabilities.colorBufferFloat?.floatBlend))return t._possibleConstructorReturn(n);const i="\n    precision highp float;\n    attribute vec2 a_pos;\n\n    void main() {\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",a="\n     precision highp float;\n\n     void main() {\n      gl_FragColor = vec4(0.5, 0.5, 0.5, 0.5);\n     }\n    ";return n._program=r.programCache.acquire(i,a,new Map([["a_pos",0]])),n}return t._inherits(c,e),c.prototype._test=function(e){const t=this._rctx,o=new l.TextureDescriptor(1);o.wrapMode=i.TextureWrapMode.CLAMP_TO_EDGE,o.dataType=i.PixelType.FLOAT,o.internalFormat=i.SizedPixelFormat.RGBA32F,o.samplingMode=i.TextureSamplingMode.NEAREST;const c=new a.FramebufferObject(t,o),b=n.BufferObject.createVertex(t,i.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),f=new p.VertexArrayObject(t,new Map([["a_pos",0]]),{geometry:[new u.VertexElementDescriptor("a_pos",2,i.DataType.UNSIGNED_SHORT,0,4)]},{geometry:b});t.useProgram(e);const d=t.getBoundFramebufferObject(),{x:g,y:_,width:T,height:m}=t.getViewport();t.bindFramebuffer(c),t.setViewport(0,0,1,1),t.bindVAO(f),t.drawArrays(i.PrimitiveType.TRIANGLE_STRIP,0,4);const x=s.makePipelineState({blending:r.blendingAlpha});t.setPipelineState(x),t.drawArrays(i.PrimitiveType.TRIANGLE_STRIP,0,4);const F=t.gl.getError();return t.setViewport(g,_,T,m),t.bindFramebuffer(d),f.dispose(),c.dispose(),1282!==F||(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1)},t._createClass(c)}(c.WebGLDriverTestModule);e.FloatBufferBlend=b,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
