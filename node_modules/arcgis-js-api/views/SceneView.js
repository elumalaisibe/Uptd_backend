/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../Camera","../geometry","../Graphic","../Viewpoint","../core/Collection","../core/domUtils","../core/Error","../core/events","../core/handleUtils","../core/has","../core/iteratorUtils","../core/Logger","../core/maybe","../core/ObservableChangesType","../core/promiseUtils","../core/reactiveUtils","../core/scheduling","../core/screenUtils","../core/workers/workers","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/accessorSupport/decorators/subclass","../core/accessorSupport/ensureType","../chunks/vec3f64","../core/support/OwningCollection","../geometry/HeightModelInfo","../geometry/projection","../geometry/support/aaBoundingRect","../chunks/boundedPlane","../geometry/support/coordinateSystem","../geometry/support/scaleUtils","../layers/LayerConstants","../layers/support/layerUtils","../support/AnalysesCollection","./BreakpointsOwner","./DOMContainer","./GroundView","./PopupView","./View","./ViewAnimation","./ViewingMode","./3d/layerViewModuleImportUtils","./3d/analysis/AnalysisViewManager3D","./3d/constraints/Constraints","./3d/environment/SceneViewEnvironment","./3d/environment/SceneViewEnvironmentManager","./3d/input/SceneInputManager","./3d/layers/graphics/GraphicsDeconflictor","./3d/layers/graphics/Labeler","./3d/layers/support/FeatureTileTree3D","./3d/state/ViewState","./3d/state/ViewStateManager","./3d/state/helpers/SceneIntersectionHelper","./3d/support/CombinedElevationProvider","./3d/support/debugFlags","./3d/support/DisplayQualityProfile","./3d/support/ElevationProvider","./3d/support/HighlightOptions","./3d/support/MapCoordsHelper","./3d/support/PropertiesPool","./3d/support/QualitySettings","./3d/support/RenderCoordsHelper","./3d/support/ResourceController","./3d/support/SceneViewPerformanceInfo","./3d/support/SharedSymbolResources","./3d/support/pointsOfInterest/PointsOfInterest","./3d/terrain/TerrainSurface","./3d/terrain/terrainUtils","./3d/webgl-engine/Stage","./3d/webgl-engine/lib/Intersector","./3d/webgl-engine/lib/IntersectorInterfaces","./3d/webgl-engine/lib/intersectorUtils","./3d/webgl-engine/lib/intersectorUtilsConversions","./3d/webgl-engine/lib/verticalOffsetUtils","./support/hitTestSelectUtils","./support/layerViewUtils","./support/screenshotUtils","./support/screenUtils","./support/spatialReferenceSupport","./support/WebGLRequirements","./ui/DefaultUI","./ui/3d/DefaultUI3D","../webscene/Environment","../geometry/SpatialReference","../geometry/Point","../geometry/Extent"],(function(e,t,i,r,n,a,s,o,l,p,c,d,h,u,g,y,f,_,m,w,v,b,S,M,V,T,R,C,I,O,x,E,P,L,A,H,k,G,D,U,F,W,j,z,q,N,B,Q,$,X,Y,Z,J,K,ee,te,ie,re,ne,ae,se,oe,le,pe,ce,de,he,ue,ge,ye,fe,_e,me,we,ve,be,Se,Me,Ve,Te,Re,Ce,Ie,Oe,xe,Ee,Pe,Le,Ae,He){"use strict";const ke=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let Ge=function(i){function r(e){var r;(r=i.call(this,e)||this)._userClippingArea=null,r._clippingArea=null,r._initialDefaultSpatialReference=null,r._defaults={},r._externallySet={environment:!1},r._createGraphicsViewController=null,r._resolveWhenReady=[],r._propertiesPool=new pe.PropertiesPool({slicePlane:P.BoundedPlaneClass},t._assertThisInitialized(r)),r._resourceController=he.newResourceController(t._assertThisInitialized(r)),r._defaultToMapOptions={include:new Set},r._defaultHitTestOptions={exclude:new Set},r.deconflictor=new Z.GraphicsDeconflictor({view:t._assertThisInitialized(r)}),r.labeler=new J.Labeler({view:t._assertThisInitialized(r),deconflictor:r.deconflictor.labels}),r.sharedSymbolResources=null,r.analyses=new G.AnalysesCollection,r.basemapTerrain=null,r.elevationProvider=null,r.canvas=null,r.constraints=new Q.Constraints,r.environmentManager=new X.SceneViewEnvironmentManager,r.floors=new o,r.fullOpacity=1,r.graphicsView=null,r.analysisViewManager=new B({view:t._assertThisInitialized(r)}),r.groundView=null,r.map=null,r.screenSizePerspectiveEnabled=!0,r.state=new ee,r.spatialReference=null,r.alphaCompositingEnabled=!1,r.preserveDrawingBufferEnabled=!1,r.supersampleScreenshotsEnabled=!0,r.type="3d",r.ui=new Ee,r._numUpdating=0,r._lastUpdateTime=0,r.updatingProgress=.5,r.highlightOptions=new oe,r.voxelWasm=null,r.voxelWasmPromise=null,b.initialize(),e&&e.environment||(r._defaults.environment=new $,r.environment=r._defaults.environment);const n=(e=null)=>{null!=e&&e.type===f.ObservableChangesType.MOVE||(r._updatingChanged(),r.map&&r.map.allLayers.forEach((async e=>{try{await e.when()}catch{}r._updatingChanged()})))};return r.addHandles([m.on((()=>r.map?.allLayers),"after-changes",(e=>n(e)),{onListenerAdd:()=>n(),onListenerRemove:()=>n(),sync:!0}),r.allLayerViews.on("after-changes",(e=>r._updateUpdatingMonitors(e))),m.watch((()=>r.map),(e=>{e&&"load"in e&&e.load&&e.load().catch((()=>{}))}))]),r.inputManager=new Y({view:t._assertThisInitialized(r)}),r.stateManager=new te.ViewStateManager({view:t._assertThisInitialized(r)}),r}t._inherits(r,i);var n=r.prototype;return n.initialize=function(){this.groundView=new F({view:this}),this._updateUpdatingMonitors();const e=()=>this._updateDefaultToMapOptions();this.addHandles(m.on((()=>this.map?.allLayers),"after-changes",e,{onListenerAdd:e,onListenerRemove:e})),this.updatingHandles.add((()=>this.qualitySettings.memoryLimit),(e=>{this.resourceController&&(this.resourceController.memoryController.maxMemory=e)}),m.initial),this.updatingHandles.add((()=>this.qualitySettings.additionalCacheMemory),(e=>{this.resourceController&&(this.resourceController.memoryController.additionalCacheMemory=e)}),m.initial),this.updatingHandles.add((()=>this.qualitySettings.frameRate??0),(e=>w.setFrameDuration(e>0?1e3/Math.ceil(e):0)),m.initial),this.updatingHandles.add((()=>this.map?.ground),e,m.syncAndInitial),this.updatingHandles.add((()=>this.map?.ground?.opacity),(()=>this._updateDefaultHitTestOptions()),m.syncAndInitial),this.addHandles(m.watch((()=>this.spatialReference),(()=>this.notifyChange("clippingArea")),m.sync))},n.destroy=function(){this.destroyed||(this.updatingHandles.removeAll(),this.removeAllHandles(),this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources=y.destroyMaybe(this.sharedSymbolResources),this._set("labeler",y.destroyMaybe(this.labeler)),this._set("deconflictor",y.destroyMaybe(this.deconflictor)),this._resourceController=y.destroyMaybe(this._resourceController),this._set("stateManager",y.destroyMaybe(this.stateManager)),this._set("inputManager",y.destroyMaybe(this.inputManager)),this.state.destroy(),this._propertiesPool.destroy(),this.removeHandles("updatingMonitors"),this._set("environmentManager",y.destroyMaybe(this.environmentManager)),this.groundView=y.destroyMaybe(this.groundView),this._exitBasemapTerrain(),this._stage?.destroy(),this.removeAllHandles(),this.updatingHandles.removeAll(),this.handles.removeAll())},n.installContentCameraReset=function(e={sticky:!1}){return this.stateManager.installContentCameraReset(e)},n.castEnvironment=function(e){return e?e instanceof $?e:e instanceof Pe?null!=this.environment?this.environment.cloneWithWebsceneEnvironment(e):$.fromWebsceneEnvironment(e):R.ensureType($,e):new $},n.on=function(e,i,n,a){const s=this.viewEvents.on(e,i,n,a);return s||t._get(t._getPrototypeOf(r.prototype),"on",this).call(this,e,i)},n.hasEventListener=function(e){return t._get(t._getPrototypeOf(r.prototype),"hasEventListener",this).call(this,e)||this.viewEvents.hasHandler(e)},n.toMap=function(e,t){if(!this.ready)return g.getLogger(this).error("#toMap()","Scene view cannot be used before it is ready"),null;const i=t?this.externalToInternalIntersectOptions(t):this._defaultToMapOptions,r=null!=i.graphics&&(null!=i.graphics.include||null!=i.graphics.exclude),n=Ce.isSupportedScreenPointEvent(e)?Ce.createScreenPointFromSupportedEvent(this,e):e,a=v.screenPointObjectToArray(n);i.enableDraped=i.include&&!i.include.has(Me.TERRAIN_ID)||i.exclude&&i.exclude.has(Me.TERRAIN_ID);const s=this.sceneIntersectionHelper,o=we.newIntersector(this.state.viewingMode);if(o.options.selectionMode=!0,o.options.store=r?ve.StoreResults.ALL:ve.StoreResults.MIN,s.intersectIntersectorScreen(a,o,i),r){for(const e of o.results.all){const t=Se.toHit(e,this);if(null==t)return this._intersectResultToMapPoint(e);if("graphic"!==t.type||this._testGraphicUidFilter(i.graphics,t.graphic))return this._intersectResultToMapPoint(e)}return null}return this._intersectResultToMapPoint(o.results.min)},n.toScreen=function(e){if(!this.ready)return g.getLogger(this).error("#toScreen()","Scene view cannot be used before it is ready"),null;const t=(null==e.z?se.getElevationAtPoint(this.elevationProvider,e):null)??0;return x.projectPointToVector(e,je,this.renderSpatialReference,t),this.state.camera.projectToScreen(je,ze),v.createScreenPoint(ze[0],ze[1])},n.pixelSizeAt=function(e){return this.ready?e?(x.projectPointToVector(e,je,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(je)):0:(g.getLogger(this).error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null)},n.overlayPixelSizeInMapUnits=function(e){const t=this.basemapTerrain.overlayManager;return t?t.overlayPixelSizeInMapUnits(e):1},n.hitTest=function(e,t){if(!this.ready)return g.getLogger(this).error("#hitTest()","Scene view cannot be used before it is ready"),null;const i=Ce.isSupportedScreenPointEvent(e)?Ce.createScreenPointFromSupportedEvent(this,e):e,r=v.createScreenPointArray(i.x,i.y),n=t?this.externalToInternalIntersectOptions(t):this._defaultHitTestOptions;n.requiresGroundFeedback=!0,n.enableDraped=!0;const a=we.newIntersector(this.state.viewingMode);a.options.selectionMode=!0,a.options.store=ve.StoreResults.ALL,this.sceneIntersectionHelper.intersectIntersectorScreen(r,a,n);const s=this._intersectResultsToHits(a.results.all,n.graphics),o=a.results.ground,l=Se.toOwner(o,this),p=null!=l&&"type"in l&&"integrated-mesh"===l.type?l:null,c={screenPoint:i,results:s,ground:{mapPoint:this._intersectResultToMapPoint(o),distance:be.isValidIntersectorResult(o)?o.distanceInRenderSpace:0,layer:p}};return ne.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(c.intersector=a),Promise.resolve(c)},n.popupHitTest=async function(e){const{results:t,ground:i}=await Ve.hitTestSelectSimilarDistance(this,e);let r=null;return!(0===t.length||Math.abs((t[0].distance??0)-i.distance)<1e-5)||i.layer&&"integrated-mesh"===i.layer.type||(r=i.mapPoint),{results:t,screenPoint:e,mapPoint:r}},n.goTo=function(e,t){return this.updatingHandles.addPromise(this.stateManager.goTo(e,t))},n.whenAnalysisView=async function(e){if(null==e.parent)throw new p("view:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:e});switch(e.parent.type){case"line-of-sight":case"dimension":return(await this.whenLayerView(e.parent)).whenAnalysisView();default:return this.analysisViewManager.whenAnalysisView(e)}},n.whenLayerView=function(e){return t._get(t._getPrototypeOf(r.prototype),"whenLayerView",this).call(this,e)},n.takeScreenshot=async function(e){const t=this._completeSettings(e);await this.whenReady();const i=await this._stage.renderView.takeScreenshot(t);return Re.encode(i,t,this._pixelFormat())},n._takeScreenshot=async function(e){const t=this._completeSettings(e);await this.whenReady();const i=await this._stage.renderView.takeScreenshot(t);return Re.encodeData(i,this._pixelFormat())},n._takeScreenshotWithObjectAndLayerId=async function(e){const t=this._completeSettings(e);await this.whenReady();const i=await this._stage.renderView.takeScreenshotWithOID(t);return[Re.encodeData(i[0],this._pixelFormat()),Re.encodeData(i[1],this._pixelFormat())]},n._completeSettings=function(e){const t=Re.toRenderSettings(e,this);return t.pixelRatio/=this.state.pixelRatio,Re.screenshotSuperSampleSettings(t,this.supersampleScreenshotsEnabled,this.padding)},n._pixelFormat=function(){return{flipY:!0,premultipliedAlpha:this._stage.renderView.getAlpha()}},n.takeScreenshotWithObjectAndLayerId=async function(e){if(!h("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");const t=this._completeSettings(e);await this.whenReady();const i=await this._stage.renderView.takeScreenshotWithOID(t),r=Re.encode(i[0],t,this._pixelFormat()),n=this._completeSettings(e);n.format="png";return[r,Re.encode(i[1],n,this._pixelFormat())]},n.getColorToObjectAndLayerIdMapping=function(){if(null==this._stage.renderView.objectAndLayerIdRenderHelper)throw new Error("has enable-feature:objectAndLayerId-rendering must be true");return this._stage.renderView.objectAndLayerIdRenderHelper.getColorToObjectAndLayerIdMapping()},n.addUpdatingPromise=function(e){return this.updatingHandles.addPromise(e)},n.importLayerView=function(e){return N.layerView3DImporter.importLayerView(e)},n.hasLayerViewModule=function(e){return N.layerView3DImporter.hasLayerViewModule(e)},n.forceDOMReadyCycle=function(){this.forceReadyCycle()},n.getDefaultSpatialReference=function(){return this.map&&"initialViewProperties"in this.map&&this.map?.initialViewProperties?.spatialReference||this.defaultsFromMap?.spatialReference||this.defaultsFromMap?.ready&&this._initialDefaultSpatialReference||null},n.validate=async function(){let e=Oe.check(this.type);const t=h("safari");if(t&&t<9&&(e=new p("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:t})),null!=e)throw g.getLogger(this).warn("#validate()",e.message),e},n.getSpatialReferenceSupport=function({spatialReference:e,layer:t}){const i=this._predeterminedViewingMode;if(null!=i)return this._validateSpatialReferenceForViewingMode(e,t,i)?{constraints:this._makeSpatialReferenceConstraints(e,t,i)}:null;const r=this._validateSpatialReferenceForViewingMode(e,t,q.ViewingMode.Local),n=this._validateSpatialReferenceForViewingMode(e,t,q.ViewingMode.Global);return r||n?r&&n?{constraints:this._makeSpatialReferenceConstraints(e,t,null)}:r?{constraints:this._makeSpatialReferenceConstraints(e,t,q.ViewingMode.Local)}:{constraints:this._makeSpatialReferenceConstraints(e,t,q.ViewingMode.Global)}:null},n._validateSpatialReferenceForViewingMode=function(e,t,i){return!!Ie.isSpatialReferenceSupported(e,i)&&(null==t||(!!k.isImageryTileLayer(t)||(!k.isTiledLayer(t)||null!=_e.getTiledLayerInfo(t,e,i))&&(!k.isVoxelLayer(t)||i!==q.ViewingMode.Global)))},n._makeSpatialReferenceConstraints=function(e,t,i){if(null==t)return[{spatialReference:e,viewingMode:i}];const r=e.isWebMercator,n=e.isWGS84;if(k.isImageryTileLayer(t)&&(r||n)){return!n||i===q.ViewingMode.Local||null===_e.checkIfTileInfoSupportedForView(t.tileInfo,t.fullExtent,e,q.ViewingMode.Global)?[{spatialReference:e,viewingMode:i},{spatialReference:Le.WebMercator,viewingMode:i}]:[{spatialReference:r?Le.WGS84:Le.WebMercator,viewingMode:i}]}return k.isTiledLayer(t)||k.isVoxelLayer(t)||!r&&!n?k.isTiledLayer(t)&&r&&i!==q.ViewingMode.Global?[{spatialReference:e,viewingMode:i},{spatialReference:Le.WGS84,viewingMode:q.ViewingMode.Local}]:[{spatialReference:e,viewingMode:i}]:[{spatialReference:e,viewingMode:i},{spatialReference:r?Le.WGS84:Le.WebMercator,viewingMode:i}]},n._validateSpatialReference=function(e){const t=null!=this.getSpatialReferenceSupport({spatialReference:e}),i=this._predeterminedViewingMode;return t||(null!=i?g.getLogger(this).warnOnce(`Spatial reference defined on view not supported in ${q.stringFromViewingMode(i)} viewing mode.`):e.isGeographic&&g.getLogger(this).warnOnce("Spatial reference is geographic but not supported.")),t},n.whenReady=function(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))},n.computeMapPointFromVec3d=function(e,t){let i=this.spatialReference||Le.WGS84;return x.projectVectorToVector(e,this.renderSpatialReference,e,i)||(i=Le.WGS84,x.projectVectorToVector(e,this.renderSpatialReference,e,i)),t?(t.x=e[0],t.y=e[1],t.z=e[2],t.spatialReference=i):t=new Ae(e,i),t},n.trackGraphicState=function(e){if(!e.graphic)return g.getLogger(this).error("trackGraphicState","GraphicState.graphic must not be null or undefined to start tracking"),null;const t=this.getViewForGraphic(e.graphic);let i=null,r=!1;const n=t=>{!r&&null!=t&&"processor"in t&&"graphics-3d"===t.processor?.type&&t.processor.graphicsCore&&(i=t.processor.graphicsCore.trackGraphicState(e))};return null!=t?n(t):this.whenViewForGraphic(e.graphic,{waitForLayer:!0}).then((e=>n(e)),(()=>{})).catch((()=>{})),{remove:()=>{r=!0,null!=i&&(i.remove(),i=null)}}},n.highlight=function(e){if(Array.isArray(e))return d.handlesGroup(e.map((e=>this.highlight(e))));if(o.isCollection(e))return d.handlesGroup(e.toArray().map((e=>this.highlight(e))));const t=this.getViewForGraphic(e);return t&&"highlight"in t?t.highlight(e):d.makeHandle()},n.maskOccludee=function(e){if(!e)return g.getLogger(this).error("maskOccludee","GraphicState.graphic must not be null or undefined to mask an occludee"),null;const t=this.getViewForGraphic(e);let i=null,r=!1;const n=t=>{!r&&null!=t&&Te.occludeesSupported(t)&&(i=t.maskOccludee(e))};return null!=t?n(t):this.whenViewForGraphic(e,{waitForLayer:!0}).then((e=>n(e)),(()=>{})).catch((()=>{})),{remove:()=>{r=!0,null!=i&&(i.remove(),i=null)}}},n.getViewForGraphic=function(e){return e.layer===this.graphics?this.graphicsView:e.layer?this.allLayerViews.find((t=>t.layer===e.layer)):null},n.graphicChanged=function(e){null!=this.graphicsView&&this.graphicsView.graphicChanged(e)},n.whenViewForGraphic=async function(e,t){if(e.layer===this)return await m.whenOnce((()=>this.graphicsView)),this.graphicsView;if(!e.layer||!this.map)throw new p("no-view-for-graphic");return t&&t.waitForLayer&&!this.map.allLayers.includes(e.layer)?new Promise(((t,i)=>{const r=this.map.allLayers.on("change",(n=>{n.added.includes(e.layer)&&(r.remove(),this.whenLayerView(e.layer).then(t,i))}))})):this.whenLayerView(e.layer)},n.externalToInternalIntersectOptions=function(e){const t=this._externalToInternalRenderItems(e.include,We.INCLUDE),i=this._externalToInternalRenderItems(e.exclude,We.EXCLUDE);return{include:t.layerUids,exclude:i.layerUids,graphics:{include:t.graphicUids,exclude:i.graphicUids}}},n._intersectResultToMapPoint=function(e,t){return e.getIntersectionPoint(je)?(t=this.computeMapPointFromVec3d(je,t),e.intersector===ve.IntersectorType.TERRAIN&&this.basemapTerrain&&(t.z=se.getElevationAtPoint(this.basemapTerrain,t)??0),t):null},n._intersectResultsToHits=function(e,t){const i=new Array;let r=null;for(let n=0;n<e.length;n++){const a=e[n],s=Se.toOwner(a,this);if(null!=s&&(s===this.map.ground||"type"in s&&"integrated-mesh"===s.type))break;const o=Se.toHit(a,this);if(null==o)continue;if("graphic"===o.type){if(null==r&&n!==e.length-1&&(r=new Set),null!=r){const e=this._getGraphicFilterUid(o.graphic);if(r.has(e))continue;r.add(e)}if(!this._testGraphicUidFilter(t,o.graphic))continue}const l=this._intersectResultToMapPoint(a),p=a.distanceInRenderSpace;i.push({...o,mapPoint:l,distance:p})}return i},n._getGraphicFilterUid=function(e){const t=e.sourceLayer,i=e.layer,r=t&&"objectIdField"in t?t:i&&"objectIdField"in i?i:t;if(r){const t=r.objectIdField??H.fallbackObjectIDAttribute,i=e.attributes?.[t];if(i)return`o-${r.id}-${i}`}return`u-${e.uid}`},n._testGraphicUidFilter=function(e,t){const i=this._getGraphicFilterUid(t);return null==e||(null==e.include||e.include.has(i))&&(null==e.exclude||!e.exclude.has(i))},n._externalToInternalRenderItems=function(e,t,i={layerUids:void 0,graphicUids:void 0}){if(!e)return i;if(e instanceof a)Ue(i,this._getGraphicFilterUid(e)),t===We.INCLUDE&&(null!=this.graphicsView&&e.layer===this?De(i,this.graphicsView.processor.layer.id):e.layer&&De(i,e.layer.uid));else if(u.isIterable(e))for(const r of e)r===this.graphics&&null!=this.graphicsView?De(i,this.graphicsView.processor.layer.id):r===this.map.ground?De(i,Me.TERRAIN_ID):this._externalToInternalRenderItems(r,t,i);else"uid"in e&&De(i,e.uid);return i},n._initBasemapTerrain=function(){this._set("basemapTerrain",new fe({view:this})),this._set("elevationProvider",new re.CombinedElevationProvider({view:this})),this.elevationProvider.register("ground",this.basemapTerrain)},n._exitBasemapTerrain=function(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set("elevationProvider",null),this.basemapTerrain.destroy(),this._set("basemapTerrain",null))},n._initGlobe=function(){this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set("pointsOfInterest",new ye.PointsOfInterest({view:this})),this._set("featureTiles",new K.FeatureTileTree3D({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.cameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));const t=()=>{const e=this.basemapTerrain?.extent;if(this.clippingArea||e)if(e&&this.basemapTerrain.spatialReference){const e=null!=this.basemapTerrain.extent&&null!=this.basemapTerrain.spatialReference?x.project(E.toExtent(this.basemapTerrain.extent,this.basemapTerrain.spatialReference),this.spatialReference):null;null!=this.clippingArea?this.featureTiles.filterExtent=this.clippingArea.intersection(e):this.featureTiles.filterExtent=e}else this.featureTiles.filterExtent=this.clippingArea;else this.featureTiles.filterExtent=null};this.addHandles([this.updatingHandles.add((()=>ne.FEATURE_TILE_TREE_SHOW_TILES),(t=>{t&&this.featureTiles&&!this._featureTreeDebugger?this.updatingHandles.addPromise(new Promise(((t,i)=>e(["./3d/layers/support/FeatureTileTree3DDebugger"],t,i)))).then((({FeatureTileTree3DDebugger:e})=>{!this._featureTreeDebugger&&ne.FEATURE_TILE_TREE_SHOW_TILES&&(this._featureTreeDebugger=new e({view:this}))})):t||!this._featureTreeDebugger||ne.FEATURE_TILE_TREE_SHOW_TILES||(this._featureTreeDebugger.destroy(),this._featureTreeDebugger=null)}),m.syncAndInitial),this.updatingHandles.add((()=>this.clippingArea),t,m.syncAndInitial),this.updatingHandles.add((()=>this.basemapTerrain.extent),t,m.syncAndInitial)],"feature-tiles"),this.stateManager.init()},n._exitGlobe=function(){this.state&&(this.stateManager.exit(),this.removeHandles("render-coords-helper"),this.removeHandles("feature-tiles"),this.featureTiles.destroy(),this._set("featureTiles",null),this.pointsOfInterest.destroy(),this._set("pointsOfInterest",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())},n._initCoordinateSystem=function(){if(this.spatialReference){const e=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(e)||this._set("mapCoordsHelper",new le.MapCoordsHelper(this.map,e));const t=this.state.isGlobal,i=L.renderSRFromViewSR(t,e);i!==this.renderSpatialReference&&(this._set("renderCoordsHelper",de.RenderCoordsHelper.create(this.state.viewingMode,i)),t||this.addHandles(m.watch((()=>this.basemapTerrain?.extent),(e=>{const t=this.renderCoordsHelper.spatialReference;null==e||0===e[0]&&0===e[1]&&0===e[2]&&0===e[3]||!x.projectBoundingRect(e,this.basemapTerrain.spatialReference,qe,t)||(this.renderCoordsHelper.extent=qe)}),m.sync),"render-coords-helper"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(we.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters))}else this._set("mapCoordsHelper",null),this._set("renderCoordsHelper",null)},n._exitCoordinateSystem=function(){this.mapCoordsHelper&&(this.removeHandles("render-coords-helper"),this._set("renderCoordsHelper",null),this._set("mapCoordsHelper",null))},n._updatingChanged=function(){this.notifyChange("updating")},n._updateUpdatingMonitors=function(e=null){null!=e&&e.type===f.ObservableChangesType.MOVE||(this.removeHandles("updatingMonitors"),this.allLayerViews.forEach((e=>{e.destroyed||(this.addHandles(m.watch((()=>[e.updating,e.updatingProgress]),(()=>this._updatingChanged()),m.sync),"updatingMonitors"),e.when((()=>this._updatingChanged()),(()=>this._updatingChanged())))})),this._updatingChanged())},n._prepareScreenshotOverlay=async function(){this.overlay&&await this.overlay.prepare()},n._renderScreenshotOverlay=function(e,t){if(!this.overlay||!this.overlay.hasVisibleItems)return t;const i=e.getContext("2d");return i.putImageData(t,0,0),this.overlay.renderCanvas(e),i.getImageData(0,0,t.width,t.height)},n._initStage=function(){const e={deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,preserveDrawingBuffer:this.preserveDrawingBufferEnabled,canvas:this.renderCanvas,screenshot:{prepareOverlay:()=>this._prepareScreenshotOverlay(),renderOverlay:(e,t)=>this._renderScreenshotOverlay(e,t)}},t=new ie.SceneIntersectionHelper(this.state.viewingMode,(e=>this._stage.layers.forAll(e)),this);this._set("sceneIntersectionHelper",t);const i=l.byId(this.surface);this._stage=new me.Stage({view:this,options:e,container:i}),this._stage.renderer.setParameters({slicePlane:this.slicePlane}),this.addHandles([this.updatingHandles.add((()=>this.qualitySettings.antialiasingEnabled),(()=>this._stage.renderer.setParameters({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})),m.initial),this.updatingHandles.add((()=>this.qualitySettings.highQualityTransparency),(e=>this._stage.renderer.setParameters({highQualityTransparency:e})),m.initial),m.watch((()=>this.magnifier),(e=>this._stage.renderView.magnifier=e),m.syncAndInitial),this.on("pointer-move",(()=>this._stage?.renderer.resetAnimation())),c.on(this._stage.renderView.canvas,"webglcontextlost",(e=>this.fatalError=new p("webgl-context-lost",e.statusMessage)))],"stage");const r=()=>{this._stage.renderer.setParameters({defaultHighlightOptions:oe.toEngineOptions(this.highlightOptions)})};this.addHandles(this.updatingHandles.add((()=>[this.highlightOptions.color,this.highlightOptions.haloColor,this.highlightOptions.haloOpacity,this.highlightOptions.fillOpacity,this.highlightOptions.shadowOpacity,this.highlightOptions.shadowColor,this.highlightOptions.shadowDifference]),r),"stage"),r(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(we.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._set("canvas",this._stage.renderView.canvas)},n._exitStage=function(){this._set("sceneIntersectionHelper",null),this._stage=y.destroyMaybe(this._stage),this.removeHandles("stage"),this._set("canvas",null)},n._initSurface=function(e){this._exitSurface(),this.state.init(e,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new ge.SharedSymbolResources({view:this,viewingMode:e,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state})},n._exitSurface=function(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())},n._createGraphicsViewIfNeeded=function(){if(this.graphicsView||this._createGraphicsViewController)return;if(0===this.graphics.length)return;this.removeHandles("graphics-view"),this._createGraphicsViewController=new AbortController;const e=()=>{this._createGraphicsViewController=null,this._updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(e,e),this._updatingChanged()},n._createGraphicsViewAsync=async function(t){const i=(await new Promise(((t,i)=>e(["./3d/layers/GraphicsView3D"],(e=>t(ke(e))),i)))).default;_.throwIfAborted(t),await m.whenOnce((()=>this.basemapTerrain?.ready),t),this._set("graphicsView",new i({view:this}))},n._disposeGraphicsView=function(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.removeHandles("graphics-view"),null!=this.graphicsView&&(this.removeHandles(this.graphicsView.processor.layer.id),this.graphicsView.destroy(),this._set("graphicsView",null))},n._startup=function(){const e=q.viewingModeFromString(this.viewingMode);if(e===q.ViewingMode.Global&&(this._clippingArea=null),this._initSurface(e),this._set("ready",!0),this.addHandles(m.on((()=>this.graphics),"after-changes",(()=>this._createGraphicsViewIfNeeded())),"graphics-view"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){const e=this.get("map.initialViewProperties.environment");e&&(this.environment=e)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();const t=this._resolveWhenReady;this._resolveWhenReady=[],t.forEach((e=>e(this)))},n._teardown=function(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.removeHandles("graphics-view"),this._exitSurface(),this._set("ready",!1)},n._updateDefaultToMapOptions=function(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(Me.TERRAIN_ID);for(const e of this.map.allLayers.items)"integrated-mesh"===e.type&&this._defaultToMapOptions.include.add(e.uid)}},n._updateDefaultHitTestOptions=function(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(Me.TERRAIN_ID);for(const e of this.map.allLayers.items)"integrated-mesh"===e.type&&e.opacity<1&&this._defaultHitTestOptions.exclude.add(e.uid)}},n.addVoxelLayerViewToWasm=function(t){return null==this.voxelWasm?(null==this.voxelWasmPromise&&(this.voxelWasmPromise=new Promise(((t,i)=>e(["../layers/VoxelWasmPerSceneView"],(e=>t(ke(e))),i))).then((e=>(this.voxelWasm=new e.default(this),this.voxelWasm)))),this.voxelWasmPromise.then((e=>e.addVoxelLayer(t)))):this.voxelWasm.addVoxelLayer(t)},n.removeVoxelLayerViewFromWasm=function(e){if(null!=this.voxelWasm){this.voxelWasm.removeVoxelLayer(e)<1&&(this.voxelWasm=null,this.voxelWasmPromise=null)}},t._createClass(r,[{key:"renderSpatialReference",get:function(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}},{key:"basemapSpatialReference",get:function(){return this.basemapTerrain?.spatialReference}},{key:"animation",get:function(){return this.state?.animation}},{key:"camera",get:function(){return this.stateManager?.camera},set:function(e){this.stateManager&&(this.stateManager.camera=e)}},{key:"contentCamera",get:function(){return this.stateManager?.contentCamera},set:function(e){this.stateManager&&(this.stateManager.contentCamera=e)}},{key:"center",get:function(){return this.stateManager?.center},set:function(e){this.stateManager&&(this.stateManager.center=e)}},{key:"clippingArea",get:function(){if("global"===this.viewingMode)return null;let e=this._userClippingArea||("clippingArea"in this.map?this.map?.clippingArea:void 0);return!this._userClippingArea&&!this.get("map.clippingEnabled")||null==e?(this._clippingArea=null,null):e instanceof He?this.spatialReference&&(e=Fe(e,this.spatialReference),null==e)?(g.getLogger(this).error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea):(e=e.clone(),null==e.intersection(this._groundAndLayersExtent)&&(e.xmin=e.xmax,e.ymin=e.ymax),e.zmin=void 0,e.zmax=void 0,e.equals(this._clippingArea)||(this._clippingArea=e),this._clippingArea):(g.getLogger(this).error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea)},set:function(e){this.ready&&"global"===this.viewingMode&&null!=e?g.getLogger(this).error("#clippingArea=","Clipping area is only supported in local viewingMode"):this._userClippingArea=e}},{key:"renderDataExtent",get:function(){if(this.state.viewingMode===q.ViewingMode.Global)return null;const e=this.renderSpatialReference,t=this.dataExtent;return null==t||null==e||t.spatialReference.equals(e)?t:Fe(t,e)}},{key:"dataExtent",get:function(){let e=this._groundAndLayersExtent;const t=this.spatialReference||Le.WGS84,i=Fe(this.clippingArea,t);null!=i&&(e=null!=e?e.intersection(i):i);const r=this._get("dataExtent");return null!=e&&e.equals(r)?r:e}},{key:"_groundAndLayersExtent",get:function(){const e=this.spatialReference||Le.WGS84;let t;const i=i=>{const r=Fe(i,e);null!=r&&(null!=t?t.union(r):t=r.clone())},r=this.basemapTerrain;if(r?.spatialReference){const e=r.groundExtent;i(new He({xmin:e[0],ymin:e[1],zmin:0,xmax:e[2],ymax:e[3],zmax:0,spatialReference:r.spatialReference}))}if(this.map){const e=e=>{null==e.fullExtent||"graphics"===e.type&&e.internal||i(e.fullExtent)};this.map.allLayers.forEach((t=>e(t)))}if(null==t)return null;t.hasZ?(t.zmin=Math.min(0,t.zmin??0),t.zmax=Math.max(0,t.zmax??0)):(t.zmin=0,t.zmax=0);const n=this._get("_groundAndLayersExtent");return t.equals(n)?n:t}},{key:"environment",set:function(e){e!==this._defaults.environment&&(this._externallySet.environment=!0),this._set("environment",e)}},{key:"extent",get:function(){return this.stateManager?.extent},set:function(e){this.stateManager&&(this.stateManager.extent=e)}},{key:"screenCenter",get:function(){return this.stateManager?.screenCenter}},{key:"frustum",get:function(){return this.stateManager?.frustum}},{key:"initialExtentRequired",get:function(){return this.stateManager&&!this.stateManager.hasInitialView}},{key:"_defaultsFromMapSettings",get:function(){return{required:{tileInfo:!1,heightModelInfo:!0,extent:!1}}}},{key:"interacting",get:function(){return this.navigating||(this.toolViewManager?.interacting??!1)}},{key:"stationary",get:function(){return!this.animation&&!this.resizing&&(null==this.state||this.state.stationary)}},{key:"navigating",get:function(){return this.state?.navigating??!1}},{key:"padding",get:function(){return this.stateManager?.padding},set:function(e){this.stateManager&&(this.stateManager.padding=e)}},{key:"qualityProfile",get:function(){return this._get("qualityProfile")||ae.getDefaultProfile()},set:function(e){ae.isValidProfile(e)&&(ae.apply(e,this.qualitySettings),this._set("qualityProfile",e))}},{key:"slicePlane",set:function(e){if(null!=this._stage&&this._stage.renderer.setParameters({slicePlane:e}),null==e)return void this._set("slicePlane",null);const t=this._propertiesPool.get("slicePlane");P.copy(e,t),this._set("slicePlane",t)}},{key:"typeSpecificPreconditionsReady",get:function(){return!!this.viewingMode}},{key:"resolution",get:function(){return null!=this.spatialReference?A.getResolutionForScale(this.scale,this.spatialReference):0}},{key:"scale",get:function(){return this.stateManager?.scale},set:function(e){this.stateManager&&(this.stateManager.scale=e)}},{key:"heightModelInfo",get:function(){const e=this.getDefaultHeightModelInfo();return null!=e?O.deriveUnitFromSR(e,this.spatialReference):null}},{key:"updating",get:function(){if(this.destroyed)return!1;let e=0,t=this.layerViewManager.updating,i=t?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach((r=>{if(r.isFulfilled()){if(r.updating){if(t=!0,r.suspended||_e.isSurfaceLayerView(r))return;++i,e+=r.updatingProgress}}else++i}));for(const n of this._updatingObjects)if(null!=n&&n.updating){const t=.1;i+=t,e+=.5*t}for(const n of this._updatingObjectsWithProgress)null!=n&&n.updating&&(++i,e+=n.updatingProgress);const r=!this.stateManager.test.updatingIgnoreRenderState&&this.state.updating;if(t=!!(t||i>0||this.updatingHandles.updating||!this.ready||!this.stationary||r||this._createGraphicsViewController||this.inputManager?.updating||this.map?.allLayers?.some((e=>!e.isFulfilled()))),t?(this._numUpdating=Math.max(i,this._numUpdating),e+=this._numUpdating-i):this._numUpdating=0,this._numUpdating>0?e/=this._numUpdating:e=t?0:1,this._get("updatingProgress")!==e){const i=performance.now();if(e<1){const t=Math.min((i-this._lastUpdateTime)/2e3,1);e=this.updatingProgress*(1-t)+e*t}this._set("updatingProgress",e),this._lastUpdateTime=t&&e<1?i:0}return t}},{key:"_updatingObjects",get:function(){return[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this._featureTreeDebugger,this.toolViewManager,this.analysisViewManager]}},{key:"_updatingObjectsWithProgress",get:function(){return[this.deconflictor,this.labeler,this.basemapTerrain]}},{key:"viewingMode",get:function(){const e=this._predeterminedViewingMode;if(null!=e)return q.stringFromViewingMode(e);const t=this.spatialReference;return t?null!=this.defaultsFromMap?.viewingMode&&t.equals(this.defaultsFromMap.spatialReference)?q.stringFromViewingMode(this.defaultsFromMap.viewingMode):Ie.isSpatialReferenceSupported(t,q.ViewingMode.Global)?"global":"local":"global"},set:function(e){this.ready?g.getLogger(this).error("#viewingMode","viewingMode cannot be set once view is ready"):this._overrideIfSome("viewingMode",e)}},{key:"viewpoint",get:function(){return this.stateManager?.viewpoint},set:function(e){this.stateManager&&(this.stateManager.viewpoint=e)}},{key:"zoom",get:function(){return this.stateManager.zoom},set:function(e){this.stateManager&&(this.stateManager.zoom=e)}},{key:"resourceController",get:function(){return this._resourceController}},{key:"performanceInfo",get:function(){return new ue(this)}},{key:"test",get:function(){return{takeScreenshot:e=>this._takeScreenshot(e),takeScreenshotWithObjectAndLayerId:e=>this._takeScreenshotWithObjectAndLayerId(e)}}},{key:"_predeterminedViewingMode",get:function(){const e=this._isOverridden("viewingMode")?this._get("viewingMode"):(this.map&&"initialViewProperties"in this.map?this.map.initialViewProperties?.viewingMode:null)??null;return null!=e?q.viewingModeFromString(e):null}}]),r}(D.BreakpointsOwner(W.PopupView(U.DOMContainer(j))));function De(e,t){e.layerUids||(e.layerUids=new Set),e.layerUids.add(t)}function Ue(e,t){e.graphicUids||(e.graphicUids=new Set),e.graphicUids.add(t)}function Fe(e,t){return null!=e&&x.canProjectWithoutEngine(e.spatialReference,t)?x.project(e,t):null}var We;Ge.type="3d",i.__decorate([S.property()],Ge.prototype,"_userClippingArea",void 0),i.__decorate([S.property()],Ge.prototype,"_resourceController",void 0),i.__decorate([S.property()],Ge.prototype,"_stage",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"deconflictor",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"labeler",void 0),i.__decorate([S.property(I.owningCollectionProperty(G.AnalysesCollection,"analyses"))],Ge.prototype,"analyses",void 0),i.__decorate([S.property({type:z,readOnly:!0})],Ge.prototype,"animation",null),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"basemapTerrain",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"elevationProvider",void 0),i.__decorate([S.property()],Ge.prototype,"camera",null),i.__decorate([S.property({type:r})],Ge.prototype,"contentCamera",null),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"canvas",void 0),i.__decorate([S.property({type:Ae})],Ge.prototype,"center",null),i.__decorate([S.property({type:He})],Ge.prototype,"clippingArea",null),i.__decorate([S.property({type:Q.Constraints})],Ge.prototype,"constraints",void 0),i.__decorate([S.property({type:He,readOnly:!0})],Ge.prototype,"renderDataExtent",null),i.__decorate([S.property({type:He,readOnly:!0})],Ge.prototype,"dataExtent",null),i.__decorate([S.property({type:He,readOnly:!0})],Ge.prototype,"_groundAndLayersExtent",null),i.__decorate([S.property({value:null,type:$})],Ge.prototype,"environment",null),i.__decorate([M.cast("environment")],Ge.prototype,"castEnvironment",null),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"environmentManager",void 0),i.__decorate([S.property({type:He})],Ge.prototype,"extent",null),i.__decorate([S.property()],Ge.prototype,"floors",void 0),i.__decorate([S.property()],Ge.prototype,"screenCenter",null),i.__decorate([S.property()],Ge.prototype,"frustum",null),i.__decorate([S.property({type:Number,readOnly:!0})],Ge.prototype,"fullOpacity",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"graphicsView",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"analysisViewManager",void 0),i.__decorate([S.property()],Ge.prototype,"groundView",void 0),i.__decorate([S.property({type:Boolean})],Ge.prototype,"initialExtentRequired",null),i.__decorate([S.property()],Ge.prototype,"_defaultsFromMapSettings",null),i.__decorate([S.property()],Ge.prototype,"interacting",null),i.__decorate([S.property()],Ge.prototype,"stationary",null),i.__decorate([S.property()],Ge.prototype,"navigating",null),i.__decorate([S.property()],Ge.prototype,"map",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"mapCoordsHelper",void 0),i.__decorate([S.property()],Ge.prototype,"padding",null),i.__decorate([S.property({type:ye.PointsOfInterest,readOnly:!0})],Ge.prototype,"pointsOfInterest",void 0),i.__decorate([S.property({type:K.FeatureTileTree3D,readOnly:!0})],Ge.prototype,"featureTiles",void 0),i.__decorate([S.property()],Ge.prototype,"_featureTreeDebugger",void 0),i.__decorate([S.property({type:Boolean})],Ge.prototype,"screenSizePerspectiveEnabled",void 0),i.__decorate([S.property({constructOnly:!0})],Ge.prototype,"deactivatedWebGLExtensions",void 0),i.__decorate([S.property({constructOnly:!0})],Ge.prototype,"debugWebGLExtensions",void 0),i.__decorate([S.property({constructOnly:!0})],Ge.prototype,"renderCanvas",void 0),i.__decorate([S.property({constructOnly:!0})],Ge.prototype,"state",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"inputManager",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"stateManager",void 0),i.__decorate([S.property({type:["low","medium","high"]})],Ge.prototype,"qualityProfile",null),i.__decorate([S.property({type:ce,get(){let e=this._get("qualitySettings");return e||(e=new ce,ae.apply(this.qualityProfile,e)),e}})],Ge.prototype,"qualitySettings",void 0),i.__decorate([S.property()],Ge.prototype,"slicePlane",null),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"typeSpecificPreconditionsReady",null),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"renderCoordsHelper",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"sceneIntersectionHelper",void 0),i.__decorate([S.property({type:Number,dependsOn:["scale","spatialReference"],readOnly:!0})],Ge.prototype,"resolution",null),i.__decorate([S.property({type:Number})],Ge.prototype,"scale",null),i.__decorate([S.property()],Ge.prototype,"heightModelInfo",null),i.__decorate([S.property()],Ge.prototype,"spatialReference",void 0),i.__decorate([S.property({type:Boolean,constructOnly:!0})],Ge.prototype,"alphaCompositingEnabled",void 0),i.__decorate([S.property({constructOnly:!0})],Ge.prototype,"preserveDrawingBufferEnabled",void 0),i.__decorate([S.property({type:Boolean})],Ge.prototype,"supersampleScreenshotsEnabled",void 0),i.__decorate([S.property({readOnly:!0})],Ge.prototype,"type",void 0),i.__decorate([S.property(),M.cast((e=>e instanceof xe?e:R.ensureClass(Ee,e)))],Ge.prototype,"ui",void 0),i.__decorate([S.property({type:Boolean,readOnly:!0,dependsOn:["graphicsView.updating","basemapView.updating","basemapTerrain.updating","layerViewManager.updating","layerViewManager.updatingRemaining","_resourceController.updating","_stage.updating","featureTiles.updating","pointsOfInterest.updating","environmentManager.updating","overlay.updating","updatingHandles.updating","featureTreeDebugger.updating","labeler.updating","deconflictor.updating","ready","stationary","inputManager.updating","toolViewManager.updating","analysisViewManager.updating","state.updating"]})],Ge.prototype,"updating",null),i.__decorate([S.property()],Ge.prototype,"_updatingObjects",null),i.__decorate([S.property()],Ge.prototype,"_updatingObjectsWithProgress",null),i.__decorate([S.property({type:Number,readOnly:!0,dependsOn:["updating"]})],Ge.prototype,"updatingProgress",void 0),i.__decorate([S.property({type:["global","local"]})],Ge.prototype,"viewingMode",null),i.__decorate([S.property({type:s})],Ge.prototype,"viewpoint",null),i.__decorate([S.property({type:Number})],Ge.prototype,"zoom",null),i.__decorate([S.property({type:oe})],Ge.prototype,"highlightOptions",void 0),Ge=i.__decorate([T.subclass("esri.views.SceneView")],Ge),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE"}(We||(We={}));const je=C.create(),ze=v.createScreenPointArray(),qe=E.create();return Ge}));
