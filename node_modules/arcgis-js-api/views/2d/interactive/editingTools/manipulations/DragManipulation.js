/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Manipulation","../../../../interactive/dragEventPipeline","../../../../interactive/GraphicManipulator","../../../../interactive/editGeometry/interfaces","../../../../interactive/support/utils"],(function(t,i,a,e,n,r,o){"use strict";let l=function(t){function l(i){var a;return(a=t.call(this)||this)._view=i.view,a._tool=i.tool,a._graphic=i.graphic,a._manipulator=a._createManipulator(),a.forEachManipulator((t=>a._tool.manipulators.add(t))),a}i._inherits(l,t);var c=l.prototype;return c.destroy=function(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphic=null},c.forEachManipulator=function(t){t(this._manipulator,a.ManipulatorType.TRANSLATE_XY)},c.createDragPipeline=function(t,i){let a=null,n=null,l=0,c=0,s=0;const{offsetX:u,offsetY:p,size:h}=o.getSymbolInfo(this._graphic.symbol);return e.createManipulatorDragEventPipeline(this._manipulator,((o,m)=>{m.next((i=>{if("start"===i.action){const i=t();a=i.editGeometryOperations,n=i.constraints}return i})).next(e.screenToMap(this._view)).next((t=>{const{x:e,y:o,z:m}=t.mapEnd;if(n&&(e+u<n.xmin||o+p-h<n.ymin||e+u>n.xmax||o+p-h>n.ymax))return t;"start"===t.action&&(l=t.mapStart.x,c=t.mapStart.y,s=t.mapStart.z);const _=e-l,f=o-c,v=m-s;l=e,c=o,s=m;const M=[];for(const i of a.data.components)M.push(...i.vertices);const g="start"===t.action?r.AccumulationBehaviour.NEW_STEP:r.AccumulationBehaviour.ACCUMULATE_STEPS,y=a.moveVertices(M,_,f,v,g);return i(t,y),t}))}))},c._createManipulator=function(){const t=this._view,i=this._graphic;return new n.GraphicManipulator({view:t,graphic:i,selectable:!0,cursor:"move"})},i._createClass(l)}(a.Manipulation);t.DragManipulation=l,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
