/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/screenUtils","../../../../../../renderers/support/heatmapUtils","../Technique","../../../../../webgl/enums"],(function(e,t,a,n,r,i){"use strict";let s=function(e){function r(){return e.apply(this,arguments)||this}return t._inherits(r,e),r.getStorageSpec=function({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}},r._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}},r.createOrUpdateRendererSchema=function(e,t){const{radius:r,minDensity:i,maxDensity:s,referenceScale:l,field:c,valueExpression:o,colorStops:u}=t,p=s-i,d=c||o?1:0,m=u.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let h,y=!0;return null!=e&&"heatmap"===e.type?(h=e,y=m!==e.gradientHash):h=this._createRendererSchema(),h.radius=a.pt2px(r),h.minDensity=i,h.densityRange=p,h.referenceScale=l,h.isFieldActive=d,y&&(h.gradient=n.generateGradient(u),h.gradientHash=m),h},t._createClass(r)}(r.Technique);s.type="heatmap",s.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:i.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:i.DataType.SHORT},{location:4,name:"a_id",count:4,type:i.DataType.UNSIGNED_BYTE}]}},e.HeatmapTechnique=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
