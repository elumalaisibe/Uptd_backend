/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../core/screenUtils","../../../../../../symbols/cim/enums","../../color","../../definitions","../../number","../../Utils","../../materialKey/MaterialKey","./util","./WGLBaseLineTemplate","./WGLMeshTemplate"],(function(e,t,i,l,r,n,o,s,a,_,c,p){"use strict";return function(c){function p(e,t,i,l,r,s,p,u,m,L,y,f,h,d,S,T,O,I,A,E){var M;M=c.call(this)||this;const P=a.LineMaterialKey.load(e);t&&(P.sdf=t.sdf,P.pattern=!0,P.textureBinding=t.textureBinding),M._capType=l,M._joinType=r,M._miterLimitCosine=_.getLimitCosine(s),M.tessellationProperties._fillColor=p,M.tessellationProperties._tl=u,M.tessellationProperties._br=m,M._hasPattern=L,M._isDashed=y,M._zOrder=O,M._effects=I||null,M._minMaxZoom=o.i1616to32(Math.round(A*n.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(E*n.MIN_MAX_ZOOM_PRECISION_FACTOR)),M._materialKey=P.data;const N=d?n.BITSET_TYPE_FILL_OUTLINE:0,C=(h?n.BITSET_GENERIC_LOCK_COLOR:0)|N|(f?n.BITSET_LINE_SCALE_DASH:0)|(S?n.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);return M.tessellationProperties._bitset=C,M.tessellationProperties._halfWidth=.5*i,M.tessellationProperties._halfReferenceWidth=.5*T,M.tessellationProperties.offset=0,M._initializeTessellator(!1),M}return e._inherits(p,c),p.fromCIMLine=function(e,t,s){const a=e.color,c=e.scaleFactor||1,u=!!e.dashTemplate;let m=e.cap;u&&m===l.CapType.ROUND&&(m=l.CapType.SQUARE);const L=e.join,y=i.pt2px(e.width)*c,f=i.pt2px(e.referenceWidth),h=i.pt2px(e.miterLimit),d=a&&r.premultiplyAlphaRGBA(a)||0,[S,T]=_.getMinMaxZoom(e.scaleInfo,s),O=!1;if(!t)return new p(e.materialKey,t,y,m,L,h,d,0,0,!1,u,e.scaleDash??!1,e.colorLocked??!1,O,e.sampleAlphaOnly,f,e.zOrder,e.effects,S,T);const{rect:I,width:A,height:E}=t,M=I.x+n.SPRITE_PADDING,P=I.y+n.SPRITE_PADDING,N=M+A,C=P+E,D=o.i1616to32(M,P),g=o.i1616to32(N,C),R=!1;return new p(e.materialKey,t,y,m,L,h,d,D,g,!0,u,e.scaleDash??!1,e.colorLocked??!1,R,e.sampleAlphaOnly,f,e.zOrder,e.effects,S,T)},p.fromFillOutline=function(e){const t=a.FillMaterialKey.load(e.materialKey);return a.hasOutlineFillSymbology(t)&&e.outline&&"esriSLSSolid"===e.outline?.style?p.fromSimpleLine({hash:"",materialKey:e.materialKey,...e.outline},null,!0):null},p.fromSimpleLine=function(e,t,l=!1){const{color:a}=e,c="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,u=s.getCapType(e.cap||"round"),m=s.getJoinType(e.join||"round");let L=a&&"esriSLSNull"!==e.style&&r.premultiplyAlphaRGBAArray(a)||0;"esriSLSNull"===e.style&&(L=0);const y=i.pt2px(e.width),f=e.miterLimit;if(!t)return new p(e.materialKey,t,y,u,m,f,L,0,0,!1,c,!0,!1,l,!1,y,0,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM);const{rect:h,width:d,height:S}=t,T=h.x+n.SPRITE_PADDING,O=h.y+n.SPRITE_PADDING,I=T+d,A=O+S,E=o.i1616to32(T,O),M=o.i1616to32(I,A);return new p(e.materialKey,t,y,u,m,f,L,E,M,!0,c,!0,!1,l,!1,y,0,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM)},p.fromPictureLineSymbol=function(e,i,l,r){return t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!"),null},e._createClass(p)}(c(p))}));
