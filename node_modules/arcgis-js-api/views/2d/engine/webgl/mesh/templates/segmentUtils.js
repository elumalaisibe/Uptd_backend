/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","./util"],(function(t,n,e){"use strict";function i(t,n){return t[n+1]}function s(t){return t.length-1}function r(t){let n=0;for(let e=0;e<s(t);e++)n+=h(t,e);return n}function h(t,n,e=1){const[s,r]=i(t,n);return Math.sqrt(s*s+r*r)*e}let u=function(){function t(t,n,e,i,s){this._segments=t,this._index=n,this._distance=e,this._xStart=i,this._yStart=s,this._done=!1}t.create=function(n){return new t(n,0,0,n[0][0],n[0][1])};var e=t.prototype;return e.clone=function(){return new t(this._segments,this._index,this._distance,this.xStart,this.yStart)},e.equals=function(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)},e.leq=function(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance},e.geq=function(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance},e.hasPrev=function(){return this._index-1>=0},e.hasNext=function(){return this._index+1<s(this._segments)},e.next=function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null},e.prev=function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)},e._seekBackwards=function(t,n){const e=this.backwardLength;if(t<=e)return this._distance=(e-t)/this.length,this;let i=this.backwardLength;for(;this.prev();){if(i+this.length>t)return this._seekBackwards(t-i);i+=this.length}return this._distance=0,n?this:null},e.seek=function(t,n=!1){if(t<0)return this._seekBackwards(Math.abs(t),n);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let e=this.remainingLength;for(;this.next();){if(e+this.length>t)return this.seek(t-e,n);e+=this.length}return this._distance=1,n?this:null},n._createClass(t,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const t=this.dy,n=(0*t+-1*-this.dx)/(1*this.length);let e=Math.acos(n);return t>0&&(e=2*Math.PI-e),e}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const{dx:t,dy:n}=this;return Math.sqrt(t*t+n*n)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]),t}();function o(t,n,e,i=!0){const s=r(t),h=u.create(t),o=s/2;if(!i)return h.seek(o),void e(h.clone(),0,o+0*n,s);const c=Math.max((s-n)/2,0),a=Math.floor(c/n),d=o-a*n;h.seek(d);for(let r=-a;r<=a;r++)h.x<512&&h.x>=0&&h.y<512&&h.y>=0&&e(h.clone(),r,o+r*n,s),h.seek(n)}function c(t,n,e){a(e,n,r(t),u.create(t),0)}function a(t,n,e,i,s){if(e<n)return;const r=i.clone().seek(e/2);if(null==r)return;t(r.clone(),e,s),e=(e-n)/2;const h=r.seek(n/2);a(t,n,e,i,s+1),a(t,n,e,h,s+1)}function d(t,n){const e=n;for(let i=0;i<t.length;i++){let n=t[i];f(n,e);const s=[];s.push(n[0]);for(let t=1;t<n.length;t++){const[e,i]=n[t-1],[r,h]=n[t],u=Math.round(r-e),o=Math.round(h-i);s.push([u,o])}t[i]=s,n=s}return t}function f(t,n){const i=1e-6;if(n<=0)return;const s=t.length;if(s<3)return;const r=[];let h=0;r.push(0);for(let f=1;f<s;f++)h+=e.dist(t[f],t[f-1]),r.push(h);n=Math.min(n,.2*h);const u=[];u.push(t[0][0]),u.push(t[0][1]);const o=t[s-1][0],c=t[s-1][1],a=e.sub([0,0],t[0],t[1]);e.normalize(a),t[0][0]+=n*a[0],t[0][1]+=n*a[1],e.sub(a,t[s-1],t[s-2]),e.normalize(a),t[s-1][0]+=n*a[0],t[s-1][1]+=n*a[1];for(let e=1;e<s;e++)r[e]+=n;r[s-1]+=n;const d=.5*n;for(let e=1;e<s-1;e++){let h=0,o=0,c=0;for(let s=e-1;s>=0&&!(r[s+1]<r[e]-d);s--){const u=d+r[s+1]-r[e],a=r[s+1]-r[s],f=r[e]-r[s]<d?1:u/a;if(Math.abs(f)<i)break;const l=f*f,_=f*u-.5*l*a,g=f*a/n,x=t[s+1],y=t[s][0]-x[0],k=t[s][1]-x[1];h+=g/_*(x[0]*f*u+.5*l*(u*y-a*x[0])-l*f*a*y/3),o+=g/_*(x[1]*f*u+.5*l*(u*k-a*x[1])-l*f*a*k/3),c+=g}for(let u=e+1;u<s&&!(r[u-1]>r[e]+d);u++){const s=d-r[u-1]+r[e],a=r[u]-r[u-1],f=r[u]-r[e]<d?1:s/a;if(Math.abs(f)<i)break;const l=f*f,_=f*s-.5*l*a,g=f*a/n,x=t[u-1],y=t[u][0]-x[0],k=t[u][1]-x[1];h+=g/_*(x[0]*f*s+.5*l*(s*y-a*x[0])-l*f*a*y/3),o+=g/_*(x[1]*f*s+.5*l*(s*k-a*x[1])-l*f*a*k/3),c+=g}u.push(h/c),u.push(o/c)}u.push(o),u.push(c);for(let e=0,f=0;e<s;e++)t[e][0]=u[f++],t[e][1]=u[f++]}t.SegmentCursor=u,t.pathDivide=o,t.pathLength=r,t.pathSubdivide=c,t.segmentAt=i,t.segmentCount=s,t.segmentLength=h,t.smoothPaths=d,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
