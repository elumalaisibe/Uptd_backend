/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/floatRGBA","../../../../core/promiseUtils"],(function(t,e,i){"use strict";const s=1e20;return function(){function r(t){this._svg=null,this.size=t;const e=document.createElement("canvas");e.width=e.height=t,this._context=e.getContext("2d"),this._gridOuter=new Float64Array(t*t),this._gridInner=new Float64Array(t*t),this._f=new Float64Array(t),this._d=new Float64Array(t),this._z=new Float64Array(t+1),this._v=new Int16Array(t)}var n=r.prototype;return n.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null,this._svg&&(document.body.removeChild(this._svg),this._svg=null)},n.draw=function(t,r,n=31){this._initSVG();const h=this.createSVGString(t);return new Promise(((t,o)=>{const a=new Image;a.src="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h),a.onload=()=>{a.onload=null,this._context.clearRect(0,0,this.size,this.size),this._context.drawImage(a,0,0,this.size,this.size);const i=this._context.getImageData(0,0,this.size,this.size),r=new Uint8Array(this.size*this.size*4);for(let t=0;t<this.size*this.size;t++){const e=i.data[4*t+3]/255;this._gridOuter[t]=1===e?0:0===e?s:Math.max(0,.5-e)**2,this._gridInner[t]=1===e?s:0===e?0:Math.max(0,e-.5)**2}this._edt(this._gridOuter,this.size,this.size),this._edt(this._gridInner,this.size,this.size);for(let t=0;t<this.size*this.size;t++){const i=.5-(this._gridOuter[t]-this._gridInner[t])/(2*n);e.packFloatRGBA(i,r,4*t)}t(r)};const l=r&&r.signal;l&&i.onAbort(l,(()=>o(i.createAbortError())))}))},n._initSVG=function(){if(!this._svg){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),document.body.appendChild(t),this._svg=t}return this._svg},n.createSVGString=function(t){const e=this._initSVG(),i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",t),e.appendChild(i);const s=i.getBBox(),r=s.width/s.height,n=this.size/2;let h,o,a,l;if(r>1){o=h=n/s.width;const t=n*(1/r);a=this.size/4,l=n-t/2}else{h=o=n/s.height;a=n-n*r/2,l=this.size/4}const d=-s.x*h+a,c=-s.y*o+l;i.setAttribute("style",`transform: matrix(${h}, 0, 0, ${o}, ${d}, ${c})`);const _=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${e.innerHTML}</svg>`;return e.removeChild(i),_},n._edt=function(t,e,i){const s=this._f,r=this._d,n=this._v,h=this._z;for(let o=0;o<e;o++){for(let r=0;r<i;r++)s[r]=t[r*e+o];this._edt1d(s,r,n,h,i);for(let s=0;s<i;s++)t[s*e+o]=r[s]}for(let o=0;o<i;o++){for(let i=0;i<e;i++)s[i]=t[o*e+i];this._edt1d(s,r,n,h,e);for(let i=0;i<e;i++)t[o*e+i]=Math.sqrt(r[i])}},n._edt1d=function(t,e,i,r,n){i[0]=0,r[0]=-s,r[1]=+s;for(let h=1,o=0;h<n;h++){let e=(t[h]+h*h-(t[i[o]]+i[o]*i[o]))/(2*h-2*i[o]);for(;e<=r[o];)o--,e=(t[h]+h*h-(t[i[o]]+i[o]*i[o]))/(2*h-2*i[o]);o++,i[o]=h,r[o]=e,r[o+1]=+s}for(let s=0,h=0;s<n;s++){for(;r[h+1]<s;)h++;e[s]=(s-i[h])*(s-i[h])+t[i[h]]}},t._createClass(r)}()}));
