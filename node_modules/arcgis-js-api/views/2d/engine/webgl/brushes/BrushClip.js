/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec4f32","../Utils","./WGLBrush","../shaders/BackgroundPrograms","../../../../webgl/enums","../../../../webgl/ProgramTemplate"],(function(e,t,r,n,o,i,a){"use strict";const s=()=>r.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:i.DataType.SHORT}]});let l=function(r){function n(){var e;return(e=r.apply(this,arguments)||this)._color=t.fromValues(0,1,0,1),e}e._inherits(n,r);var l=n.prototype;return l.dispose=function(){this._program&&this._program.dispose()},l.prepareState=function({context:e}){e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setFaceCullingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(i.StencilOperation.KEEP,i.StencilOperation.KEEP,i.StencilOperation.REPLACE),e.setStencilWriteMask(255),e.setStencilFunction(i.CompareFunction.ALWAYS,0,255)},l.draw=function(e,t){const{context:r,state:n,requestRender:l,allowDelayedRender:c}=e,u=s(),p=t.getVAO(r,n,u.attributes,u.bufferLayouts);null!=p.indexBuffer&&(this._program||(this._program=a.createProgram(r,o.background)),!c||null==l||this._program.compiled?(r.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),r.bindVAO(p),r.drawElements(i.PrimitiveType.TRIANGLES,p.indexBuffer.size,i.DataType.UNSIGNED_INT,0),r.bindVAO()):l())},e._createClass(n)}(n);return l}));
