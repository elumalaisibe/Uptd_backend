/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../Utils","./WGLBrush","../../../../webgl/enums"],(function(e,t,n,r,a){"use strict";const i=()=>n.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:a.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:a.DataType.UNSIGNED_SHORT}]});let o=function(n){function r(){var e;return(e=n.apply(this,arguments)||this)._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])},e}e._inherits(r,n);var o=r.prototype;return o.dispose=function(){},o.prepareState=function({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setBlendFunctionSeparate(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA,a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(a.CompareFunction.GREATER,255,255)},o.draw=function(e,n){const{context:r,painter:o,requestRender:s,allowDelayedRender:c}=e;if(!n.isReady)return;const{computedOpacity:u,dvsMat3:l,isWrapAround:p,perspectiveTransform:d,texture:_}=n;e.timeline.begin(this.name);const f=o.materialManager.getProgram(this._desc);if(c&&null!=s&&!f.compiled)return void s();const m=i(),y=n.getVAO(r,m.bufferLayouts,m.attributes);if(!y)return;r.bindVAO(y),r.useProgram(f),r.bindTexture(_,t.TEXTURE_BINDING_BITMAP),f.setUniformMatrix3fv("u_dvsMat3",l),f.setUniform1i("u_texture",t.TEXTURE_BINDING_BITMAP),f.setUniform1f("u_opacity",u),f.setUniform2fv("u_perspective",d);const v=p?10:4;r.drawArrays(a.PrimitiveType.TRIANGLE_STRIP,0,v),r.bindVAO(),e.timeline.end(this.name)},e._createClass(r)}(r);return o}));
