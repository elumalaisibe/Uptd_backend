/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../definitions","./parameters","../../shaders/HighlightPrograms","../../../../../webgl/BufferObject","../../../../../webgl/enums","../../../../../webgl/ProgramTemplate","../../../../../webgl/VertexArrayObject","../../../../../webgl/VertexElementDescriptor"],(function(e,r,i,t,s,o,_,u,n){"use strict";return function(){function a(){this._width=void 0,this._height=void 0,this._resources=null}var h=a.prototype;return h.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)},h.preBlur=function(e,t){e.bindTexture(t,r.TEXTURE_BINDING_HIGHLIGHT_0),e.useProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",i.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX),e.bindVAO(this._resources.quadVAO),e.drawArrays(o.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindVAO()},h.finalBlur=function(e,t){e.bindTexture(t,r.TEXTURE_BINDING_HIGHLIGHT_0),e.useProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",i.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX),e.bindVAO(this._resources.quadVAO),e.drawArrays(o.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindVAO()},h.renderHighlight=function(e,i,t){e.bindTexture(i,r.TEXTURE_BINDING_HIGHLIGHT_0),e.useProgram(this._resources.highlightProgram),t.applyHighlightOptions(e,this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.setBlendingEnabled(!0),e.setBlendFunction(o.BlendFactor.ONE,o.BlendFactor.ONE_MINUS_SRC_ALPHA),e.drawArrays(o.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindVAO()},h._initialize=function(e,a,h){this._width=a,this._height=h;const c=s.BufferObject.createVertex(e,o.Usage.STATIC_DRAW,new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]).buffer),g=new u.VertexArrayObject(e,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new n.VertexElementDescriptor("a_position",2,o.DataType.BYTE,0,4),new n.VertexElementDescriptor("a_texcoord",2,o.DataType.UNSIGNED_BYTE,2,4)]},{geometry:c}),l=_.createProgram(e,t.highlight),m=_.createProgram(e,t.blur);e.useProgram(l),l.setUniform1i("u_texture",r.TEXTURE_BINDING_HIGHLIGHT_0),l.setUniform1i("u_shade",r.TEXTURE_BINDING_HIGHLIGHT_1),l.setUniform1f("u_sigma",i.SIGMA),e.useProgram(m),m.setUniform1i("u_texture",r.TEXTURE_BINDING_HIGHLIGHT_0),m.setUniform1f("u_sigma",i.SIGMA),this._resources={quadGeometry:c,quadVAO:g,highlightProgram:l,blurProgram:m}},h.setup=function(e,r,i){this._resources?(this._width=r,this._height=i):this._initialize(e,r,i)},e._createClass(a)}()}));
