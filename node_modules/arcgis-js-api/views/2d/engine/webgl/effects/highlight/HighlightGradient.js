/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture","../../../../../webgl/TextureDescriptor"],(function(o,i,t,e,l,n,r){"use strict";const h=i.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function s(o,i){i.fillColor[0]=o.color.r/255,i.fillColor[1]=o.color.g/255,i.fillColor[2]=o.color.b/255,i.fillColor[3]=o.color.a,o.haloColor?(i.outlineColor[0]=o.haloColor.r/255,i.outlineColor[1]=o.haloColor.g/255,i.outlineColor[2]=o.haloColor.b/255,i.outlineColor[3]=o.haloColor.a):(i.outlineColor[0]=i.fillColor[0],i.outlineColor[1]=i.fillColor[1],i.outlineColor[2]=i.fillColor[2],i.outlineColor[3]=i.fillColor[3]),i.fillColor[3]*=o.fillOpacity,i.outlineColor[3]*=o.haloOpacity,i.fillColor[0]*=i.fillColor[3],i.fillColor[1]*=i.fillColor[3],i.fillColor[2]*=i.fillColor[3],i.outlineColor[0]*=i.outlineColor[3],i.outlineColor[1]*=i.outlineColor[3],i.outlineColor[2]*=i.outlineColor[3],i.outlineWidth=e.HIGHLIGHT_SIZING.outlineWidth,i.outerHaloWidth=e.HIGHLIGHT_SIZING.outerHaloWidth,i.innerHaloWidth=e.HIGHLIGHT_SIZING.innerHaloWidth,i.outlinePosition=e.HIGHLIGHT_SIZING.outlinePosition}const a=[0,0,0,0];return function(){function i(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:e.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:e.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:e.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:e.HIGHLIGHT_SIZING.outerHaloWidth},this._shadeTexChanged=!0,this._texelData=new Uint8Array(4*e.SHADE_TEXTURE_SIZE),this._minMaxDistance=[0,0]}var u=i.prototype;return u.setHighlightOptions=function(o){const i=this._convertedHighlightOptions;s(o,i);const t=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,l=i.outlinePosition-i.outlineWidth/2,n=i.outlinePosition+i.outlineWidth/2,r=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,u=Math.sqrt(Math.PI/2)*e.SIGMA,d=Math.abs(t)>u?Math.round(10*(Math.abs(t)-u))/10:0,C=Math.abs(r)>u?Math.round(10*(Math.abs(r)-u))/10:0;let H;d&&!C?h.error("The outer rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!d&&C?h.error("The inner rim of the highlight is "+C+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):d&&C&&h.error("The highlight is "+Math.max(d,C)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function g(o,i,t){f[0]=(1-t)*o[0]+t*i[0],f[1]=(1-t)*o[1]+t*i[1],f[2]=(1-t)*o[2]+t*i[2],f[3]=(1-t)*o[3]+t*i[3]}const{_texelData:_}=this;for(let h=0;h<e.SHADE_TEXTURE_SIZE;++h)H=t+h/(e.SHADE_TEXTURE_SIZE-1)*(r-t),H<t?(f[4*h]=0,f[4*h+1]=0,f[4*h+2]=0,f[4*h+3]=0):H<l?g(a,i.outlineColor,(H-t)/(l-t)):H<n?[f[0],f[1],f[2],f[3]]=i.outlineColor:H<r?g(i.outlineColor,i.fillColor,(H-n)/(r-n)):[f[4*h],f[4*h+1],f[4*h+2],f[4*h+3]]=i.fillColor,_[4*h]=255*f[0],_[4*h+1]=255*f[1],_[4*h+2]=255*f[2],_[4*h+3]=255*f[3];this._minMaxDistance[0]=t,this._minMaxDistance[1]=r,this._shadeTexChanged=!0},u.applyHighlightOptions=function(o,i){if(!this._shadeTex){const i=new r.TextureDescriptor;i.wrapMode=l.TextureWrapMode.CLAMP_TO_EDGE,i.width=e.SHADE_TEXTURE_SIZE,i.height=1,this._shadeTex=new n.Texture(o,i)}this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,e.SHADE_TEXTURE_SIZE,1,this._texelData),this._shadeTexChanged=!1),o.bindTexture(this._shadeTex,t.TEXTURE_BINDING_HIGHLIGHT_1),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)},u.destroy=function(){this._shadeTex?.dispose(),this._shadeTex=null},o._createClass(i)}()}));
