/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../../../../chunks/mat3f32","./RasterVFDisplayObject","../webgl/TiledDisplayObject"],(function(t,e,s,i,a,l){"use strict";let o=function(t){function l(e,s,i,l,o,n,r=null){var h;return(h=t.call(this,e,s,i,l,o,n)||this).tileData=new a.RasterVFDisplayObject(r),h.tileData.coordScale=[o,n],h.tileData.once("isReady",(()=>h.ready())),h}e._inherits(l,t);var o=l.prototype;return o.destroy=function(){e._get(e._getPrototypeOf(l.prototype),"destroy",this).call(this),this.tileData.destroy(),this.tileData=null,this.stage=null},o._createTransforms=function(){return{dvs:i.create(),tileMat3:i.create()}},o.setTransform=function(t){e._get(e._getPrototypeOf(l.prototype),"setTransform",this).call(this,t);const i=this.resolution/(t.resolution*t.pixelRatio),a=this.transforms.tileMat3,[o,n]=this.tileData.offset,r=[this.x+o*this.resolution,this.y-n*this.resolution],[h,c]=t.toScreenNoRotation([0,0],r),{symbolTileSize:u}=this.tileData.symbolizerParameters,f=Math.round((this.width-this.tileData.offset[0])/u)*u,y=Math.round((this.height-this.tileData.offset[1])/u)*u,d=f/this.rangeX*i,p=y/this.rangeY*i;s.set(a,d,0,0,0,p,0,h,c,1),s.multiply(this.transforms.dvs,t.displayViewMat3,a),this.tileData.transforms.dvs=this.transforms.dvs},o.onAttach=function(){this.tileData.stage=this.stage},o.onDetach=function(){this.tileData.stage=null},e._createClass(l,[{key:"stencilRef",get:function(){return this.tileData.stencilRef},set:function(t){this.tileData.stencilRef=t}}]),l}(l.TiledDisplayObject);t.RasterVFTile=o,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
