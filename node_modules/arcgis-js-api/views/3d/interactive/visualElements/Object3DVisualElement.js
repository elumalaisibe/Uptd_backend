/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat4","../../../../chunks/mat4f64","./VisualElement","../../webgl-engine/lib/Object3D","../../webgl-engine/lib/UpdatePolicy","../../webgl-engine/lib/WebGLLayer"],(function(e,t,s,r,i,o,n,c){"use strict";let a=function(e){function i(t){var s;return(s=e.call(this,t.view)||this)._resources=null,s._transform=r.create(),s}t._inherits(i,e);var a=i.prototype;return a.recreate=function(){this.attached&&this.createResources()},a.recreateGeometry=function(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)},a.createResources=function(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new c.WebGLLayer(e,{pickable:!1,updatePolicy:n.UpdatePolicy.SYNC}),s=new o.Object3D({castShadow:!1});s.transformation=this._transform,this.createExternalResources(),this.createGeometries(s),e.addMany(s.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(s),t.add(s),s.visible=this.visible,this._resources={layer:t,object:s}},a.destroyResources=function(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)},a.updateVisibility=function(e){null!=this._resources&&(this._resources.object.visible=e)},t._createClass(i,[{key:"object",get:function(){return null!=this._resources?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){s.copy(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}}]),i}(i.VisualElement);e.Object3DVisualElement=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
