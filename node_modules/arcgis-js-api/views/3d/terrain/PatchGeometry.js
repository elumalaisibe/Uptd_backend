/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/vec3","../../../geometry/support/aaBoundingBox","../../../geometry/support/buffer/BufferPool","../support/buffer/InterleavedLayout","./terrainUtils","../webgl-engine/lib/Normals","../webgl-engine/lib/VertexAttribute"],(function(t,e,i,n,r,s,u,o,l){"use strict";let a=e._createClass((function(){this.indices=null,this.vertexAttributes=null,this.boundingBox=n.empty(),this.indexCount=0,this.numVerticesPerSide=0,this.uvRange=[0,0,1,1],this.outerEdges=[null,null,null,null],this.innerEdges=[null,null,null,null]})),c=function(){function t(t,e,i,n,r){this.attributes=t,this.localOrigin=e,this.index0=i,this.stride=n,this.count=r}var n=t.prototype;return n.getVertexIndex=function(t){return this.getAttributeIndex(t)},n.getAttributeIndex=function(t){return u.internalAssert(0<=t&&t<this.count),this.index0+this.stride*t},n._getVertexRaw=function(t,e){this.attributes.position.getVec(t,e)},n.getVertexPos=function(t,e){this._getVertexRaw(this.getAttributeIndex(e),t),i.add(t,t,this.localOrigin)},n.getNormal=function(t,e){const{typedBuffer:i,typedBufferStride:n}=this.attributes.normalCompressed;o.decompressNormal(t,i,this.getAttributeIndex(e),n)},n._setNormal=function(t,e,i,n){const{typedBuffer:r,typedBufferStride:s}=this.attributes.normalCompressed;o.compressNormal(r,t,e,i,n,s)},n._setUV=function(t,e,i){m(this.attributes.uv0,t,e,i)},n.setNormalFromValues=function(t,e,i,n){this._setNormal(this.getAttributeIndex(t),e,i,n)},n.setVertexFromValuesRawPositionUV=function(t,e,i,n,r,s){const u=this.getAttributeIndex(t);this.attributes.position.setValues(u,e,i,n),this._setUV(u,r,s)},n.setVertexFromValuesRawPositionUVNormal=function(t,e,i,n,r,s,u,o,l){const a=this.getAttributeIndex(t);this.attributes.position.setValues(a,e,i,n),this._setUV(a,r,s),this._setNormal(a,u,o,l)},e._createClass(t)}();const f=s.newLayout().vec3f(l.VertexAttribute.POSITION).vec2i16(l.VertexAttribute.UV0).vec2i16(l.VertexAttribute.NORMALCOMPRESSED,{glNormalized:!0}),d=new r.BufferPool((t=>f.createBuffer(t)),(t=>t.count));function h(){d.clear()}function b(t){return d.acquire(t)}function g(t){d.release(t.vertexAttributes),t.vertexAttributes=null,t.indices=null}const x=16384;function m(t,e,i,n){t.setValues(e,i*x,n*x)}function p(t,e,i,n){t<n[0]?n[0]=t:t>n[3]&&(n[3]=t),e<n[1]?n[1]=e:e>n[4]&&(n[4]=e),i<n[2]?n[2]=i:i>n[5]&&(n[5]=i)}t.EdgeDescriptor=c,t.PatchGeometry=a,t.acquireTerrainAttributes=b,t.clearCaches=h,t.encodeUVInBuffer=m,t.minMaxBoundingBox=p,t.releaseGeometry=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
