/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../ViewingMode","../../../../chunks/Terrain.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/basicInterfaces","../lib/Program","../lib/StencilUtils","../lib/VertexAttribute","../../../webgl/enums","../../../webgl/renderState"],(function(e,t,i,r,n,l,a,c,u,o,s,d,h){"use strict";let g=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).useStencil=!1,t}i._inherits(t,e);var n=t.prototype;return n.initializeConfiguration=function(e,t){t.spherical=e.viewingMode===r.ViewingMode.Global},n.initializeProgram=function(e){return new u.Program(e.rctx,t.shader.get().build(this.configuration),p)},n.initializePipeline=function(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)},n._createPipeline=function(e){const t=this.configuration,i=t.backfaceCullingEnabled&&!t.renderOccluded;return h.makePipelineState({blending:t.renderOccluded?h.simpleBlendingParams(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA):null,culling:i?h.backFaceCullingParams:null,depthTest:t.renderOccluded?null:{func:d.CompareFunction.LESS},depthWrite:t.renderOccluded?null:h.defaultDepthWriteParams,colorWrite:h.defaultColorWriteParams,stencilTest:e?o.renderWhenBitIsNotSet(c.StencilBits.IntegratedMeshMaskExcluded):null})},n.getPipelineState=function(e,r){return this.useStencil?this._stencilPipelineState:i._get(i._getPrototypeOf(t.prototype),"getPipelineState",this).call(this,e,r)},i._createClass(t)}(a.ShaderTechnique);g.shader=new l.ReloadableShaderModule(n.Terrain,(()=>new Promise(((t,i)=>e(["../core/shaderLibrary/terrain/Terrain.glsl"],t,i)))));const p=new Map([[s.VertexAttribute.POSITION,0],[s.VertexAttribute.UV0,1],[s.VertexAttribute.NORMALCOMPRESSED,2]]);t.TerrainTechnique=g,t.terrainVertexAttributeLocations=p,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
