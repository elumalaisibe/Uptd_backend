/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../environment/ChapmanAtmosphereTechniqueConfiguration","./glUtil3D","../../../../chunks/AtmosphereCompositing.glsl","../shaders/AtmosphereCompositingTechnique","../../../../chunks/Compositing.glsl","../shaders/CompositingTechnique","../shaders/CompositingTechniqueConfiguration","../../../../chunks/HUDCompositing.glsl","../shaders/HUDCompositingTechnique","../../../../chunks/OITCompositing.glsl","../shaders/OITCompositingTechnique","../../../../chunks/OverlayCompositing.glsl","../shaders/OverlayCompositingTechnique","../../../webgl/enums","../../../webgl/Util"],(function(e,t,i,s,r,o,n,a,h,u,c,m,p,_,g,l,P){"use strict";return function(){function T(e,t){this._rctx=e,this._techniqueRepository=t,this._configuration=new h.CompositingTechniqueConfiguration,this._atmosphereConfiguration=new i.ChapmanAtmosphereTechniqueConfiguration,this._passParameters=new n.CompositingPassParameters,this._atmosphereParameters=new r.AtmosphereCompositingPassParameters,this._oitParameters=new m.OITCompositingPassParameters,this._hudParameters=new u.HUDCompositingPassParameters,this._overlayParameters=new _.OverlayCompositingPassParameters}var y=T.prototype;return y.destroy=function(){this._vao=t.disposeMaybe(this._vao)},y.compositeOIT=function(e,t,i,s){this._oitParameters.colorTexture=t,this._oitParameters.alphaTexture=i,this._oitParameters.frontFaceTexture=s;const r=this._rctx,o=this._techniqueRepository.acquire(p.OITCompositingTechnique);r.bindTechnique(o,this._oitParameters,e);const n=this._ensureVAO();r.bindVAO(n),r.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,P.vertexCount(n,"geometry")),o.release()},y.compositeHUD=function(e,t){this._hudParameters.texture=t;const i=this._rctx,s=this._techniqueRepository.acquire(c.HUDCompositingTechnique);i.bindTechnique(s,this._hudParameters,e);const r=this._ensureVAO();i.bindVAO(r),i.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,P.vertexCount(r,"geometry")),s.release()},y.compositeOverlay=function(e,t,i,s){this._overlayParameters.texture=t,this._overlayParameters.opacity=i,this._overlayParameters.overlayIndex=s;const r=this._rctx,o=this._techniqueRepository.acquire(g.OverlayCompositingTechnique);r.bindTechnique(o,this._overlayParameters,e);const n=this._ensureVAO();r.bindVAO(n),r.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,P.vertexCount(n,"geometry")),o.release()},y.compositeAtmosphere=function(e,t,i,s,r){const n=this._rctx;this._atmosphereParameters.texture=t,this._atmosphereParameters.depthTexture=i,this._atmosphereParameters.scale=s,this._atmosphereConfiguration.haze=r;const a=this._techniqueRepository.acquire(o.AtmosphereCompositingTechnique,this._atmosphereConfiguration);n.bindTechnique(a,this._atmosphereParameters,e);const h=this._ensureVAO();n.bindVAO(h),n.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,P.vertexCount(h,"geometry")),a.release()},y.composite=function(e,t,i=h.AlphaMode.None,s=1){const r=this._rctx;this._configuration.alphaMode=i,this._configuration.hasOpacityFactor=1!==s,this._passParameters.texture=t,this._passParameters.opacity=s;const o=this._techniqueRepository.acquire(a.CompositingTechnique,this._configuration);r.bindTechnique(o,this._passParameters,e);const n=this._ensureVAO();r.bindVAO(n),r.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,P.vertexCount(n,"geometry")),o.release()},y._ensureVAO=function(){return null==this._vao&&(this._vao=s.createQuadVAO(this._rctx)),this._vao},e._createClass(T)}()}));
