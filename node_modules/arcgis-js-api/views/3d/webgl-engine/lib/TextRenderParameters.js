/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../Color","../../../../core/fontUtils","../../../../core/Logger","../../../../core/screenUtils","../../../../chunks/vec4f64"],(function(o,e,t,n,r,i,l){"use strict";let a=function(){function o(o){this.definition=o,this.key=JSON.stringify(o),this.haloSize=Math.round(o.halo.size),this.textStyle=this._colorToRGBA(o.color),this.haloStyle=this._colorToRGB(o.halo.color),this.backgroundStyle=0!==o.background.color[3]?this._colorToRGBA(o.background.color):null}var a=o.prototype;return a.fontString=function(o){const e=this.definition.font;return`${e.style} ${e.weight} ${o}px ${e.family}, sans-serif`},a._colorToRGB=function(o){return`rgb(${o.slice(0,3).map((o=>Math.floor(255*o))).toString()})`},a._colorToRGBA=function(o){return`rgba(${o.slice(0,3).map((o=>Math.floor(255*o))).toString()},${o[3]})`},o.fromSymbol=async function(e,a){const c=e?.material?.color,u=t.toUnitRGBA(c)??l.ZEROS,f=null!=e.size?i.pt2px(e.size):12,g=e.lineHeight,d=null!=e.background?t.toUnitRGBA(e.background.color):l.ZEROS,h={family:e.font?.family??"sans-serif",decoration:e.font?.decoration??"none",weight:e.font?.weight??"normal",style:e.font?.style??"normal"},m=e.halo,y=null!=m&&null!=m.color&&m.size>0?{size:i.pt2px(m.size),color:t.toUnitRGBA(m.color)}:{size:0,color:l.ZEROS},b=new o({color:u,size:f,background:{color:d,padding:null!=e.background?[.65*f,.5*f]:[0,0],borderRadius:null!=e.background?f*(6/16):0},lineSpacingFactor:g,font:h,halo:y,pixelRatio:a});if(e.font){let o=!1;const t=b.fontString(f);try{o=(await document.fonts.load(t)).some((o=>!n.isCachedFontFace(o)))}catch(p){r.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${t}'. Some text symbology may be rendered using the default browser font.`)}if(!o&&!s.has(e.font.family))try{await n.loadFont(e.font)}catch(p){}}return b},e._createClass(o)}();const s=new Set(["Arial","Times New Roman","Courier New","serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]);o.TextRenderParameters=a,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));
