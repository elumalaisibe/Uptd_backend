/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../core/promiseUtils","../core/shaderModules/interfaces","./basicInterfaces","./GLMaterial"],(function(e,t,r,u,i,s,l){"use strict";let n=function(e){function i(t){var r;return(r=e.call(this,t)||this)._numLoading=0,r._disposed=!1,r._textureRepository=t.textureRep,r._textureId=t.textureId,r._acquire(t.textureId,(e=>r._texture=e)),r._acquire(t.normalTextureId,(e=>r._textureNormal=e)),r._acquire(t.emissiveTextureId,(e=>r._textureEmissive=e)),r._acquire(t.occlusionTextureId,(e=>r._textureOcclusion=e)),r._acquire(t.metallicRoughnessTextureId,(e=>r._textureMetallicRoughness=e)),r}t._inherits(i,e);var l=i.prototype;return l.dispose=function(){this._texture=r.releaseMaybe(this._texture),this._textureNormal=r.releaseMaybe(this._textureNormal),this._textureEmissive=r.releaseMaybe(this._textureEmissive),this._textureOcclusion=r.releaseMaybe(this._textureOcclusion),this._textureMetallicRoughness=r.releaseMaybe(this._textureMetallicRoughness),this._disposed=!0},l.ensureResources=function(e){return 0===this._numLoading?s.ResourceState.LOADED:s.ResourceState.LOADING},l.updateTexture=function(e){null!=this._texture&&e===this._texture.id||(this._texture=r.releaseMaybe(this._texture),this._textureId=e,this._acquire(this._textureId,(e=>this._texture=e)))},l._acquire=function(e,t){if(null==e)return void t(null);const i=this._textureRepository.acquire(e);if(u.isPromiseLike(i))return++this._numLoading,void i.then((e=>{if(this._disposed)return r.releaseMaybe(e),void t(null);t(e)})).finally((()=>--this._numLoading));t(i)},t._createClass(i,[{key:"textureBindParameters",get:function(){return new a(null!=this._texture?this._texture.glTexture:null,null!=this._textureNormal?this._textureNormal.glTexture:null,null!=this._textureEmissive?this._textureEmissive.glTexture:null,null!=this._textureOcclusion?this._textureOcclusion.glTexture:null,null!=this._textureMetallicRoughness?this._textureMetallicRoughness.glTexture:null)}}]),i}(l),a=function(e){function r(t=null,r=null,u=null,i=null,s=null){var l;return(l=e.call(this)||this).texture=t,l.textureNormal=r,l.textureEmissive=u,l.textureOcclusion=i,l.textureMetallicRoughness=s,l}return t._inherits(r,e),t._createClass(r)}(i.NoParameters);e.GLTextureMaterial=n,e.GLTextureMaterialBindParameters=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
