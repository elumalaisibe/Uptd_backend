/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/RandomLCG","../../../../../chunks/vec3","../../../../../chunks/vec3f64","../../../support/buffer/glUtil","./bufferLayouts"],(function(t,e,n,o,i,r,s){"use strict";let a=function(){function t(){}var n=t.prototype;return n.updateSettings=function(t){this.settings=t,this._edgeHashFunction=t.reducedPrecision?m:l},n.write=function(t,e,n){const o=this._edgeHashFunction(n);_.seed=o;const i=_.getIntRange(0,255),r=_.getIntRange(0,this.settings.variants-1),s=.7,a=_.getFloat(),u=255*(.5*d(-(1-Math.min(a/s,1))+Math.max(0,a-s)/(1-s),1.2)+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,i),t.variantStroke.set(e,r),t.variantExtension.set(e,u)},n.trim=function(t,e){return t.slice(0,e)},e._createClass(t)}();const u=new Float32Array(6),c=new Uint32Array(u.buffer),f=new Uint32Array(1);function l(t){const e=u;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],f[0]=5381;for(let n=0;n<c.length;n++)f[0]=31*f[0]+c[n];return f[0]}function m(t){const e=u;e[0]=p(t.position0[0]),e[1]=p(t.position0[1]),e[2]=p(t.position0[2]),e[3]=p(t.position1[0]),e[4]=p(t.position1[1]),e[5]=p(t.position1[2]),f[0]=5381;for(let n=0;n<c.length;n++)f[0]=31*f[0]+c[n];return f[0]}const g=1e4;function p(t){return Math.round(t*g)/g}function d(t,e){const n=t<0?-1:1;return Math.abs(t)**e*n}let h=function(){function t(){this._commonWriter=new a}var n=t.prototype;return n.updateSettings=function(t){this._commonWriter.updateSettings(t)},n.allocate=function(t){return s.RegularEdgeInstancesLayout.createBuffer(t)},n.write=function(t,e,n){this._commonWriter.write(t,e,n),o.add(L,n.faceNormal0,n.faceNormal1),o.normalize(L,L),t.normal.setVec(e,L)},n.trim=function(t,e){return this._commonWriter.trim(t,e)},e._createClass(t)}();h.Layout=s.RegularEdgeInstancesLayout,h.glLayout=r.glLayout(s.RegularEdgeInstancesLayout,1);let y=function(){function t(){this._commonWriter=new a}var n=t.prototype;return n.updateSettings=function(t){this._commonWriter.updateSettings(t)},n.allocate=function(t){return s.SilhouetteEdgeInstancesLayout.createBuffer(t)},n.write=function(t,e,n){this._commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)},n.trim=function(t,e){return this._commonWriter.trim(t,e)},e._createClass(t)}();y.Layout=s.SilhouetteEdgeInstancesLayout,y.glLayout=r.glLayout(s.SilhouetteEdgeInstancesLayout,1);const L=i.create(),_=new n;t.CommonBufferWriter=a,t.RegularEdgeBufferWriter=h,t.SilhouetteEdgeBufferWriter=y,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
