/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../assets","../../../../../core/Accessor","../../../../../core/Logger","../../../../../core/maybe","../../../../../core/accessorSupport/decorators/property","../../../../../core/accessorSupport/ensureType","../../../../../core/arrayUtils","../../../../../core/has","../../../../../core/accessorSupport/decorators/subclass","../../../../../support/requestImageUtils","../../core/shaderModules/interfaces","../../lib/basicInterfaces","../../../../webgl/enums","../../../../webgl/Texture","../../../../webgl/TextureDescriptor"],(function(e,t,r,a,s,o,i,n,u,l,p,c,h,g,d,m,_,y){"use strict";e.WaterTextureRepository=function(e){function r(){var t;return(t=e.apply(this,arguments)||this)._passParameters=new w,t._loading=0,t}t._inherits(r,e);var s=r.prototype;return s.destroy=function(){this._passParameters.waveNormal=i.disposeMaybe(this._passParameters.waveNormal),this._passParameters.wavePertubation=i.disposeMaybe(this._passParameters.wavePertubation)},s.ensureResources=function(e){if(this._loading>0)return d.ResourceState.LOADING;if(null!=this._passParameters.waveNormal&&null!=this._passParameters.wavePertubation)return d.ResourceState.LOADED;const t=new y.TextureDescriptor;return t.samplingMode=m.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,t.hasMipmap=!0,t.maxAnisotropy=8,++this._loading,h.requestImage(a.getAssetUrl("esri/images/materials/water/normals.jpg")).then((r=>this._passParameters.waveNormal=new _.Texture(e,{...t,width:r.width,height:r.height},r))).catch((e=>o.getLogger(this).error("Failed to load water material normal texture.",e))).finally((()=>--this._loading)),++this._loading,h.requestImage(a.getAssetUrl("esri/images/materials/water/perturbation.jpg")).then((r=>this._passParameters.wavePertubation=new _.Texture(e,{...t,width:r.width,height:r.height},r))).catch((e=>o.getLogger(this).error("Failed to load water material pertubation texture.",e))).finally((()=>--this._loading)),d.ResourceState.LOADING},t._createClass(r,[{key:"passParameters",get:function(){return this._passParameters}},{key:"updating",get:function(){return this._loading>0}}]),r}(s),r.__decorate([n.property()],e.WaterTextureRepository.prototype,"_loading",void 0),r.__decorate([n.property({type:Boolean,readOnly:!0})],e.WaterTextureRepository.prototype,"updating",null),e.WaterTextureRepository=r.__decorate([c.subclass("esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository")],e.WaterTextureRepository);let w=function(e){function r(){return e.apply(this,arguments)||this}return t._inherits(r,e),t._createClass(r)}(g.NoParameters);e.WaterTexturePassParameters=w,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
