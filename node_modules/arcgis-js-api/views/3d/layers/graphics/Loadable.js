/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../core/promiseUtils"],(function(t,o,r,a){"use strict";let l=function(){function l(o){this.schedule=o,this._abortController=null,this._loadStatus=t.LoadStatus.LOADING,this._loadError=null,this._loader=null,this.logger=null}var s=l.prototype;return s.destroy=function(){this.abortLoad()},s.load=function(o,r){return this._loadStatus===t.LoadStatus.LOADED?(o&&o(),this._loader??Promise.resolve()):this._loadStatus===t.LoadStatus.FAILED?(r&&r(this._loadError),this._loader??Promise.resolve()):(null==this._loader&&(this._abortController=new AbortController,this._loader=this.doLoad(this._abortController.signal).then((()=>{this._abortController=null,this._loadStatus=t.LoadStatus.LOADED}),(o=>{throw this._loadError=o,this._abortController=null,this._loadStatus=t.LoadStatus.FAILED,!a.isAbortError(o)&&this.logger&&o.message&&this.logger.warn(o.message),o}))),this._loader.then(o,r).catch((()=>{})),this._loader)},s.abortLoad=function(){null!=this._abortController?this._abortController=r.abortMaybe(this._abortController):this._loadStatus===t.LoadStatus.LOADING&&(this._loadStatus=t.LoadStatus.FAILED),this._loader=null},o._createClass(l,[{key:"loadStatus",get:function(){return this._loadStatus}}]),l}();var s;t.LoadStatus=void 0,(s=t.LoadStatus||(t.LoadStatus={}))[s.LOADING=0]="LOADING",s[s.LOADED=1]="LOADED",s[s.FAILED=2]="FAILED",t.Loadable=l,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
