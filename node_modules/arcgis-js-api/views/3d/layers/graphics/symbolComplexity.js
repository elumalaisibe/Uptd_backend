/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../core/compilerUtils","../../../../symbols/support/ObjectSymbol3DLayerResource","./Graphics3DPathSymbolLayerConstants","./primitiveObjectSymbolUtils","../support/edgeUtils","../../webgl-engine/lib/VertexAttribute","../../webgl-engine/lib/lodRendering/LodResources"],(function(e,r,t,a,s,i,o,u){"use strict";const y={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function b(e){if("web-style"===e.type)return y;return P(e.symbolLayers.toArray().map((r=>n(e,r))))}function P(e){let r=0,t=0,a=0,s=!1,i=0;const o={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}};for(const u of e)null!=u&&(r+=u.primitivesPerFeature,t+=u.primitivesPerCoordinate,a+=u.drawCallsPerFeature,o.bytesPerFeature+=u.memory.bytesPerFeature,o.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,o.bytesPerCoordinate+=u.memory.bytesPerCoordinate,o.resourceBytes+=u.memory.resourceBytes,o.draped.bytesPerFeature+=u.memory.bytesPerFeature,o.draped.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,o.draped.bytesPerCoordinate+=u.memory.bytesPerCoordinate,s=s||u.estimated,++i);return{primitivesPerFeature:r,primitivesPerCoordinate:t,drawCallsPerFeature:a,estimated:s,memory:o,numComplexities:i}}function d(e){const r=P(e);return r.numComplexities>0&&(r.primitivesPerFeature/=r.numComplexities,r.primitivesPerCoordinate/=r.numComplexities,r.drawCallsPerFeature/=r.numComplexities,r.memory.bytesPerFeature/=r.numComplexities,r.memory.bytesPerFeatureLabel/=r.numComplexities,r.memory.bytesPerCoordinate/=r.numComplexities,r.memory.resourceBytes/=r.numComplexities,r.memory.draped.bytesPerFeature/=r.numComplexities,r.memory.draped.bytesPerFeatureLabel/=r.numComplexities,r.memory.draped.bytesPerCoordinate/=r.numComplexities),r}const l={};function n(e,s){const o=m(e,s),u=i.hasEdges(s)?2:0;switch(s.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:u,estimated:!1,memory:o};case"fill":return"mesh-3d"===e.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:u,estimated:!1,memory:o}:null!=s.outline&&s.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:o}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:o};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:o};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:o};case"object":if(s.resource?.href)return{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:o};return{...F(s.resource&&s.resource.primitive||t.defaultPrimitive),memory:o};case"path":{let e=0,t=0;switch(s.profile){case"circle":e=a.PATH_NUM_CIRCLE_PROFILE_SUBDIVISIONS;break;case"quad":e=4;break;default:return void r.neverReached(s.profile)}switch(s.join??"simple"){case"round":t=a.PATH_NUM_ROUND_JOIN_SUBDIVISIONS;break;case"miter":case"bevel":t=1;break;default:return}const i=2*e,u=e*t*2;let y=-2*u-i;switch(s.cap){case"none":break;case"butt":case"square":y+=2*(e-1);break;case"round":y+=2*(e*(a.PATH_NUM_ROUND_CAP_EXTRUSION_SUBDIVISIONS-1)*2+e);break;default:return}return{primitivesPerFeature:y,primitivesPerCoordinate:u+i,drawCallsPerFeature:0,estimated:!1,memory:o}}case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:o};default:return}}function m(e,t){const a="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?c.EXTRUDE_EDGES:c.EXTRUDE;case"fill":return null!=t.outline&&t.outline.size>0?c.FILL_OUTLINE:c.FILL;case"water":return c.FILL;case"line":return"round"===t.join?c.LINE_ROUND:c.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return c.PATH_ROUND_CIRCLE;case"quad":return c.PATH_ROUND_QUAD;default:return void r.neverReached(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return c.PATH_MITER_CIRCLE;case"quad":return c.PATH_MITER_QUAD;default:return void r.neverReached(t.profile)}default:return}case"object":return a?c.OBJECT_POINT:c.OBJECT_POLYGON;case"icon":case"text":return a?c.ICON_POINT:c.ICON_POLYGON;default:return}}function F(e){let r=l[e];if(r)return r;const t=s.primitiveLodResources(e,null);return r={primitivesPerFeature:u.geometriesFromLodLevelResources(t.levels[0]).reduce(((e,r)=>e+r.indices.get(o.VertexAttribute.POSITION).length/3),0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},l[e]=r,r}const c={ICON_POINT:{bytesPerFeature:2321.5204640676384,bytesPerFeatureLabel:990.45722,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:2169.5155951150787,bytesPerFeatureLabel:999.2598599999999,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:3822.4566594216512,bytesPerFeatureLabel:1004.4288266666666,bytesPerCoordinate:3.8232947206245864,resourceBytes:0,draped:{bytesPerFeature:3656.161389156324,bytesPerFeatureLabel:994.9227800000001,bytesPerCoordinate:3.836714603517761}},OBJECT_POINT:{bytesPerFeature:1286.2669145138564,bytesPerFeatureLabel:1011.4901900000001,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:1286.2669145138564,bytesPerFeatureLabel:1011.4901900000001,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:2796.828455517831,bytesPerFeatureLabel:1012.9951500000002,bytesPerCoordinate:4.051546356517487,resourceBytes:0,draped:{bytesPerFeature:2796.828455517831,bytesPerFeatureLabel:1012.9951500000002,bytesPerCoordinate:4.051546356517487}},LINE_MITER:{bytesPerFeature:4906.045480276492,bytesPerFeatureLabel:1002.8815266666666,bytesPerCoordinate:24.04850207798191,resourceBytes:0,draped:{bytesPerFeature:4315.785832179941,bytesPerFeatureLabel:998.7028333333334,bytesPerCoordinate:19.457038722015074}},LINE_ROUND:{bytesPerFeature:4893.576398024015,bytesPerFeatureLabel:1015.8812866666666,bytesPerCoordinate:24.039686621147293,resourceBytes:0,draped:{bytesPerFeature:4321.076505943878,bytesPerFeatureLabel:1008.7058400000001,bytesPerCoordinate:19.522527447599565}},PATH_MITER_CIRCLE:{bytesPerFeature:27475.37385725739,bytesPerFeatureLabel:945.1915,bytesPerCoordinate:1936.190695268645,resourceBytes:0,draped:{bytesPerFeature:27475.37385725739,bytesPerFeatureLabel:945.1915,bytesPerCoordinate:1936.190695268645}},PATH_ROUND_CIRCLE:{bytesPerFeature:13432.532036888486,bytesPerFeatureLabel:949.8167000000001,bytesPerCoordinate:4250.913048917402,resourceBytes:0,draped:{bytesPerFeature:13432.532036888486,bytesPerFeatureLabel:949.8167000000001,bytesPerCoordinate:4250.913048917402}},PATH_MITER_QUAD:{bytesPerFeature:17083.041162790672,bytesPerFeatureLabel:1006.4104,bytesPerCoordinate:1543.9135284683243,resourceBytes:0,draped:{bytesPerFeature:17083.041162790672,bytesPerFeatureLabel:1006.4104,bytesPerCoordinate:1543.9135284683243}},PATH_ROUND_QUAD:{bytesPerFeature:24054.406240577355,bytesPerFeatureLabel:976.0122999999999,bytesPerCoordinate:2683.863857257418,resourceBytes:0,draped:{bytesPerFeature:24054.406240577355,bytesPerFeatureLabel:976.0122999999999,bytesPerCoordinate:2683.863857257418}},FILL:{bytesPerFeature:5336.950602511737,bytesPerFeatureLabel:993.6785799999999,bytesPerCoordinate:9.558162275921951,resourceBytes:0,draped:{bytesPerFeature:4643.732435264264,bytesPerFeatureLabel:1003.6394400000001,bytesPerCoordinate:8.123952159573538}},FILL_OUTLINE:{bytesPerFeature:8210.8457089066,bytesPerFeatureLabel:1006.2871066666667,bytesPerCoordinate:14.496686428135353,resourceBytes:0,draped:{bytesPerFeature:6982.149803527473,bytesPerFeatureLabel:1005.1158800000001,bytesPerCoordinate:11.034666572000932}},EXTRUDE:{bytesPerFeature:16336.386002724352,bytesPerFeatureLabel:1013.2957066666665,bytesPerCoordinate:40.50904192903909,resourceBytes:0,draped:{bytesPerFeature:16336.386002724352,bytesPerFeatureLabel:1013.2957066666665,bytesPerCoordinate:40.50904192903909}},EXTRUDE_EDGES:{bytesPerFeature:18251.260762353977,bytesPerFeatureLabel:1044.1864133333333,bytesPerCoordinate:40.594518397678755,resourceBytes:0,draped:{bytesPerFeature:18251.260762353977,bytesPerFeatureLabel:1044.1864133333333,bytesPerCoordinate:40.594518397678755}}};e.averageSymbolComplexities=d,e.defaultSymbolComplexity=b,e.defaultSymbolLayerComplexity=n,e.defaultSymbolLayerMemoryComplexity=m,e.emptySymbolComplexity=y,e.memoryEstimators=c,e.totalSymbolComplexities=P,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
