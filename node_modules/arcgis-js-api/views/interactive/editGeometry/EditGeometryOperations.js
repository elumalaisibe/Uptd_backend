/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/Evented","./EditGeometry","./interfaces","./operations/AppendVertex","./operations/UpdateVertices","./operations/RemoveVertices","./operations/SplitEdge","./operations/SetVertexPosition","./operations/CloseComponent","./operations/MoveVertex","./operations/OffsetEdgeVertex","./operations/RotateVertex","./operations/ScaleVertex","./operations/UndoGroup"],(function(e,t,n,r,o,i,a,s,u,c,p,d,l,h,m,V){"use strict";let f=function(e){function n(t){var n;return(n=e.call(this)||this).data=t,n._undoStack=[],n._redoStack=[],n._listener=n.data.on("change",(e=>{e.addedVertices&&n.emit("vertex-add",{type:"vertex-add",vertices:e.addedVertices,operation:e.operation}),e.removedVertices&&n.emit("vertex-remove",{type:"vertex-remove",vertices:e.removedVertices,operation:e.operation}),e.updatedVertices&&n.emit("vertex-update",{type:"vertex-update",vertices:e.updatedVertices,operation:e.operation})})),n}t._inherits(n,e);var f=n.prototype;return f.destroy=function(){this._listener.remove()},f.splitEdge=function(e,t){return this._apply(new u.SplitEdge(this.data,e,t))},f.updateVertices=function(e,t,n=o.AccumulationBehaviour.ACCUMULATE_STEPS){return this._apply(new a.UpdateVertices(this.data,e,t),n)},f.moveVertices=function(e,t,n,r,i=o.AccumulationBehaviour.ACCUMULATE_STEPS){return this.updateVertices(e,new d.MoveVertex(this.data.coordinateHelper,t,n,r),i)},f.scaleVertices=function(e,t,n,r,i,s=o.AccumulationBehaviour.ACCUMULATE_STEPS,u=a.AccumulationType.CUMULATIVE){return this.updateVertices(e,new m.ScaleVertex(t,n,r,i,u),s)},f.rotateVertices=function(e,t,n,r=o.AccumulationBehaviour.ACCUMULATE_STEPS,i=a.AccumulationType.CUMULATIVE){return this.updateVertices(e,new h.RotateVertex(t,n,i),r)},f.removeVertices=function(e){return this._apply(new s.RemoveVertices(this.data,e,this._minNumVerticesPerType))},f.appendVertex=function(e){return 0===this.data.components.length?null:this._apply(new i.AppendVertex(this.data,this.data.components[0],e))},f.setVertexPosition=function(e,t){return this._apply(new c.SetVertexPosition(this.data,e,t))},f.offsetEdge=function(e,t,n,r=o.AccumulationBehaviour.ACCUMULATE_STEPS){return this.updateVertices([t.leftVertex,t.rightVertex],new l.OffsetEdgeVertex(this.data.coordinateHelper,e,t,n),r)},f.closeComponent=function(e){return this.data.components.includes(e)?this._apply(new p.CloseComponent(this.data,e)):null},f.canRemoveVertex=function(){return this.data.components[0].vertices.length>this._minNumVerticesPerType},f.createUndoGroup=function(){const e=new V.UndoGroup;return this._apply(e),{remove:()=>e.close()}},f.undo=function(){if(this._undoStack.length>0){const e=this._undoStack.pop();return e.undo(),this._redoStack.push(e),e}return null},f.redo=function(){if(this._redoStack.length>0){const e=this._redoStack.pop();return e.apply(),this._undoStack.push(e),e}return null},f._apply=function(e,t=o.AccumulationBehaviour.ACCUMULATE_STEPS){return t!==o.AccumulationBehaviour.NEW_STEP&&null!=this.lastOperation&&this.lastOperation.accumulate(e)||(e.apply(),this._undoStack.push(e),this._redoStack=[]),e},n.fromGeometry=function(e,t){return new n(r.EditGeometry.fromGeometry(e,t))},t._createClass(n,[{key:"canUndo",get:function(){return this._undoStack.length>0}},{key:"canRedo",get:function(){return this._redoStack.length>0}},{key:"lastOperation",get:function(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}},{key:"_minNumVerticesPerType",get:function(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}}]),n}(n);e.EditGeometryOperations=f,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
