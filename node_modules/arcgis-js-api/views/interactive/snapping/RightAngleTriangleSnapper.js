/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/vec2","../../../chunks/vec2f64","../../../chunks/vec3f64","../../../support/elevationInfoUtils","./SnappingAlgorithm","./SnappingPoint","./snappingUtils","./candidates/RightAngleTriangleSnappingCandidate","../support/viewUtils","../../support/geometry2dUtils"],(function(e,t,n,i,o,r,s,a,p,c,l,g){"use strict";let d=function(e){function i(){return e.apply(this,arguments)||this}t._inherits(i,e);var s=i.prototype;return s.snapNewVertex=function(e,t){const n=t.editGeometryOperations.data.components[0],i=[],o=n.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||o<2)return i;const{view:r}=this,s=n.vertices[0],p=n.vertices[o-1],c=a.anyMapPointToSnappingPoint(s.pos,r,t),l=a.anyMapPointToSnappingPoint(p.pos,r,t);return this._processCandidateProposal(c,l,e,t,i),i},s.snapExistingVertex=function(e,t){const n=[],i=t.vertexHandle,o=i.component;if(o.edges.length<2)return n;if("polyline"===t.editGeometryOperations.data.type&&(0===i.index||i.index===o.vertices.length-1))return n;const{view:r}=this,s=a.anyMapPointToSnappingPoint(i.leftEdge.leftVertex.pos,r,t),p=a.anyMapPointToSnappingPoint(i.rightEdge.rightVertex.pos,r,t);return this._processCandidateProposal(s,p,e,t,n),n},s._processCandidateProposal=function(e,t,i,s,d){if(!this.exceedsShortLineThreshold(e,t,s))return;const u=n.lerp(h,e,t,.5),f=.5*n.distance(e,t),v=o.create();g.projectPointToCircle(v,i,u,f),v[2]=i[2];const P=a.asSnappingPoint(v),{spatialReference:y,pointer:S}=s,T=l.vectorToScreenPoint(i,y,r.absoluteHeightElevationInfo,this.view);if(p.squaredScreenDistance(T,l.vectorToScreenPoint(P,y,r.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(S)){if(this.isVertical(e,P)||this.isVertical(P,t))return;d.push(new c.RightAngleTriangleSnappingCandidate({targetPoint:P,point1:e,point2:t,isDraped:"on-the-ground"===s.elevationInfo?.mode}))}},t._createClass(i)}(s.SnappingAlgorithm);const h=i.create();e.RightAngleTriangleSnapper=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
