/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","../../../../core/lang","../../../../core/LRUCache","../../../../core/promiseUtils","../../../../core/string"],(function(e,t,n,o,c,r,s){"use strict";function i(e=!1,t){return e?new u(t):new a}let a=function(){function e(){}var n=e.prototype;return n.fetch=async function(){return[]},n.notifySymbologyChange=function(){},t._createClass(e)}();const h=1024;let u=function(){function e(e){this._getSymbologyCandidates=e,this._candidatesCache=new c.LRUCache(h),this._cacheVersion=0}var n=e.prototype;return n.fetch=async function(e,t){if(0===e.length)return[];const n=[],c=[],s=this._candidatesCache;for(const r of e){const e=f(r),t=s.get(e);if(t)for(const n of t)c.push(o.clone(n));else n.push(r),s.put(e,[],1)}if(0===n.length)return c;const i=this._cacheVersion,{candidates:a,sourceCandidateIndices:h}=await this._getSymbologyCandidates(n,t);r.throwIfAborted(t);if(i!==this._cacheVersion)return this.fetch(e,t);const u=[],{length:l}=a;for(let r=0;r<l;++r){const e=a[r],t=f(n[h[r]]),c=s.get(t);c.push(e),s.put(t,c,c.length),u.push(o.clone(e))}return c.concat(u)},n.notifySymbologyChange=function(){this._candidatesCache.clear(),this._cacheVersion++},t._createClass(e)}();function f(e){switch(e.type){case"vertex":{const{objectId:t,target:n}=e,o=`${t}-vertex-${n.x}-${n.y}-${n.z??0}`;return s.numericHash(o).toString()}case"edge":{const{objectId:t,start:n,end:o}=e,c=`${t}-edge-${n.x}-${n.y}-${n.z??0}-to-${o.x}-${o.y}-${o.z??0}`;return s.numericHash(c).toString()}default:return""}}e.getSymbologySnappingCandidatesFetcher=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
