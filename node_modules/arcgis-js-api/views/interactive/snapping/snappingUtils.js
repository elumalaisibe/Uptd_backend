/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../core/reactiveUtils","../../../chunks/vec3","../../../layers/graphics/dehydratedFeatures","../../input/InputManager","../keybindings","./SnappingPoint"],(function(e,n,t,i,r,a,o){"use strict";function s(e,n){const t=e.length===n.length&&e[0]===n[0]&&e[1]===n[1];switch(e.length){case 2:return t;case 3:return t&&e[2]===n[2];case 4:return t&&e[2]===n[2]&&e[3]===n[3]}return!1}function g(e,n){const t=e.x-n.x,i=e.y-n.y;return t*t+i*i}function p(e,n){return Math.sqrt(g(e,n))}function c(e,n){n.sort(((n,i)=>t.squaredDistance(n.targetPoint,e)-t.squaredDistance(i.targetPoint,e)))}var d;function u({point:e,distance:n,returnEdge:t,returnVertex:r,coordinateHelper:{spatialReference:a}},o,s){return{point:i.makeDehydratedPoint(e[0],e[1],e[2],a.toJSON()),mode:o,distance:n,returnEdge:t,returnVertex:r,query:null!=s?s.toJSON():{where:"1=1"}}}function l(e,n,t){return{left:o.anyMapPointToSnappingPoint(e.leftVertex.pos,n,t),right:o.anyMapPointToSnappingPoint(e.rightVertex.pos,n,t)}}function E(e){return e.createQuery()}function y(e,t=(()=>{})){const i=n.watch((()=>({view:e.view,snappingOptions:e.snappingOptions})),(({view:n,snappingOptions:i})=>{const o="snapping-toggle",s=r.ViewEventPriorities.TOOL;if(e.removeHandles(o),n&&null!=i){const r=[n.on("key-down",(e=>{e.key!==a.SNAPPING_KEYS.toggle||e.repeat||(i.enabledToggled=!0,t())}),s),n.on("key-up",(e=>{e.key===a.SNAPPING_KEYS.toggle&&(i.enabledToggled=!1,t())}),s),n.on("pointer-move",(e=>{const n=e.native.ctrlKey;i.enabledToggled!==n&&(i.enabledToggled=n,t())}),s)];e.addHandles(r,o)}}),n.syncAndInitial);e.addHandles(i)}e.LineSegmentHintType=void 0,(d=e.LineSegmentHintType||(e.LineSegmentHintType={}))[d.TARGET=0]="TARGET",d[d.REFERENCE=1]="REFERENCE",d[d.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION",e.editEdgeToSnappingEdge=l,e.makeFilter=E,e.makeSnappingQuery=u,e.objectEqual=s,e.screenDistance=p,e.setupSnappingToggleHandles=y,e.sortCandidatesInPlace=c,e.squaredScreenDistance=g,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
