/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection"],(function(t,i,a){"use strict";var e;t.ManipulatorVisibilityPredicate=void 0,(e=t.ManipulatorVisibilityPredicate||(t.ManipulatorVisibilityPredicate={}))[e.WhenToolEditable=0]="WhenToolEditable",e[e.WhenToolNotEditable=1]="WhenToolNotEditable",e[e.Always=2]="Always";let o=function(){function e(){this._isToolEditable=!0,this._manipulators=new a,this._resourceContexts={manipulator3D:{}},this._attached=!1}var o=e.prototype;return o.add=function(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([i],a)},o.addMany=function(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){for(const t of i){const i={manipulator:t,visibilityPredicate:a,attached:!1};this._manipulators.add(i),this._attached&&this._updateManipulatorAttachment(i)}},o.remove=function(t){for(let i=0;i<this._manipulators.length;i++)if(this._manipulators.at(i).manipulator===t){const t=this._manipulators.splice(i,1)[0];this._detachManipulator(t);break}},o.removeAll=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()},o.attach=function(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0},o.detach=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1},o.destroy=function(){this.detach(),this._manipulators.forEach((({manipulator:t})=>{t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null},o.on=function(t,i){return this._manipulators.on(t,(t=>{i(t)}))},o.forEach=function(t){for(const i of this._manipulators.items)t(i)},o.some=function(t){return this._manipulators.items.some(t)},o.toArray=function(){const t=[];return this.forEach((i=>t.push(i.manipulator))),t},o.intersect=function(t,i){let a=null,e=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:o,attached:n})=>{if(!n||!o.interactive)return;const r=o.intersectionDistance(t,i);null!=r&&r<e&&(e=r,a=o)})),a},o._updateManipulatorAttachment=function(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)},o._attachManipulator=function(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)},o._detachManipulator=function(t){if(!t.attached)return;const i=t.manipulator;i.grabbing=!1,i.dragging=!1,i.hovering=!1,i.selected=!1,i.detach&&i.detach(this._resourceContexts),t.attached=!1},o._isManipulatorItemVisible=function(i){return i.visibilityPredicate===t.ManipulatorVisibilityPredicate.Always||(this._isToolEditable?i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolEditable:i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolNotEditable)},i._createClass(e,[{key:"isToolEditable",set:function(t){this._isToolEditable=t}},{key:"length",get:function(){return this._manipulators.length}}]),e}();t.ManipulatorCollection=o,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
