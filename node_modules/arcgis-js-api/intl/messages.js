/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../core/Error","../core/promiseUtils","./locale"],(function(e,t,n,s,r){"use strict";const o=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,i={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0},a=Object.keys(i);function l(e){return e in i}const c=[],u=new Map;function d(e){for(const t of u.keys())p(e.pattern,t)&&u.delete(t)}function f(e){return c.includes(e)||(d(e),c.unshift(e)),{remove(){const t=c.indexOf(e);t>-1&&(c.splice(t,1),d(e))}}}async function h(e){const t=r.getLocale();u.has(e)||u.set(e,_(e,t));const n=u.get(e);return n&&await m.add(n),n}function g(e){if(!o.test(e))return null;const t=o.exec(e);if(null===t)return null;const[,n,s]=t,r=n+(s?"-"+s.toUpperCase():"");return l(r)?r:l(n)?n:null}async function _(e,t){const s=[];for(const n of c)if(p(n.pattern,e))try{return await n.fetchMessageBundle(e,t)}catch(r){s.push(r)}if(s.length)throw new n("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:s});throw new n("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function p(e,t){return"string"==typeof e?t.startsWith(e):e.test(t)}r.beforeLocaleChange((()=>{u.clear()}));const m=new(function(){function e(){this._numLoading=0,this._dfd=null}var n=e.prototype;return n.waitForAll=async function(){this._dfd&&await this._dfd.promise},n.add=function(e){return this._increase(),e.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()},n._increase=function(){this._numLoading++,this._dfd||(this._dfd=s.createResolver())},n._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)},t._createClass(e)}()),w={cache:u,loaders:c};e.fetchMessageBundle=h,e.messageBundlesLocales=a,e.normalizeMessageBundleLocale=g,e.registerMessageBundleLoader=f,e.test=w,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
