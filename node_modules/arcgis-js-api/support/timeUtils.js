/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../TimeExtent","../core/arrayUtils","../core/promiseUtils","../core/timeUtils"],(function(e,t,n,i,o){"use strict";function s(e){return void 0!==e.timeInfo}async function r(e,o){if(0===e.length)return t.allTime;const r=e.filter(s);await Promise.all(r.map((e=>e.load({signal:o}))));const a=[],f=[];for(const t of r)"feature"!==t?.type&&"map-image"!==t?.type||!t.timeInfo?.hasLiveData?f.push(t):a.push(t);const l=e=>null==e||e.isAllTime,m=f.map((e=>e.timeInfo?.fullTimeExtent));if(m.some(l))return t.allTime;const u=a.map((async e=>{const{timeExtent:t}=await e.fetchRecomputedExtents({signal:o});return t||e.timeInfo?.fullTimeExtent})),c=(await i.eachAlways(u)).map((e=>e.value));if(c.some(l))return t.allTime;return[...c,...m].filter(n.isSome).reduce(((e,t)=>e.union(t)))}function a(e){if(!e)return e;const{start:n,end:i}=e;return new t({start:null!=n?o.offsetDate(n,-n.getTimezoneOffset(),"minutes"):n,end:null!=i?o.offsetDate(i,-i.getTimezoneOffset(),"minutes"):i})}function f(e){if(!e)return e;const{start:n,end:i}=e;return new t({start:null!=n?o.offsetDate(n,n.getTimezoneOffset(),"minutes"):n,end:null!=i?o.offsetDate(i,i.getTimezoneOffset(),"minutes"):i})}e.getTimeExtentFromLayers=r,e.toLocalTimeExtent=f,e.toUTCTimeExtent=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
