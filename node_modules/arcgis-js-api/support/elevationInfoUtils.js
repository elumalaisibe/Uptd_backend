/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../symbols/support/unitConversionUtils"],(function(e,t){"use strict";function n(e){return e?b:p}function o(e,t){return null!=t&&t.mode?t.mode:n(e).mode}function r(e,t){return null!=t?t:n(e)}function l(e,t){return o(null!=e&&e.hasZ,t)}function u(e,t){return r(null!=e&&!!e.hasZ,t)}function i(e){const t=f(e);return l(e.geometry,t)}function s(e){const n=f(e),o=l(e.geometry,n);return{mode:o,offset:null!=n&&"on-the-ground"!==o?(n.offset??0)*t.getMetersPerUnit(n.unit??"meters"):0}}function a(e){if("on-the-ground"===i(e))return!1;const t=f(e),n=null!=t&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!n||"0"===n)}function f(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function c(e,t,n){if(null==n||!n.mode)return;const o=e.hasZ?e.z:0,r=null!=n.offset?n.offset:0;switch(n.mode){case"absolute-height":return o-r;case"on-the-ground":return 0;case"relative-to-ground":return o-((t.elevationProvider.getElevation(e.x,e.y,o,e.spatialReference,"ground")??0)+r);case"relative-to-scene":return o-((t.elevationProvider.getElevation(e.x,e.y,o,e.spatialReference,"scene")??0)+r)}}function v(e,t,n,o=null){return g(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,o)}function d(e,t,n,o,r=null){return g(e,t[0],t[1],t.length>2?t[2]:0,n,o,r)}function g(e,t,n,o,r,l,u=null){if(null==l)return;const i=null!=u?u.mode:"absolute-height";if("on-the-ground"===i)return 0;const{absoluteZ:s}=h(t,n,o,r,e,l);return E(s,t,n,o,r,e,u,i)}function h(e,t,n,o,r,l){const u=null!=l.offset?l.offset:0;switch(l.mode){case"absolute-height":return{absoluteZ:n+u,elevation:0};case"on-the-ground":{const n=r.elevationProvider.getElevation(e,t,0,o,"ground")??0;return{absoluteZ:n,elevation:n}}case"relative-to-ground":{const l=r.elevationProvider.getElevation(e,t,n,o,"ground")??0;return{absoluteZ:n+l+u,elevation:l}}case"relative-to-scene":{const l=r.elevationProvider.getElevation(e,t,n,o,"scene")??0;return{absoluteZ:n+l+u,elevation:l}}}}function E(e,t,n,o,r,l,u,i){const s=null!=u&&null!=u.offset?u.offset:0;switch(i){case"absolute-height":return e-s;case"relative-to-ground":return e-((l.elevationProvider.getElevation(t,n,o,r,"ground")??0)+s);case"relative-to-scene":return e-((l.elevationProvider.getElevation(t,n,o,r,"scene")??0)+s)}}function m(e,t){if(null==t)return!1;const{mode:n}=t;return null!=n&&("scene"===e&&"relative-to-scene"===n||"ground"===e&&"absolute-height"!==n)}const b={mode:"absolute-height",offset:0},p={mode:"on-the-ground",offset:null};function y(e,t){return e===t||null!=e&&null!=t&&e.mode===t.mode&&e.offset===t.offset}e.absoluteHeightElevationInfo=b,e.elevationContextAffectsAlignment=m,e.elevationInfoLikeEquals=y,e.getConvertedElevation=v,e.getConvertedElevationFromVector=d,e.getEffectiveElevationInfo=r,e.getEffectiveElevationMode=o,e.getGeometryEffectiveElevationInfo=u,e.getGeometryEffectiveElevationMode=l,e.getGraphicEffectiveElevationInfo=s,e.getGraphicEffectiveElevationMode=i,e.getZForElevationMode=c,e.hasGraphicFeatureExpressionInfo=a,e.onTheGroundElevationInfo=p,e.zValueInAbsoluteHeightMode=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
