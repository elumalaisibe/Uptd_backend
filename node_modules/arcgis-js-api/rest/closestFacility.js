/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../request","../geometry/support/normalizeUtils","./networkService","./utils","./route/utils","./support/ClosestFacilitySolveResult","./support/FeatureSet"],(function(e,t,r,i,s,o,a,l){"use strict";function n(e){return e instanceof l}async function c(e,l,c){const u=[],f=[],p={},y={},m=s.parseUrl(e),{path:d}=m;n(l.incidents)&&i.collectGeometries(l.incidents.features,f,"incidents.features",p),n(l.facilities)&&i.collectGeometries(l.facilities.features,f,"facilities.features",p),n(l.pointBarriers)&&i.collectGeometries(l.pointBarriers.features,f,"pointBarriers.features",p),n(l.polylineBarriers)&&i.collectGeometries(l.polylineBarriers.features,f,"polylineBarriers.features",p),n(l.polygonBarriers)&&i.collectGeometries(l.polygonBarriers.features,f,"polygonBarriers.features",p);const B=await r.normalizeCentralMeridian(f);for(const t in p){const e=p[t];u.push(t),y[t]=B.slice(e[0],e[1])}if(i.isInputGeometryZAware(y,u)){let e=null;try{e=await i.fetchServiceDescription(d,l.apiKey,c)}catch{}e&&!e.hasZ&&i.dropZValuesOffInputGeometry(y,u)}for(const t in y)y[t].forEach(((e,r)=>{l.get(t)[r].geometry=e}));const g={...c,query:{...m.query,...o.closestFacilityParametersToQueryParameters(l),f:"json"}},{data:G}=await t(`${d}/solveClosestFacility`,g);return a.fromJSON(G)}e.solve=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
