/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../core/signal"],(function(t,e,s,n){"use strict";let r=function(){function t(){this._tasks=new Array,this._running=n.signal(!1)}var r=t.prototype;return r.destroy=function(){this.cancelAll()},r.runTask=function(t){for(;!t.done&&this._process(t);)t.madeProgress()},r.push=function(t,e,s){return this._running.value=!0,new Promise(((n,r)=>this._tasks.push(new i(n,r,t,e,s))))},r.unshift=function(t,e,s){return this._running.value=!0,new Promise(((n,r)=>this._tasks.unshift(new i(n,r,t,e,s))))},r._process=function(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const n=s.isAborted(e.signal);if(n&&!e.abortCallback)e.reject(s.createAbortError());else{const r=n?e.abortCallback?.(s.createAbortError()):e.callback(t);s.isPromiseLike(r)?r.then(e.resolve,e.reject):e.resolve(r)}}catch(n){e.reject(n)}return this._running.value=this._tasks.length>0,!0},r.cancelAll=function(){const t=s.createAbortError();for(const e of this._tasks)if(e.abortCallback){const s=e.abortCallback(t);e.resolve(s)}else e.reject(t);this._tasks.length=0,this._running.value=!1},e._createClass(t,[{key:"length",get:function(){return this._tasks.length}},{key:"running",get:function(){return this._running.value}}]),t}(),i=e._createClass((function(t,e,s,n=void 0,r=void 0){this.resolve=t,this.reject=e,this.callback=s,this.signal=n,this.abortCallback=r}));t.PromiseQueue=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
