/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/promiseUtils"],(function(t,i,l){"use strict";return function(){function e(t,i=0,l=t.lods[t.lods.length-1].level){this.tileInfo=t,this.minLOD=i,this.maxLOD=l,t.lodAt(i)||(this.minLOD=t.lods[0].level),t.lodAt(l)||(this.maxLOD=t.lods[t.lods.length-1].level)}var n=e.prototype;return n.getAvailability=function(t,i,l){const e=this.tileInfo?.lodAt(t);return!e||t<this.minLOD||t>this.maxLOD?"unavailable":e.cols&&e.rows?l>=e.cols[0]&&l<=e.cols[1]&&i>=e.rows[0]&&i<=e.rows[1]?"unknown":"unavailable":"unknown"},n.fetchAvailability=async function(t,e,n,o){await l.waitTick(o);const a=this.getAvailability(t,e,n);if("unavailable"===a)throw new i("tile-map:tile-unavailable","Tile is not available",{level:t,row:e,col:n});return a},n.fetchAvailabilityUpsample=async function(t,i,e,n,o){await l.waitTick(o),n.level=t,n.row=i,n.col=e;const a=this.tileInfo;return a.updateTileInfo(n),this.fetchAvailability(t,i,e,o).catch((t=>{if(l.isAbortError(t))throw t;if(a.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,o);throw t}))},t._createClass(e,[{key:"effectiveMinLOD",get:function(){return this.minLOD??this.tileInfo.lods[0].level}},{key:"effectiveMaxLOD",get:function(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}}]),e}()}));
