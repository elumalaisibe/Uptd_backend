/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../geometry","../OrientedImageryLayer","./core/ExposurePoint","../../rest/support/Query","../../geometry/Extent"],(function(e,r,t,a,n,o){"use strict";const s={},u=1e3;async function i(e,r){const{point:a,queryParams:o,queryFeatures:i}=e,l={};let m=e.layerInstanceOrURL;if(o&&(l.maxRecordCountFactor=o.maxRecordCountFactor??5,l.outFields=o.outFields??["*"],l.where=o.where??"1=1",l.returnGeometry=o.returnGeometry??!0),"string"==typeof m&&(s.layer&&s.layer.url===m?m=s.layer:(s.layer?.destroy(),m=s.layer=new t({url:m}),await m.load())),m){if(i&&"esri.layers.OrientedImageryLayer"===m?.declaredClass)return y(m)(i);const e=m,t=c(a,o?.maximumDistance??e.maximumDistance??u),s=new n({geometry:t,...l});return e.queryFeatures(s,r).then(y(e))}return null}function y(e){return r=>{const{features:t,spatialReference:n}=r;return t.forEach((r=>{r.geometry&&(r.geometry.spatialReference=n);const t=a.fromJSON({...r.toJSON(),layer:e});t&&(r.attributes=t),r.layer=e,r.spatialReference=n})),r}}function c(e,r){const t=e.x-r,a=e.x+r,n=e.y-r,s=e.y+r;return new o({xmin:t,xmax:a,ymin:n,ymax:s,spatialReference:e.spatialReference})}e.createExtentFromPointAtDistance=c,e.searchImages=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
