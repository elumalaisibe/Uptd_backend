/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../support/PublishingInfo"],(function(e,t,s,r,n,o,i,u,a){"use strict";const l="esri.layers.mixins.PublishableLayer",c=Symbol(l);function h(e){return null!=e&&"object"==typeof e&&c in e}const p=e=>{var n;let o=function(e){function s(){var t;return(t=e.apply(this,arguments)||this)[n]=!0,t}return t._inherits(s,e),s.prototype._checkPublishingStatus=function(e){const t=250,s=125;let r=0;const n=async t=>{let i;e.updating=!0;try{i=await this.fetchPublishingStatus()}catch(u){i="unavailable"}"published"!==i&&"unavailable"!==i||("publishing"===e.status&&this.refresh(),o.remove()),e.status=i,e.updating=!1,o.removed||(r=setTimeout(n,t,t+s))},o={removed:!1,remove(){this.removed=!0,clearTimeout(r)}};this.when().catch((()=>o.remove())),n(t),this.own(o)},t._createClass(s,[{key:"publishingInfo",get:function(){if(this.destroyed)return null;const e=this._get("publishingInfo");if(e)return e;const t=new a;return this._checkPublishingStatus(t),t}}]),s}(e);return n=c,s.__decorate([r.property({readOnly:!0,clonable:!1})],o.prototype,"publishingInfo",null),o=s.__decorate([u.subclass(l)],o),o};e.PublishableLayer=p,e.isPublishableLayer=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
