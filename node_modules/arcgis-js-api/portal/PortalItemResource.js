/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Accessor","../core/Error","../core/Logger","../core/urlUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass"],(function(t,e,r,o,a,l,s,n,p,i,u,c){"use strict";let h=function(r){function o(t){var e;return(e=r.call(this,t)||this).portalItem=null,e}e._inherits(o,r);var n=o.prototype;return n.normalizeCtorArgs=function(t){return t&&t.portalItem&&t.path?{...t,path:this._normalizePath(t.path,t.portalItem)}:t},n._castPath=function(t){return this._normalizePath(t,this.portalItem)},n.fetch=function(t="json",e){const r=this.cdnUrl;if(null==r)throw new a("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:t,query:{token:this.portalItem.apiKey},signal:e?.signal})},n.update=async function(e,r){const{addOrUpdateResource:o}=await new Promise(((e,r)=>t(["./support/resourceUtils"],e,r)));return o(this,"update",e,r)},n.hasPath=function(){return null!=this.path},n._normalizePath=function(t,e){return null==t?t:(t=t.replace(/^\/+/,""),null!=e&&s.isAbsolute(t)&&(t=s.makeRelative(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))},e._createClass(o,[{key:"path",set:function(t){null!=t&&s.isAbsolute(t)?l.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}},{key:"url",get:function(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}},{key:"cdnUrl",get:function(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}},{key:"itemRelativeUrl",get:function(){return this.portalItem&&this.path?`./resources/${this.path}`:null}}]),o}(o);r.__decorate([n.property()],h.prototype,"portalItem",void 0),r.__decorate([n.property({type:String,value:null})],h.prototype,"path",null),r.__decorate([p.cast("path")],h.prototype,"_castPath",null),r.__decorate([n.property({type:String,readOnly:!0})],h.prototype,"url",null),r.__decorate([n.property({type:String,readOnly:!0})],h.prototype,"cdnUrl",null),r.__decorate([n.property({type:String,readOnly:!0})],h.prototype,"itemRelativeUrl",null),h=r.__decorate([c.subclass("esri.portal.PortalItemResource")],h);return h}));
