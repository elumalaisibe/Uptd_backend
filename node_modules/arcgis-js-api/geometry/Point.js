/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/reader","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../core/accessorSupport/ensureType","./Geometry","./SpatialReference","./support/pointUtils","./support/spatialReferenceUtils","./support/webMercatorUtils"],(function(e,t,r,i,o,s,n,a,l,c,u,p,h,d,y,f){"use strict";var g;const _=[0,0];function m(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}let x=g=function(t){function i(...e){var r;return(r=t.call(this,...e)||this).x=0,r.y=0,r.z=void 0,r.m=void 0,r.type="point",r}e._inherits(i,t),i.copy=function(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone())};var o=i.prototype;return o.normalizeCtorArgs=function(e,t,i,o,s){let n;if(Array.isArray(e))n=e,s=t,e=n[0],t=n[1],i=n[2],o=n[3];else if(e&&"object"==typeof e){if(n=e,e=null!=n.x?n.x:n.longitude,t=null!=n.y?n.y:n.latitude,i=n.z,o=n.m,(s=n.spatialReference)&&"esri.geometry.SpatialReference"!==s.declaredClass&&(s=new h(s)),null!=n.longitude||null!=n.latitude)if(null==n.longitude)r.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(null==n.latitude)r.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&s&&s.isWebMercator){const r=f.lngLatToXY(n.longitude,n.latitude,_);e=r[0],t=r[1]}}else m(i)?(s=i,i=null):m(o)&&(s=o,o=null);const a={x:e,y:t};return null==a.x&&null!=a.y?r.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):null==a.y&&null!=a.x&&r.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),null!=s&&(a.spatialReference=s),null!=i&&(a.z=i),null!=o&&(a.m=o),a},o.writeX=function(e,t,r){t[r]=isNaN(e)?"NaN":e},o.readX=function(e){return"string"==typeof e?NaN:e},o.clone=function(){const e=new g;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e},o.copy=function(e){return g.copy(e,this),this},o.equals=function(e){if(null==e)return!1;const{x:t,y:r,z:i,m:o,spatialReference:s}=this,{z:n,m:a}=e;let{x:l,y:c,spatialReference:u}=e;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=f.lngLatToXY(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=f.xyToLngLat(l,c),u=s}return t===l&&r===c&&i===n&&o===a&&s.wkid===u.wkid},o.offset=function(e,t,r){return this.x+=e,this.y+=t,null!=r&&(this.z=(this.z??0)+r),this},o.normalize=function(){if(!this.spatialReference)return this;const e=y.getInfo(this.spatialReference);if(!e)return this;let t=this.x;const[r,i]=e.valid,o=2*i;let s;return t>i?(s=Math.ceil(Math.abs(t-i)/o),t-=s*o):t<r&&(s=Math.ceil(Math.abs(t-r)/o),t+=s*o),this._set("x",t),this},o.distance=function(e){return d.distance(this,e)},o.toArray=function(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]},o.toJSON=function(e){return this.write({},e)},e._createClass(i,[{key:"cache",get:function(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}},{key:"hasM",get:function(){return void 0!==this.m},set:function(e){e!==(void 0!==this._get("m"))&&(this._set("m",e?0:void 0),this._set("hasM",e))}},{key:"hasZ",get:function(){return void 0!==this.z},set:function(e){e!==(void 0!==this._get("z"))&&(this._set("z",e?0:void 0),this._set("hasZ",e))}},{key:"latitude",get:function(){const{spatialReference:e,x:t,y:r}=this;if(e){if(e.isWebMercator)return f.xyToLngLat(t,r,_)[1];if(e.isGeographic)return r}return null},set:function(e){const{spatialReference:t,x:r}=this;null!=e&&t&&(t.isWebMercator?this._set("y",f.lngLatToXY(r,e,_)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}},{key:"longitude",get:function(){const{x:e,y:t,spatialReference:r}=this;if(r){if(r.isWebMercator)return f.xyToLngLat(e,t,_)[0];if(r.isGeographic)return e}return null},set:function(e){const{y:t,spatialReference:r}=this;null!=e&&r&&(r.isWebMercator?this._set("x",f.lngLatToXY(e,t,_)[0]):r.isGeographic&&this._set("x",e),this._set("longitude",e))}}]),i}(p);t.__decorate([i.property({readOnly:!0})],x.prototype,"cache",null),t.__decorate([i.property({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],x.prototype,"hasM",null),t.__decorate([i.property({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],x.prototype,"hasZ",null),t.__decorate([i.property({type:Number})],x.prototype,"latitude",null),t.__decorate([i.property({type:Number})],x.prototype,"longitude",null),t.__decorate([i.property({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),o.cast((e=>isNaN(e)?e:u.ensureNumber(e)))],x.prototype,"x",void 0),t.__decorate([c.writer("x")],x.prototype,"writeX",null),t.__decorate([a.reader("x")],x.prototype,"readX",null),t.__decorate([i.property({type:Number,json:{write:!0}})],x.prototype,"y",void 0),t.__decorate([i.property({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],x.prototype,"z",void 0),t.__decorate([i.property({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],x.prototype,"m",void 0),x=g=t.__decorate([l.subclass("esri.geometry.Point")],x),x.prototype.toJSON.isDefaultToJSON=!0;return x}));
