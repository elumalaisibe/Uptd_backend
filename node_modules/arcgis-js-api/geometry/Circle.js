/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/unitUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./ellipsoidUtils","./Point","./Polygon","./support/geodesicUtils","./support/webMercatorUtils","./support/WKIDUnitConversion"],(function(e,r,t,s,o,i,c,n,a,p,l,u,d,h){"use strict";var g;let f=g=function(r){function s(...e){var t;return(t=r.call(this,...e)||this).center=null,t.geodesic=!1,t.numberOfPoints=60,t.radius=1e3,t.radiusUnit="meters",t}e._inherits(s,r);var o=s.prototype;return o.normalizeCtorArgs=function(r,t){let o;if(r&&r.center)o=r;else{if(r&&r.rings)return e._get(e._getPrototypeOf(s.prototype),"normalizeCtorArgs",this).call(this,r,t);o={center:r}}return{...e._get(e._getPrototypeOf(s.prototype),"normalizeCtorArgs",this).call(this),...o,...t}},o.initialize=function(){const e=this.center,r=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,0!==this.rings.length||!e)return;const s=t.convertUnit(this.radius,this.radiusUnit,"meters"),o=e.spatialReference;let i,c="geographic";if(o.isWebMercator?c="webMercator":(null!=(o.wkid&&h[o.wkid])||o.wkt&&0===o.wkt.indexOf("PROJCS"))&&(c="projected"),this.geodesic){let t;switch(c){case"webMercator":t=d.webMercatorToGeographic(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":t=e}i=this._createGeodesicCircle(t,s,r),"webMercator"===c&&(i=d.geographicToWebMercator(i))}else{let o;"webMercator"===c||"projected"===c?o=s/this._convert2Meters(1,e.spatialReference):"geographic"===c&&(o=t.lengthToDegrees(s,"meters",a.getReferenceEllipsoid(e.spatialReference).radius)),i=this._createPlanarCircle(e,o,r)}this.spatialReference=i.spatialReference,this.addRing(i.rings[0])},o.clone=function(){const{center:e,numberOfPoints:r,radius:t,radiusUnit:s,geodesic:o}=this;return new g({center:e?.clone(),numberOfPoints:r,radius:t,radiusUnit:s,geodesic:o})},o._createGeodesicCircle=function(e,r,t){let s=0;const o=[];for(;s<360;){const i=[0,0],c=[e.x,e.y];u.directGeodeticSolver(i,c,s,r),this.hasZ&&i.push(e.z),o.push(i),s+=360/t}return o.push(o[0]),new l(o)},o._createPlanarCircle=function(e,r,t){const s=[],o=2*Math.PI/t;for(let i=0;i<t;++i){const t=o*i,c=[e.x+Math.cos(-t)*r,e.y+Math.sin(-t)*r];this.hasZ&&c.push(e.z),s.push(c)}return s.push(s[0]),new l({spatialReference:e.spatialReference,rings:[s]})},o._convert2Meters=function(e,r){let t;if(r.wkid&&null!=h[r.wkid])t=h.values[h[r.wkid]];else{const e=r.wkt,s=e.lastIndexOf(",")+1,o=e.lastIndexOf("]]");t=parseFloat(e.substring(s,o))}return e*t},e._createClass(s)}(l);r.__decorate([s.property({type:p})],f.prototype,"center",void 0),r.__decorate([s.property()],f.prototype,"geodesic",void 0),r.__decorate([s.property()],f.prototype,"numberOfPoints",void 0),r.__decorate([s.property()],f.prototype,"radius",void 0),r.__decorate([s.property()],f.prototype,"radiusUnit",void 0),f=g=r.__decorate([n.subclass("esri.geometry.Circle")],f);return f}));
