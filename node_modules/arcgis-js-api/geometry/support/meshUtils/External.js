/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../request","../../../core/arrayUtils","../../../core/promiseUtils","../../../layers/support/infoFor3D"],(function(t,e,r,s,n,a){"use strict";let i=function(){function t(t,e,r){this.assetName=t,this.assetMimeType=e,this.parts=r}var r=t.prototype;return r.equals=function(t){return this===t||this.assetName===t.assetName&&this.assetMimeType===t.assetMimeType&&s.equals(this.parts,t.parts,((t,e)=>t.equals(e)))},r.isOnService=function(t){return this.parts.every((e=>e.isOnService(t)))},r.makeHash=function(){let t="";for(const e of this.parts)t+=e.partHash;return t},r.toBlob=async function(t){const{parts:e}=this;if(1===e.length)return e[0].toBlob(t);const r=await Promise.all(e.map((e=>e.toBlob(t))));return n.throwIfAborted(t),new Blob(r)},e._createClass(t)}(),o=function(){function t(t,e){this.partUrl=t,this.partHash=e}var s=t.prototype;return s.equals=function(t){return this===t||this.partUrl===t.partUrl&&this.partHash===t.partHash},s.isOnService=function(t){return this.partUrl.startsWith(`${t.path}/assets/`)},s.toBlob=async function(t){const{data:e}=await r(this.partUrl,{responseType:"blob"});return n.throwIfAborted(t),e},e._createClass(t)}();function u(t){return p(t?.source)}function c(t){if(!Array.isArray(t))return!1;return t.every((t=>t instanceof i))}const l=/^(model\/gltf\+json)|(model\/gltf-binary)$/,f=/\.(gltf|glb)/i;function p(t){if(!t)return!1;if(Array.isArray(t)){return t.some(m)}return m(t)}function m(t){if(t instanceof File){const{type:e,name:r}=t;return l.test(e)||f.test(r)}return l.test(t.assetMimeType)||f.test(t.assetName)}function y(t,e){if(!t)return!1;const{source:r}=t;return g(r,e)}function h(t,e){if(t===e)return!0;const{source:r}=t,{source:s}=e;if(r===s)return!0;if(c(r)&&c(s)){if(r.length!==s.length)return!1;const t=(t,e)=>t.assetName<e.assetName?-1:t.assetName>e.assetName?1:0,e=[...r].sort(t),n=[...s].sort(t);for(let r=0;r<e.length;++r)if(!e[r].equals(n[r]))return!1;return!0}return!1}function g(t,e){if(Array.isArray(t)){return t.every((t=>v(t,e)))}return v(t,e)}function v(t,e){return t instanceof i&&t.isOnService(e)}function b(t,e){return t instanceof File?a.getFilenameFormatId(t.name,e)??a.getMimeTypeFormatId(t.type,e):a.getMimeTypeFormatId(t.assetMimeType,e)??a.getFilenameFormatId(t.assetName,e)}function A(t){return Array.isArray(t)?t:[t]}function S(t){return!!t.original}t.ServiceAsset=i,t.ServiceAssetPart=o,t.assetFormatId=b,t.assetIsOnService=v,t.externalIsOnService=y,t.externalSourceToMultiPart=A,t.externalSourcesAreEqual=h,t.isDisplayAsset=m,t.isDisplayExternal=u,t.isDisplaySource=p,t.isOriginalExternal=S,t.sourceIsOnService=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
