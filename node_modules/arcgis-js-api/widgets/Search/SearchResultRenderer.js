/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../Widget","./searchResultRendererCSS","./SearchViewModel","../support/decorators/accessibleHandler","../support/decorators/messageBundle","../support/jsxFactory","../support/widgetUtils"],(function(e,s,r,t,o,l,n,u,i,c,a,d,h,p){"use strict";let _=function(s){function r(e,r){var t;return(t=s.call(this,e,r)||this).messages=null,t.showMoreResultsOpen=!1,t.viewModel=null,t}e._inherits(r,s);var t=r.prototype;return t.destroy=function(){this.viewModel=null},t.render=function(){const e={[i.CSS.showMoreResults]:this.showMoreResultsOpen};return h.tsx("div",{class:i.CSS.base},h.tsx("div",{key:"esri-search-renderer__container",class:this.classes(i.CSS.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))},t.renderMoreResults=function(){return h.tsx("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())},t.renderSearchResultName=function(){const e=this.viewModel?.selectedResult,s=e&&e.name||"";return h.tsx("div",{key:"esri-search-renderer__result-name",class:i.CSS.moreResultsItem},s)},t.renderMoreResultsLists=function(){const{viewModel:e}=this;if(!e)return[];const s=e.results;if((e.resultCount??0)<2)return null;const r=s?.map((e=>this.renderMoreResultsList(e)));return h.tsx("div",{key:"esri-search-renderer__more-results-container",class:i.CSS.moreResultsList},r)},t.renderMoreResultsButton=function(){const{messages:e,viewModel:s}=this;if(!s)return null;return(s.resultCount??0)<2?null:h.tsx("div",{key:"esri-search-renderer__more-results-button",class:i.CSS.moreResultsItem},h.tsx("a",{class:i.CSS.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))},t.renderMoreResultsHeader=function(e,s){return h.tsx("div",{key:`esri-search-result-renderer__header-${s}`,class:i.CSS.moreResultsListHeader},e)},t.renderMoreResultsList=function(e){const{results:s}=e,r=s?.length??0,t=r>0,o=this.viewModel?.selectedResult,l=1===r&&s[0]===o,n=this._getSourceName(e.source,e.sourceIndex),u=(this.viewModel?.results?.length??0)>1&&!l?this.renderMoreResultsHeader(n,e.sourceIndex):null,i=t&&s.map(((e,s)=>this.renderMoreResultsListItem(e,s))),c=t&&!l?h.tsx("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},i):null;return t?h.tsx("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},u,c):null},t.renderMoreResultsListItem=function(e,s){return e!==this.get("viewModel.selectedResult")?h.tsx("li",{key:`esri-search-result-renderer__list-item-${s}`},h.tsx("a",{class:i.CSS.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null},t._showMoreResultsClick=function(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const s=this.get("viewModel.view.popup");s&&s.reposition()},t._selectResultClick=function(e){e.preventDefault();const s=e.currentTarget["data-result"];this.viewModel?.select(s)},t._getSourceName=function(e,s){return s===c.ALL_INDEX?this.messages.all:e.name},e._createClass(r)}(u);s.__decorate([r.property(),d.messageBundle("esri/widgets/Search/t9n/Search")],_.prototype,"messages",void 0),s.__decorate([r.property()],_.prototype,"showMoreResultsOpen",void 0),s.__decorate([r.property()],_.prototype,"viewModel",void 0),s.__decorate([a.accessibleHandler()],_.prototype,"_showMoreResultsClick",null),s.__decorate([a.accessibleHandler()],_.prototype,"_selectResultClick",null),_=s.__decorate([n.subclass("esri.widgets.Search.SearchResultRenderer")],_);return _}));
