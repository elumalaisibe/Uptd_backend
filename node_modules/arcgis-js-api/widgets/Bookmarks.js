/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/arrayUtils","../core/events","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/has","../core/accessorSupport/decorators/subclass","../intl/date","../webdoc/support/SlideThumbnail","./Widget","./Bookmarks/BookmarksUserState","./Bookmarks/BookmarksViewModel","./Bookmarks/css","./FeatureTable/Grid/support/ButtonMenu","./FeatureTable/Grid/support/ButtonMenuItem","./support/componentsUtils","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","../chunks/sortable.esm"],(function(t,e,o,i,s,n,r,a,d,l,u,c,k,m,h,p,b,S,_,f,g,B,v,C,y){"use strict";function x(t,e,o){t.splice(o,0,t.splice(e,1)[0])}const E="bookmarks",I="data-bookmark-uid",w={addBookmark:!0,thumbnail:!0,time:!0},T=/^https:\/\/.*/i,A="esri.widgets.Bookmarks";let U=function(o){function r(t,e){var i;return(i=o.call(this,t,e)||this)._tooltipReferenceMap=new Map,i._addInputNode=null,i._editInputNode=null,i._urlEditInputNode=null,i._addBookmarkButtonNode=null,i._focusAddBookmarkButton=!1,i._focusEditInputBox=!1,i._focusAddInputBox=!1,i._focusUrlEditInputBox=!1,i._sortable=null,i._sortableNode=null,i._focusSortUid=null,i._selectedSortUid=null,i._sortableSavedItems=[],i._editIncludeTimeExtent=void 0,i._userState=null,i.disabled=!1,i.editingEnabled=!1,i.headingLevel=2,i.iconClass=p.CSS.widgetIcon,i.icon=null,i.messages=null,i.messagesCommon=null,i.messagesUnits=null,i.viewModel=new h,i.visibleElements={...w},i}e._inherits(r,o);var a=r.prototype;return a.initialize=function(){this.addHandles([n.watch((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),n.initial),n.watch((()=>this.editingEnabled),(()=>this._toggleSorting()),n.initial)])},a.destroy=function(){this.removeAllHandles(),this._destroySortable(),this._editMenu.destroy(),this._tooltipReferenceMap.clear()},a.loadDependencies=function(){return _.loadCalciteComponents({label:()=>new Promise(((e,o)=>t(["../chunks/calcite-label"],e,o))),switch:()=>new Promise(((e,o)=>t(["../chunks/calcite-switch"],e,o))),tooltip:()=>new Promise(((e,o)=>t(["../chunks/calcite-tooltip"],e,o)))})},a.castVisibleElements=function(t){return{...w,...t}},a.endAddBookmark=function(){this._userState=null},a.goTo=function(t){return this.viewModel.goTo(t)},a.render=function(){const{state:t}=this.viewModel,e="loading"===t?this.renderLoading():this.renderBookmarks();return C.tsx("div",{class:this.classes(p.CSS.base,p.CSS.esriWidget,{[p.CSS.esriWidgetDisabled]:this.disabled})},e)},a.startAddBookmark=function(){this._userState=new m({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()},a.renderBookmarkTooltips=function(t){return t.toArray().map((t=>this.renderBookmarkTooltip(t)))??[]},a.renderBookmarkTooltip=function(t){const{_tooltipReferenceMap:e,messagesCommon:o}=this,i=this._getBookmarkTitle(t),s=`${o?.dragHandleTitle} ${i}`;return t?C.tsx("calcite-tooltip",{key:`tooltip-${t.uid}`,label:s,referenceElement:e.get(t.uid)},s):null},a.renderLoading=function(){return C.tsx("div",{class:p.CSS.loaderContainer,key:"loader",tabIndex:this.disabled?-1:void 0},C.tsx("div",{class:p.CSS.loader}))},a.renderNoBookmarksContainer=function(){const{messages:t,disabled:e}=this;return C.tsx("div",{class:p.CSS.noBookmarksContainer,key:"no-bookmarks",tabIndex:e?-1:void 0},C.tsx("span",{"aria-hidden":"true",class:this.classes(p.CSS.noBookmarksIcon,p.CSS.widgetIcon)}),C.tsx(f.Heading,{level:this.headingLevel,class:this.classes(p.CSS.header,p.CSS.noBookmarksHeader)},t?.noBookmarksHeading),C.tsx("p",{class:p.CSS.noBookmarksDescription},t?.noBookmarksDescription))},a.renderAddBookmarkLoading=function(){return C.tsx("div",{key:"adding-bookmark",class:p.CSS.addingBookmark},C.tsx("span",{"aria-hidden":"true",class:this.classes(p.CSS.loading,p.CSS.rotating)}),this.messages?.addingBookmark)},a.renderBookmarkItems=function(t){if(!t)return[];const{_userState:e,editingEnabled:o}=this;return t.map((t=>o&&t&&e&&("edit"===e.state||"edit-thumbnail"===e.state)&&e.bookmark===t?"edit-thumbnail"===e.state?this.renderEditingBookmarkUrl(e.editedBookmark):this.renderEditingBookmark(e.editedBookmark):this.renderBookmark(t))).toArray()},a.renderBookmarksContainer=function(t){const{_userState:e,editingEnabled:o,disabled:i}=this,s="add"===e?.state,n=o&&!s?this.renderAddBookmarkButton():null,r=o?s&&e.loading?this.renderAddBookmarkLoading():"add"===e?.state?this.renderAddingBookmark():null:null;return[C.tsx("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(p.CSS.bookmarkList,{[p.CSS.bookmarkListSortable]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:i?-1:void 0},this.renderBookmarkItems(t)),n,r]},a.renderAddBookmarkButton=function(){return this.visibleElements.addBookmark?C.tsx("div",{key:"add-bookmark-item",class:p.CSS.addBookmark},C.tsx("button",{class:this.classes(p.CSS.esriButton,p.CSS.esriButtonTertiary,p.CSS.addBookmarkButton),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},C.tsx("span",{"aria-hidden":"true",class:this.classes(p.CSS.addBookmarkIcon,p.CSS.iconPlus)}),this.messages?.addBookmark)):null},a.renderBookmarks=function(){const{bookmarks:t}=this.viewModel,e=t&&t.filter(Boolean),o=e&&e.length,i=o||this.editingEnabled?this.renderBookmarksContainer(e):null;return[o?null:this.renderNoBookmarksContainer(),i,this.renderBookmarkTooltips(t)]},a.renderEditContainer=function(t){const{messagesCommon:e,disabled:o}=this,i=this._getBookmarkTitle(t);return C.tsx("div",{class:p.CSS.bookmarkEditButtonContainer,key:"edit-container"},C.tsx("button",{disabled:o,title:`${e?.edit} ${i}`,"aria-label":`${e?.edit} ${i}`,"data-bookmark":t,onclick:this._showEditBookmarkForm,bind:this,class:p.CSS.bookmarkEditButton,type:"button"},C.tsx("span",{"aria-hidden":"true",class:p.CSS.iconEdit})))},a.renderDragHandle=function(t){const{messagesCommon:e,disabled:o}=this,i=this._getBookmarkTitle(t),s={[I]:t.uid};return C.tsx("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:p.CSS.bookmarkDragHandle,onkeydown:this._dragHandleKeydown,"data-bookmark":t,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===t.uid?"true":"false","aria-label":`${e?.dragHandleTitle} ${i}`,...s},C.tsx("span",{"aria-hidden":"true",class:this.classes(p.CSS.bookmarkDragHandleIcon,p.CSS.iconHandle)}))},a.renderBookmarkImageIcon=function(){return C.tsx("span",{"aria-hidden":"true",class:this.classes(p.CSS.bookmarkIcon,p.CSS.widgetIcon)})},a.renderBookmarkImage=function(t){const{visibleElements:e}=this,{thumbnail:o}=t,i=o&&o.url||"";return e.thumbnail&&i?C.tsx("img",{src:i,alt:"",class:p.CSS.bookmarkImage}):null},a.renderBookmarkTimeSwitch=function(t){const{messages:e,disabled:o}=this,{timeExtent:i}=t,{view:s}=this.viewModel;return s?.timeExtent??i?C.tsx("calcite-label",{layout:"inline-space-between"},e?.includeTimeExtent,C.tsx("calcite-switch",{scale:"s",disabled:o,checked:!!i,onCalciteSwitchChange:t=>{const e=t.currentTarget;this._editIncludeTimeExtent=!!e.checked}})):null},a.renderBookmarkTimeExtent=function(t){const{visibleElements:e}=this,{timeExtent:o}=t;return o?C.tsx("span",{class:p.CSS.timeExtent},[null!=o.start&&C.tsx("span",{key:"start-date-group",class:p.CSS.timeExtentGroup},C.tsx("span",{key:"start-date",class:p.CSS.timeExtentDate},this._formatDate(o.start)),e.time&&C.tsx("span",{key:"start-time",class:p.CSS.timeExtentTime},this._formatTime(o.start))),null!=o.end&&(null==o.start||o.start.getTime()!==o.end.getTime())&&C.tsx("span",{key:"end-date-group",class:p.CSS.timeExtentGroup},C.tsx("span",{key:"end-date",class:p.CSS.timeExtentDate},this._formatDate(o.end)),e.time&&C.tsx("span",{key:"end-time",class:p.CSS.timeExtentTime},this._formatTime(o.end)))]):null},a.renderBookmarkButton=function(t){const{disabled:e}=this,{timeExtent:o}=t,{capabilities:i}=this.viewModel,s=this._getBookmarkTitle(t),{thumbnail:n}=t,r=C.tsx("div",{class:this.classes(p.CSS.bookmarkImageContainer,n&&n.url?p.CSS.bookmarkImageContainerHasImage:null)},this.renderBookmarkImage(t)||this.renderBookmarkImageIcon()),a=i.time&&o?C.tsx("span",{key:"time-extent",class:p.CSS.bookmarkTimeExtent},this.renderBookmarkTimeExtent(t)):null;return C.tsx("button",{disabled:e,key:"bookmark-button",class:p.CSS.bookmarkButton,bind:this,"data-bookmark":t,onclick:this._goToBookmark,type:"button"},r,C.tsx("div",{class:p.CSS.bookmarkLabel},C.tsx("span",{key:"bookmark-title",class:p.CSS.bookmarkName},s),a))},a.renderBookmark=function(t){const{activeBookmark:e}=this.viewModel,o={[p.CSS.bookmarkActive]:e===t},i=this.editingEnabled?this.renderEditContainer(t):null,s={[I]:t.uid},n=this.editingEnabled?this.renderDragHandle(t):null;return C.tsx("li",{key:t,class:this.classes(p.CSS.bookmark,o),...s},n,this.renderBookmarkButton(t),i)},a.renderEditingBookmarkName=function(t){const{messages:e,_userState:o,disabled:i}=this,s="name-required"===o?.validationState;return C.tsx("label",{class:this.classes({[p.CSS.authoringLabel]:!0,[p.CSS.authoringLabelStartPadding]:!!this.visibleElements?.thumbnail})},e?.title,s?C.tsx("strong",null,e?.invalidTitle):null,C.tsx("input",{required:!0,disabled:i,bind:this,class:this.classes(p.CSS.esriInput,s?p.CSS.authoringInputInvalid:null),type:"text",value:t.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":t,"data-node-ref":"_editInputNode",placeholder:e?.titlePlaceholder}))},a.renderEditingBookmarkUrlActions=function(){const{messagesCommon:t,disabled:e}=this;return C.tsx("div",{class:p.CSS.authoringActions},C.tsx("input",{type:"button",disabled:e,value:t?.back,class:this.classes(p.CSS.esriButton,p.CSS.esriButtonTertiary),onclick:this._closeUrlEditBookmarkForm,bind:this}),C.tsx("input",{class:p.CSS.esriButton,disabled:e,type:"submit",value:t?.add}))},a.renderEditingBookmarkActions=function(){const{messagesCommon:t,disabled:e}=this,o=this._userState?.bookmark;return C.tsx("div",{class:p.CSS.authoringActions},C.tsx("input",{type:"button",disabled:e,value:t?.delete,class:this.classes(p.CSS.esriButton,p.CSS.esriButtonTertiary,p.CSS.authoringDeleteButton),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),C.tsx("input",{disabled:e,type:"button",value:t?.cancel,class:this.classes(p.CSS.esriButton,p.CSS.esriButtonTertiary),onclick:this._closeEditBookmarkForm,bind:this}),C.tsx("input",{class:p.CSS.esriButton,disabled:e,type:"submit",value:t?.save}))},a.renderEditingBookmarkUrlInput=function(t){const{messages:e,_userState:o,disabled:i}=this,s=t.thumbnail?.url,n=s&&T.test(s)?s:void 0,r="absolute-url-required"===o?.validationState;return C.tsx("label",{class:this.classes({[p.CSS.authoringLabel]:!0,[p.CSS.authoringLabelStartPadding]:!!this.visibleElements?.thumbnail})},r?C.tsx("strong",null,e?.invalidImageUrl):null,C.tsx("input",{required:!0,disabled:i,bind:this,class:this.classes(p.CSS.esriInput,r?p.CSS.authoringInputInvalid:null),type:"text",value:n,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":t,"data-node-ref":"_urlEditInputNode",title:e?.imageUrlTooltip,placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0}))},a.renderEditingBookmarkUrl=function(t){if(!t)return null;const e={[I]:t.uid};return C.tsx("li",{key:"edit-bookmark-url-form",class:p.CSS.authoringCard,...e},C.tsx("form",{class:p.CSS.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(t),this.renderEditingBookmarkUrlActions()))},a.renderEditingBookmark=function(t){if(!t)return null;const e={[I]:t.uid},{capabilities:o}=this.viewModel,i=o.time?C.tsx("div",{key:"edit-bookmark-time-container",class:p.CSS.timeExtentContainer},this.renderBookmarkTimeSwitch(t),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(t)):null;return C.tsx("li",{key:"edit-bookmark-form",class:p.CSS.authoringCard,...e},C.tsx("form",{class:p.CSS.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},C.tsx("div",{class:p.CSS.authoringContainer},this.visibleElements.thumbnail?C.tsx("div",{class:p.CSS.bookmarkImageContainer},this.renderBookmarkImage(t),this._editMenu.render()):null,this.renderEditingBookmarkName(t)),i,this.renderEditingBookmarkActions()))},a.renderAddingBookmarkName=function(){const{_userState:t,messages:e,disabled:o}=this,i="name-required"===t?.validationState;return C.tsx("label",{class:p.CSS.authoringLabel},e?.title,i?C.tsx("strong",null,e?.invalidTitle):null,C.tsx("input",{required:!0,disabled:o,bind:this,class:this.classes(p.CSS.esriInput,i?p.CSS.authoringInputInvalid:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:e?.titlePlaceholder}))},a.renderAddingBookmarkActions=function(){const{messagesCommon:t,disabled:e}=this;return C.tsx("div",{class:this.classes(p.CSS.authoringActions)},C.tsx("input",{type:"button",disabled:e,value:t?.cancel,class:this.classes(p.CSS.esriButton,p.CSS.esriButtonTertiary,p.CSS.authoringCancelButton),onclick:this._endAddBookmark.bind(this),bind:this}),C.tsx("input",{class:p.CSS.esriButton,disabled:e,type:"submit",value:t?.add}))},a.renderAddingBookmark=function(){return C.tsx("div",{key:"add-bookmark-form",class:p.CSS.authoringCard},C.tsx("form",{class:this.classes(p.CSS.authoringForm,p.CSS.authoringFormAdding),onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))},a._setTooltipReference=function(t,e){this._tooltipReferenceMap.set(e.uid,t),this.scheduleRender()},a._getBookmarkTitle=function(t){return(t?.name||this.messagesCommon?.untitled)??""},a._formatDate=function(t){return t?u.formatDate(t,u.convertDateFormatToIntlOptions("short-date")):""},a._formatTime=function(t){return t?u.formatDate(t,u.convertDateFormatToIntlOptions("long-time")):""},a._dragHandleBlur=function(){this._selectedSortUid=null,this.scheduleRender()},a._dragHandleKeydown=function(t){const{_sortableSavedItems:e}=this,o=["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"],i=s.eventKey(t);if(!o.includes(i))return;const{_sortable:n,_selectedSortUid:r}=this;if(!n)return;const a=n.toArray(),d=t.target.getAttribute(I),l=a.indexOf(d);if(g.isActivationKey(i)){const t=r&&r===d;return this._selectedSortUid=t?null:d,this._sortableSavedItems=t?[]:n.toArray(),void this.scheduleRender()}if("Tab"===i)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===i&&0!==e.length)return t.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(e,n,d),void this.scheduleRender();if(-1===l||!r)return;const u="ArrowUp"===i?l-1:l+1;u>=a.length||u<=-1||(x(a,l,u),this._updateSortItems(a,n,d))},a._updateSortItems=function(t,e,o){e.sort(t),this._sortBookmarks(e),this._focusSortUid=o,this._selectedSortUid=o},a._focusDragHandle=function(t){const e=M(t);if(!e)return;this._setTooltipReference(t,e);const{_focusSortUid:o}=this;if(!t||!o)return;t.getAttribute(I)===o&&(t.focus(),this._focusSortUid=null)},a._toggleSorting=function(){const{_sortable:t,_sortableNode:e,editingEnabled:o,disabled:i}=this;if(e)if(t)t.option("disabled",i||!o);else{const t=y.Sortable.create(e,{dataIdAttr:I,handle:`.${p.CSS.bookmarkDragHandle}`,group:E,disabled:i||!o,onSort:()=>this._sortBookmarks(t)});this._sortable=t}},a._sortNodeCreated=function(t){this._sortableNode=t,this._toggleSorting()},a._sortBookmarks=function(t){const{bookmarks:e}=this.viewModel;if(!e)return;const o=t.toArray();e.sort(((t,e)=>{const i=o.indexOf(t.uid),s=o.indexOf(e.uid);return i>s?1:i<s?-1:0}))},a._destroySortable=function(){const{_sortable:t}=this;t&&t.destroy(),this._sortable=null},a._endAddBookmark=function(){this._focusAddBookmarkButton=!0,this.endAddBookmark()},a._bookmarksInitialized=function(){const t="bookmarks-init";this.removeHandles(t),this.addHandles(n.on((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),t)},a._bookmarksChanged=function(){const t="bookmarks-change",{bookmarks:e}=this.viewModel;this.removeHandles(t);const o=e.map((t=>n.watch((()=>[t?.name,t?.thumbnail?.url]),(()=>this.scheduleRender()))));this.addHandles(o.toArray(),t),this.scheduleRender()},a._showEditBookmarkForm=function(t){const e=M(t.currentTarget);e&&(this._editIncludeTimeExtent=!!e.timeExtent,this._focusEditInputBox=!0,this._userState=new m({bookmark:e,state:"edit"}),this.viewModel.goTo(e),this.scheduleRender())},a._closeUrlEditBookmarkForm=function(){this._focusEditInputBox=!0,this._userState&&(this._userState.state="edit")},a._closeEditBookmarkForm=function(){this._userState=null},a._addBookmarkSubmit=function(t){t.preventDefault();const{_addInputNode:e,_userState:o}=this;if(!o)return;const i=e?e.value.trim():null;i?(o.loading=!0,this.viewModel.createBookmark().then((t=>{t.name=i,this.viewModel.bookmarks.add(t),this._endAddBookmark()}))):o.validationState="name-required"},a._editBookmarkAndClose=async function(t,e){const{viewModel:o}=this;await o.editBookmark(t,{...o.defaultEditOptions,...e}),this._closeEditBookmarkForm()},a._editBookmarkSubmit=function(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i}=this;if(!o?.bookmark||!o.editedBookmark)return;const s=e&&e.value.trim();s?(o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})):o.validationState="name-required"},a._storeAddBookmarkButton=function(t){this._addBookmarkButtonNode=t,this._focusAddBookmark()},a._storeEditInput=function(t){this._editInputNode=t,this._focusEditInput()},a._storeAddInput=function(t){this._addInputNode=t,this._focusAddInput()},a._storeUrlEditInput=function(t){this._urlEditInputNode=t,this._focusUrlEditInput()},a._focusUrlEditInput=function(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())},a._focusAddInput=function(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())},a._focusAddBookmark=function(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())},a._focusEditInput=function(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())},a._deleteBookmark=function(t){const e=M(t.currentTarget);e&&this.viewModel.bookmarks.remove(e)},a._goToBookmark=function(t){const e=M(t.currentTarget);e&&(this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(e))},a._refreshThumbnail=async function(){const{_userState:t,_editMenu:e,viewModel:o}=this;t&&(t.validationState=void 0,await o.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),e.open=!1,this._focusEditInputBox=!0,this.scheduleRender())},a._removeThumbnail=function(){const{_userState:t,_editMenu:e}=this;t?.editedBookmark&&(t.editedBookmark.thumbnail=null,t.validationState=void 0,e.open=!1,this._focusEditInputBox=!0,this.scheduleRender())},a._startUseImageUrl=function(){this._userState&&(this._userState.state="edit-thumbnail"),this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()},a._editBookmarkUrlSubmit=function(t){t.preventDefault();const{_urlEditInputNode:e,_userState:o}=this;if(!e||!o)return;const i=e.value;T.test(i)?(i&&o.editedBookmark&&(o.editedBookmark.thumbnail=new c.SlideThumbnail({url:i})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"},e._createClass(r,[{key:"_editMenuItems",get:function(){const{messages:t,_userState:e}=this,o=e?.editedBookmark?.thumbnail?.url;return[new S({label:t?.menu.refreshThumbnail,iconClass:p.CSS.iconRefresh,clickFunction:()=>this._refreshThumbnail()}),new S({label:o&&T.test(o)?t?.menu.editImageUrl:t?.menu.useImageUrl,iconClass:p.CSS.iconLink,clickFunction:()=>this._startUseImageUrl()}),o?new S({label:t?.menu.removeThumbnail,iconClass:p.CSS.iconRemove,clickFunction:()=>this._removeThumbnail()}):null].filter(i.isSome)}},{key:"_editMenu",get:function(){const{_editMenuItems:t,messages:e,disabled:o}=this,i=this._get("_editMenu");i&&i.destroy();const s=new b({disabled:o,iconClass:p.CSS.iconHandleHorizontal,label:e?.menu.label});return s.items=t,s}},{key:"defaultCreateOptions",get:function(){return this.viewModel.defaultCreateOptions},set:function(t){this.viewModel.defaultCreateOptions=t}},{key:"defaultEditOptions",get:function(){return this.viewModel.defaultEditOptions},set:function(t){this.viewModel.defaultEditOptions=t}},{key:"bookmarks",get:function(){return this.viewModel.bookmarks},set:function(t){this.viewModel.bookmarks=t}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(t){this.viewModel.goToOverride=t}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(t){this._overrideIfSome("label",t)}},{key:"view",get:function(){return this.viewModel.view},set:function(t){this.viewModel.view=t}}]),r}(k);function M(t){return t["data-bookmark"]}o.__decorate([r.property()],U.prototype,"_editIncludeTimeExtent",void 0),o.__decorate([r.property({type:m})],U.prototype,"_userState",void 0),o.__decorate([r.property({readOnly:!0})],U.prototype,"_editMenuItems",null),o.__decorate([r.property({readOnly:!0})],U.prototype,"_editMenu",null),o.__decorate([r.property()],U.prototype,"defaultCreateOptions",null),o.__decorate([r.property()],U.prototype,"defaultEditOptions",null),o.__decorate([r.property()],U.prototype,"bookmarks",null),o.__decorate([r.property()],U.prototype,"disabled",void 0),o.__decorate([r.property()],U.prototype,"editingEnabled",void 0),o.__decorate([r.property()],U.prototype,"headingLevel",void 0),o.__decorate([r.property()],U.prototype,"goToOverride",null),o.__decorate([r.property()],U.prototype,"iconClass",void 0),o.__decorate([r.property()],U.prototype,"icon",void 0),o.__decorate([r.property()],U.prototype,"label",null),o.__decorate([r.property(),B.messageBundle("esri/widgets/Bookmarks/t9n/Bookmarks")],U.prototype,"messages",void 0),o.__decorate([r.property(),B.messageBundle("esri/t9n/common")],U.prototype,"messagesCommon",void 0),o.__decorate([r.property(),B.messageBundle("esri/core/t9n/Units")],U.prototype,"messagesUnits",void 0),o.__decorate([r.property()],U.prototype,"uiStrings",void 0),o.__decorate([r.property()],U.prototype,"view",null),o.__decorate([r.property({type:h}),v.vmEvent(["select-bookmark","bookmark-edit","bookmark-select"])],U.prototype,"viewModel",void 0),o.__decorate([r.property()],U.prototype,"visibleElements",void 0),o.__decorate([a.cast("visibleElements")],U.prototype,"castVisibleElements",null),o.__decorate([r.property()],U.prototype,"endAddBookmark",null),o.__decorate([r.property()],U.prototype,"startAddBookmark",null),U=o.__decorate([l.subclass(A)],U);return U}));
