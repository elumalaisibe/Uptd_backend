/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./support/componentsUtils","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./UtilityNetworkValidateTopology/UtilityNetworkValidateTopologyViewModel"],(function(t,e,o,s,i,n,a,c,r,l,u,d,p,x){"use strict";const g={container:"esri-un-validate-topology__container",content:"esri-un-validate-topology__content",controlsContainer:"esri-un-validate-topology__controls-container",statusIconError:"esri-un-validate-topology__status-icon-error",statusIconSuccess:"esri-un-validate-topology__status-icon-success",statusIconContainer:"esri-un-validate-topology__status-icon-container"};let v=function(o){function s(t,e){var s;return(s=o.call(this,t,e)||this).messages=null,s.viewModel=new x,s}e._inherits(s,o);var i=s.prototype;return i.loadDependencies=function(){return l.loadCalciteComponents({action:()=>new Promise(((e,o)=>t(["../chunks/calcite-action"],e,o))),block:()=>new Promise(((e,o)=>t(["../chunks/calcite-block"],e,o))),icon:()=>new Promise(((e,o)=>t(["../chunks/calcite-icon"],e,o))),notice:()=>new Promise(((e,o)=>t(["../chunks/calcite-notice"],e,o))),option:()=>new Promise(((e,o)=>t(["../chunks/calcite-option"],e,o))),select:()=>new Promise(((e,o)=>t(["../chunks/calcite-select"],e,o))),tooltip:()=>new Promise(((e,o)=>t(["../chunks/calcite-tooltip"],e,o)))})},i.render=function(){const{viewModel:t}=this;return"disabled"===t.state?p.tsx("div",{class:g.container},p.tsx("calcite-block",{heading:this.label,class:g.content,collapsible:!1,open:!0},this._renderLoadErrorStatusIcon(),this._renderLoadErrorsNotices())):p.tsx("div",{class:g.container},p.tsx("calcite-block",{heading:this.label,class:g.content,collapsible:!0,open:!1},this._renderStatusIcon(),this._renderValidateTopologyAction(),this._renderControls()))},i._extentOptionSelectChange=function(t){this.extentToValidate=t.target.value},i._getLoadErrorMessagesAsNotices=function(t,e){return p.tsx("calcite-notice",{key:"error-notice-"+e,open:!0,closable:!1,kind:"warning",scale:"s"},p.tsx("div",{slot:"message"},t))},i._handleValidateTopologyAction=function(){this.viewModel.validateTopology().catch((()=>{}))},i._renderControls=function(){const{viewModel:t}=this;return"failed"===t.state?p.tsx("div",{class:g.controlsContainer},this._renderExtentOptionSelect(),this._renderStatusNotice()):this._renderExtentOptionSelect()},i._renderExtentOptionSelect=function(){const{messages:t,viewModel:e}=this;return p.tsx("div",{key:"selectExtentDiv"},p.tsx("calcite-select",{bind:this,label:t.input.extentToValidate,disabled:"loading"===e.state||"executing"===e.state,onCalciteSelectChange:this._extentOptionSelectChange},p.tsx("calcite-option",{value:"current"},t.input.currentExtent),p.tsx("calcite-option",{value:"entire"},t.input.entireExtent)))},i._renderLoadErrorsNotices=function(){const{viewModel:t}=this;return p.tsx("div",{key:"loadErrorsDiv",class:g.controlsContainer},t.loadErrors.items.map(this._getLoadErrorMessagesAsNotices))},i._renderLoadErrorStatusIcon=function(){return p.tsx("div",{key:"statusDiv",slot:"control",class:g.statusIconContainer},p.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s",class:g.statusIconError}))},i._renderStatusIcon=function(){const{messages:t,viewModel:e}=this,o=`${this.id}-validation-status-action`,s=`${this.id}-error-status-icon`,i=`${this.id}-success-status-icon`,n=t=>{setTimeout((()=>{t.innerHTML=""}),3500)};return"executing"===e.state?p.tsx("div",{key:"statusDivExecuting",slot:"control"},p.tsx("calcite-action",{id:o,text:t.status.executing,textEnabled:!1,loading:!0}),p.tsx("calcite-tooltip",{referenceElement:o,label:t.status.executing},p.tsx("span",null,t.status.executing))):"success"===e.state?p.tsx("div",{key:"statusDivSuccess",slot:"control",class:g.statusIconContainer,afterCreate:n},p.tsx("calcite-icon",{id:i,icon:"check-circle",scale:"s",class:g.statusIconSuccess}),p.tsx("calcite-tooltip",{referenceElement:i,label:t.status.success},p.tsx("span",null,t.status.success))):"failed"===e.state?p.tsx("div",{key:"statusDivFailed",slot:"control",class:g.statusIconContainer},p.tsx("calcite-icon",{id:s,icon:"exclamation-mark-triangle",scale:"s",class:g.statusIconError}),p.tsx("calcite-tooltip",{referenceElement:s,label:e.executionError},p.tsx("span",null,e.executionError))):p.tsx("div",{key:"statusDiv",slot:"control",class:g.statusIconContainer})},i._renderStatusNotice=function(){const{viewModel:t}=this;return p.tsx("div",{key:"executionErrorDiv"},p.tsx("calcite-notice",{open:!0,closable:!0,kind:"warning",scale:"s"},p.tsx("div",{slot:"message"},t.executionError)))},i._renderValidateTopologyAction=function(){const{messages:t,viewModel:e}=this,o=`${this.id}-validation-action`;return p.tsx("div",{key:"actionDiv",slot:"control"},p.tsx("calcite-action",{id:o,bind:this,icon:"play-f",disabled:"executing"===e.state,text:t.input.validateTopology,textEnabled:!1,loading:"loading"===e.state,onclick:this._handleValidateTopologyAction}),p.tsx("calcite-tooltip",{referenceElement:o,label:t.input.validateTopology},p.tsx("span",null,"loading"===e.state?t.status.loading:t.input.validateTopology)))},e._createClass(s,[{key:"extentToValidate",get:function(){return this.viewModel.extentToValidate},set:function(t){this.viewModel.extentToValidate=t}},{key:"label",get:function(){return this.messages?.label??""},set:function(t){this._overrideIfSome("label",t)}},{key:"utilityNetwork",get:function(){return this.viewModel.utilityNetwork},set:function(t){this.viewModel.utilityNetwork=t}},{key:"view",get:function(){return this.viewModel.view},set:function(t){this.viewModel.view=t}}]),s}(r);o.__decorate([s.property()],v.prototype,"extentToValidate",null),o.__decorate([s.property()],v.prototype,"label",null),o.__decorate([s.property(),d.messageBundle("esri/widgets/UtilityNetworkValidateTopology/t9n/UtilityNetworkValidateTopology")],v.prototype,"messages",void 0),o.__decorate([s.property()],v.prototype,"utilityNetwork",null),o.__decorate([s.property()],v.prototype,"view",null),o.__decorate([s.property({type:x})],v.prototype,"viewModel",void 0),v=o.__decorate([c.subclass("esri.widgets.UtilityNetworkValidateTopology")],v);return v}));
