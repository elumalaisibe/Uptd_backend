/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../Color","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../../renderers/support/ClassBreakInfo","./SmartMappingSliderBase","./ClassedSizeSlider/ClassedSizeSliderViewModel","./support/utils","../support/widgetUtils","../support/decorators/messageBundle","../support/jsxFactory"],(function(e,r,t,s,i,a,n,o,l,c,d,p,u,m,h){"use strict";var g;const b="esri-classed-size-slider",k={base:b,rampElement:`${b}__ramp`,sliderContainer:`${b}__slider-container`,histogramContainer:`${b}__histogram-container`,track:`${b}--interactive-track`,esriWidget:"esri-widget",esriWidgetPanel:"esri-widget--panel",widgetIcon:"esri-icon-edit",disabled:"esri-disabled"},f={trackFillColor:new t([149,149,149]),trackBackgroundColor:new t([224,224,224])};let y=g=function(r){function t(e,t){var s;return(s=r.call(this,e,t)||this)._rampNode=null,s.messages=null,s.style={...f},s.viewModel=new d,s}e._inherits(t,r);var s=t.prototype;return s.castStyle=function(e){return{...f,...e}},t.fromRendererResult=function(e,r){const{renderer:{classBreakInfos:t}}=e,s=t.map((e=>{const r=e.symbol;let t;switch(r.type){case"simple-line":t=r.width;break;case"simple-marker":t=r.size;break;case"picture-marker":t=r.height}return{min:e.minValue,max:e.maxValue,size:t}}));return new g({breaks:s,histogramConfig:{bins:r?r.bins:[]}})},s.updateClassBreakInfos=function(e){const r=this.breaks;if(r.length===e.length)return e.map(((e,t)=>{const s=e.symbol;switch(s.type){case"simple-line":s.width=r[t].size;break;case"simple-marker":s.size=r[t].size;break;case"picture-marker":{const e=r[t].size,i=s.width,a=s.height;s.height=e,s.width=e/a*i;break}}return new l({minValue:r[t].min,maxValue:r[t].max,symbol:s})}));console.error(`Number of input breakInfos must match number of slider breaks: ${r.length}`)},s.updateFromRendererResult=function(e,r){const{renderer:{classBreakInfos:t}}=e,s=t.map((e=>{const r=e.symbol;let t;switch(r.type){case"simple-line":t=r.width;break;case"simple-marker":t=r.size;break;case"picture-marker":t=r.height}return{min:e.minValue,max:e.maxValue,size:t}}));this.set({breaks:s}),r?.bins&&(this.histogramConfig.bins=r.bins)},s.render=function(){const{state:e,label:r,visibleElements:t}=this,s="disabled"===e,i=this.classes(k.base,k.esriWidget,k.esriWidgetPanel,{[k.disabled]:s,[k.track]:!!t.interactiveTrack});return h.tsx("div",{"aria-label":r,class:i},s?null:this.renderContent(this.renderRamp(),k.sliderContainer,k.histogramContainer))},s.renderRamp=function(){const{style:{trackBackgroundColor:e}}=this;return h.tsx("div",{afterCreate:u.storeNode,bind:this,class:k.rampElement,"data-node-ref":"_rampNode"},h.tsx("svg",{xmlns:"http://www.w3.org/2000/svg"},h.tsx("rect",{x:"0",y:"0",fill:p.getFillFromColor(e),height:"100%",width:"100%"}),this.renderPath()))},s.renderPath=function(){if(!this._rampNode)return;const{offsetHeight:e=0,offsetWidth:r=0}=this._rampNode;if(null==e||null==r)return;const{breaks:t,viewModel:{max:s,min:i},style:{trackFillColor:a}}=this,n=s-i,o=r/t.length,l=t.map((r=>e-Math.round((r.min-i)/n*e)+1)).reverse(),c=t[0].size>t[t.length-1].size||!1;let d=c?o:r,u=`M${d} 0 `;return l.forEach(((e,t)=>{const s=o*(t+1);u+=`L${d} ${e} `,d=c?o+s:r-s,u+=`L${d} ${e} `})),u+=`L0 ${e} L0 ${e} L0 0 Z`,h.tsx("path",{d:u,fill:p.getFillFromColor(a)})},e._createClass(t,[{key:"breaks",get:function(){return this.viewModel.breaks},set:function(e){this.viewModel.breaks=e}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}}]),t}(c.SmartMappingSliderBase);r.__decorate([s.property()],y.prototype,"breaks",null),r.__decorate([s.property()],y.prototype,"label",null),r.__decorate([s.property(),m.messageBundle("esri/widgets/smartMapping/ClassedSizeSlider/t9n/ClassedSizeSlider")],y.prototype,"messages",void 0),r.__decorate([s.property()],y.prototype,"style",void 0),r.__decorate([i.cast("style")],y.prototype,"castStyle",null),r.__decorate([s.property()],y.prototype,"viewModel",void 0),y=g=r.__decorate([o.subclass("esri.widgets.smartMapping.ClassedSizeSlider")],y);return y}));
