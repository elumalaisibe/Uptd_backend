/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../analysis/DirectLineMeasurementAnalysis","../../core/reactiveUtils","../../core/unitUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../../properties/defaultUnit","../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool","../support/InteractiveAnalysisViewModel"],(function(t,e,i,n,s,r,a,l,o,u,c,d,p){"use strict";let h=function(e){function r(t){var i;return(i=e.call(this,t)||this).analysis=null,i.supportedViewType="3d",i.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.",i._userUnit=null,i._userUnitOptions=null,i}t._inherits(r,e);var a=r.prototype;return a.initialize=function(){this.addHandles(n.watch((()=>({analysis:this.analysis,unit:this.unit})),(({analysis:t,unit:e})=>{null!=t&&(t.unit=e)}),n.syncAndInitial))},a.constructAnalysis=function(){return new i},a.constructTool=function(){return new d({view:this.view,analysis:this.analysis,analysisViewData:this.analysisView,visible:this.visible})},a._findSelectableUnit=function(t,e){const i=this.unitOptions;return i.includes(t)?t:e?this._findSelectableUnit(e):i[0]},a._filteredOrAllUnits=function(t){if(!t)return s.measurementLengthUnits.slice();const e=t.filter((t=>s.measurementLengthUnits.includes(t)));return 0===e.length?s.measurementLengthUnits.slice():e},t._createClass(r,[{key:"state",get:function(){return this.disabled||!this.ready?"disabled":null==this.tool?"ready":this.tool.state}},{key:"measurement",get:function(){if(null==this.tool)return null;const t={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},{analysisViewData:e}=this.tool;if(null==e)return t;const i=e.actualVisualizedMeasurement,n=null!=e.result?"available":"unavailable";switch(i){case"euclidean":return{mode:"euclidean",directDistance:{text:e.directLabelText,state:n},horizontalDistance:{text:e.horizontalLabelText,state:n},verticalDistance:{text:e.verticalLabelText,state:n}};case"geodesic":return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:e.horizontalLabelText,state:n},verticalDistance:{text:e.verticalLabelText,state:n}};default:return t}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(t){this._userUnitOptions=t,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)},set:function(t){this._userUnit=t?this._findSelectableUnit(t,this._userUnit):null}}]),r}(p.InteractiveAnalysisViewModel);e.__decorate([r.property({type:i})],h.prototype,"analysis",void 0),e.__decorate([r.property({readOnly:!0})],h.prototype,"state",null),e.__decorate([r.property({readOnly:!0})],h.prototype,"measurement",null),e.__decorate([r.property()],h.prototype,"unitOptions",null),e.__decorate([r.property()],h.prototype,"unit",null),e.__decorate([r.property(c.defaultUnitPropertyMetadata)],h.prototype,"defaultUnit",void 0),e.__decorate([r.property()],h.prototype,"_userUnit",void 0),e.__decorate([r.property()],h.prototype,"_userUnitOptions",void 0),h=e.__decorate([u.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],h);return h}));
