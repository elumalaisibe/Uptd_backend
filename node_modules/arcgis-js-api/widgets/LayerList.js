/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Collection","../core/events","../core/has","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/accessorSupport/decorators/subclass","./Widget","./LayerList/LayerListViewModel","./LayerList/ListItem","./LayerList/support/layerListUtils","./support/componentsUtils","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","./support/widgetUtils","../chunks/sortable.esm"],(function(e,t,i,n,s,o,r,l,a,c,d,u,h,g,p,m,b,_,y,f,I,v){"use strict";function C(e,t,i){e.splice(i,0,e.splice(t,1)[0])}const w="esri-layerlist-new-ui",S=n.ofType(g),A="data-sort-filter",x="data-layer-uid",$="layerUid",k="esri-layer-list",T=`${k}__item`,M={base:`${k} esri-widget esri-widget--panel`,newUI:`${k}--new-ui`,noItems:`${k}__no-items`,list:`${k}__list`,listRoot:`${k}__list--root`,listExclusive:`${k}__list--exclusive`,listInherited:`${k}__list--inherited`,listIndependent:`${k}__list--independent`,item:T,itemContent:`${T}-content`,itemMessage:`${T}--has-message`,itemInvisible:`${T}--invisible`,itemInvisibleAtScale:`${T}--invisible-at-scale`,itemChildren:`${T}--has-children`,itemSelectable:`${T}--selectable`,itemContainer:`${T}-container`,actionsMenu:`${T}-actions-menu`,actionsMenuItem:`${T}-actions-menu-item`,actionsMenuItemActive:`${T}-actions-menu-item--active`,actions:`${T}-actions`,actionsList:`${T}-actions-list`,action:`${T}-action`,actionIcon:`${T}-action-icon`,actionImage:`${T}-action-image`,actionTitle:`${T}-action-title`,actionToggle:`${k}__action-toggle`,actionToggleOn:`${k}__action-toggle--on`,label:`${T}-label`,message:`${T}-message`,title:`${T}-title`,statusIndicator:`${k}__status-indicator`,publishing:`${k}__publishing`,updating:`${k}__updating`,connectionStatus:`${k}__connection-status`,connectionStatusConnected:`${k}__connection-status--connected`,toggleVisible:`${T}-toggle`,toggleVisibleIcon:`${T}-toggle-icon`,toggleIcon:`${T}-toggle-icon`,radioIcon:`${T}-radio-icon`,childToggle:`${k}__child-toggle`,childToggleOpen:`${k}__child-toggle--open`,childOpened:`${k}__child-toggle-icon--opened`,childClosed:`${k}__child-toggle-icon--closed`,childClosed_RTL:`${k}__child-toggle-icon--closed-rtl`,sortableChosen:`${k}--chosen`,disabled:"esri-disabled",disabledElement:"esri-disabled-element",hidden:"esri-hidden",rotating:"esri-rotating",iconEllipses:"esri-icon-handle-horizontal",iconVisible:"esri-icon-visible",iconInvisible:"esri-icon-non-visible",iconRadioSelected:"esri-icon-radio-checked",iconRadioUnselected:"esri-icon-radio-unchecked",iconNoticeTriangle:"esri-icon-notice-triangle",iconChildrenOpen:"esri-icon-down-arrow",iconDownArrow:"esri-icon-down-arrow",iconRightArrow:"esri-icon-right-triangle-arrow",iconLeftArrow:"esri-icon-left-triangle-arrow",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",widgetIcon:"esri-icon-layers"},L={actions:"actions",actionSection:"action-section",items:"items"},E={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function R(e){const{actionsOpen:t,children:i}=e;t&&(e.actionsOpen=!1),i.forEach((e=>R(e)))}const U="root",N={statusIndicators:!0,errors:!1};let O=function(i){function n(e,n){var s;return(s=i.call(this,e,n)||this)._sortableNodes=new Map,s._sortableMap=new Map,s._focusSortUid=null,s._newUI=o(w),s._tooltipReferenceMap=new Map,s.visibleItems=null,s.iconClass=M.widgetIcon,s.icon=null,s.listItemCanGiveFunction=null,s.listItemCanReceiveFunction=null,s.messages=null,s.messagesCommon=null,s.multipleSelectionEnabled=!1,s.selectionEnabled=!1,s.selectedItems=new S,s.viewModel=new h,s.visibleElements={...N},s._onSortableSort=({to:e,from:t,item:i,newIndex:n})=>{t&&e&&(t===e?s._sortLayers(s._sortableMap.get(t.dataset.group)):s._moveLayerFromChildList({to:e,from:t,item:i,newIndex:n}))},s._sortableCanSort=(e,t)=>!(!e.el.dataset.group||!t.el.dataset.group),s._sortableCanPull=(e,i,n)=>{const{listItemCanGiveFunction:o}=t._assertThisInitialized(s),r={selected:V(n),from:V(i.el),to:V(e.el)};return!s._sortableCanSort(e,i)||"function"!=typeof o||o.call(null,r)},s._sortableCanPut=(e,i,n)=>{const{listItemCanReceiveFunction:o}=t._assertThisInitialized(s),r={selected:V(n),from:V(i.el),to:V(e.el)};return!s._sortableCanSort(e,i)||"function"!=typeof o||o.call(null,r)},s._onSortableEnd=({oldIndex:e,from:t,to:i,item:n})=>{t!==i&&t.insertBefore(n,t.children[e])},s}t._inherits(n,i);var l=n.prototype;return l.initialize=function(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([r.on((()=>this.operationalItems),"change",(()=>this._itemsChanged(e))),r.watch((()=>this.visibleElements),(()=>this._itemsChanged(e))),r.watch((()=>this.selectionEnabled),(()=>this._toggleAllSorting()),r.initial)])},l.loadDependencies=function(){return m.loadCalciteComponents({icon:()=>new Promise(((t,i)=>e(["../chunks/calcite-icon"],t,i))),tooltip:()=>new Promise(((t,i)=>e(["../chunks/calcite-tooltip"],t,i)))})},l.destroy=function(){this.removeAllHandles(),this._destroySortables(),this._tooltipReferenceMap.clear()},l.castVisibleElements=function(e){return{...N,...e}},l.triggerAction=function(e,t){return this.viewModel.triggerAction(e,t)},l.render=function(){const{visibleItems:e,_newUI:t}=this,i=this.viewModel?.state,n={[M.newUI]:t,[M.hidden]:"loading"===i,[M.disabled]:"disabled"===i},s=this.renderItemTooltips(),o=this.renderItems();return f.tsx("div",{class:this.classes(M.base,n)},e.length?[s,o]:this.renderNoItems())},l.renderItemTooltip=function(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?f.tsx("calcite-tooltip",{label:i.layerIncompatible,referenceElement:t.get(e.uid)},i.layerIncompatibleTooltip):null},l.renderItemTooltipNodes=function(e){const{incompatible:t,children:i}=e;return[t?this.renderItemTooltip(e):null,...!t&&i?i.toArray().map((e=>this.renderItemTooltipNodes(e))):[]]},l.renderItemTooltips=function(){return this.visibleItems.toArray().map((e=>this.renderItemTooltipNodes(e)))??[]},l.renderNoItems=function(){return f.tsx("div",{class:M.noItems},this.messages.noItemsToDisplay)},l.renderItems=function(){const{visibleItems:e,selectionEnabled:t,messages:i}=this;return f.tsx("ul",{"aria-label":i.widgetLabel,role:t?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":U,bind:this,class:this.classes(M.list,M.listRoot,M.listIndependent)},e.map((e=>this.renderItem(e,null))).toArray())},l.renderActionsMenuIcon=function(e,t){const{messagesCommon:i}=this,n={[M.actionsMenuItemActive]:e.actionsOpen};return f.tsx("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(M.actionsMenuItem,n),tabindex:"0",role:"button","aria-controls":t,"aria-label":i.options,title:i.options},f.tsx("span",{"aria-hidden":"true",class:M.iconEllipses}))},l.renderActionsMenu=function(e,t,i,n){const{panel:s}=e,o=s&&s.visible?this.renderPanelButton(s):null,r=1===i&&this._getSingleActionButton(t),l=r?this.renderAction({item:e,action:r,singleAction:!0}):null,a=!r&&i?this.renderActionsMenuIcon(e,n):null;return a||o||r?f.tsx("div",{key:"actions-menu",class:M.actionsMenu},o,l,a):null},l.renderChildList=function(e,t){const{selectionEnabled:i}=this,{visibilityMode:n,children:s}=e,o=this._hasChildren(e),r=!o&&i&&"group"===e.layer?.type,{exclusive:l,inherited:a}=E,c={[M.listExclusive]:n===l,[M.listInherited]:n===a,[M.listIndependent]:n!==a&&n!==l};return o||r?f.tsx("ul",{bind:this,key:"list-items",id:t,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(M.list,c),"aria-expanded":e.open?"true":"false",role:i?"listbox":n===l?"radiogroup":"group",hidden:!e.open&&!r||null},s?.map((t=>this.renderItem(t,e))).toArray()):null},l.renderChildrenToggle=function(e,t){const{messagesCommon:i}=this,n=this._hasChildren(e),s={[M.childToggleOpen]:e.open},o=e.open?i.collapse:i.expand;return n?f.tsx("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(M.childToggle,s),tabindex:"0",role:"button","aria-controls":t,"aria-label":o,title:o},f.tsx("span",{"aria-hidden":"true",class:this.classes(M.childClosed,M.iconRightArrow)}),f.tsx("span",{"aria-hidden":"true",class:this.classes(M.childOpened,M.iconDownArrow)}),f.tsx("span",{"aria-hidden":"true",class:this.classes(M.childClosed_RTL,M.iconLeftArrow)})):null},l.renderItemMessage=function(e){return e.error?f.tsx("div",{key:"esri-layer-list__error",class:M.message,role:"alert"},f.tsx("span",{"aria-hidden":"true",class:M.iconNoticeTriangle}),this.messages.layerError):e.incompatible?f.tsx("div",{key:"esri-layer-list__incompatible",class:M.message,role:"alert"},f.tsx("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:M.iconNoticeTriangle,afterCreate:t=>this._setTooltipReference(t,e)}),this.messages.layerIncompatible):null},l.renderItemContent=function(e,t,i){const{id:n}=this,s=`${n}_${e.uid}`,o=`${s}_actions`,r=`${s}__list`,{panel:l}=e,a=this._filterActions(e.actionsSections),c=this._countActions(a);return[f.tsx("div",{key:"list-item-container",class:M.itemContainer},this.renderChildrenToggle(e,r),this.renderLabel(e,t,i),this.renderActionsMenu(e,a,c,o)),this.renderItemMessage(e),c?this.renderActionsSections(e,a,o):null,l&&l.open&&!l.disabled?l.render():null,this.renderChildList(e,r)]},l.renderItem=function(e,t){const{_newUI:i,id:n,selectionEnabled:s,selectedItems:o}=this,r=`${`${n}_${e.uid}`}__title`,l=this._hasMessage(e),a=this._hasChildren(e),c={[M.itemChildren]:a,[M.itemMessage]:!!l,[M.itemInvisible]:i&&!e.visible,[M.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[M.itemSelectable]:s};if(s){const i={[x]:e.layer?.uid,[A]:(!e.sortable).toString()};return f.tsx("li",{key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(M.item,c),"aria-labelledby":r,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":t?t.uid:U,tabIndex:0,"aria-selected":p.findSelectedItem(e,o)?"true":"false",role:"option",...i},this.renderItemContent(e,t,r))}return f.tsx("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(M.item,c),"aria-labelledby":r},this.renderItemContent(e,t,r))},l.renderConnectionIcon=function(e){const{connectionStatus:t}=e;return null!=t?f.tsx("calcite-icon",{icon:"connected"===t?"beacon":"offline",scale:"s"}):null},l.renderItemStatus=function(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:n,publishing:s,updating:o}=e,r=o&&!t,l=!!n;return f.tsx("span",{class:this.classes({[M.statusIndicator]:!0,[M.publishing]:s,[M.updating]:r,[M.connectionStatus]:l,[M.connectionStatusConnected]:l&&"connected"===n}),key:"layer-item-status"},this.renderConnectionIcon(e))},l.renderItemTitle=function(e,t){const{messages:i}=this;if(!e)return null;const n=e.title||i.untitledLayer,s=e.visibleAtCurrentScale?n:`${n} (${i.layerInvisibleAtScale})`;return f.tsx("span",{key:"layer-title-container",id:t,title:s,"aria-label":s,class:M.title},n)},l.renderItemToggleIcon=function(e,t){const{_newUI:i}=this,{exclusive:n}=E,s=t?.visibilityMode,o={[M.toggleVisibleIcon]:i,[M.toggleIcon]:i&&s!==n,[M.radioIcon]:i&&s===n,[M.iconRadioSelected]:s===n&&e.visible,[M.iconRadioUnselected]:s===n&&!e.visible,[M.iconVisible]:s!==n&&e.visible,[M.iconInvisible]:s!==n&&!e.visible};return f.tsx("span",{key:"item-toggle-icon",class:this.classes(o),"aria-hidden":"true"})},l.renderItemToggle=function(e,t,i){const{selectionEnabled:n,messages:s}=this,{exclusive:o}=E,r=t?.visibilityMode,l=r===o?"radio":"switch";return n?f.tsx("span",{key:"item-toggle-selection-enabled",class:M.toggleVisible,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":r,tabIndex:0,title:s.layerVisibility,"aria-checked":e.visible?"true":"false",role:l,"aria-labelledby":i},this.renderItemToggleIcon(e,t)):f.tsx("span",{key:"item-toggle",class:M.toggleVisible},this.renderItemToggleIcon(e,t))},l.renderLabel=function(e,t,i){const{selectionEnabled:n,_newUI:s,messages:o}=this,{inherited:r,exclusive:l}=E,a=t?.visibilityMode,c=a===l?"radio":"switch",d=s?[this.renderItemTitle(e,i),this.renderItemStatus(e,t),this.renderItemToggle(e,t,i)]:[this.renderItemToggle(e,t,i),this.renderItemTitle(e,i),this.renderItemStatus(e,t)],u=n?f.tsx("div",{key:`item-label-no-selection-${e.uid}`,class:M.label},d):f.tsx("div",{key:`item-label-with-selection-${e.uid}`,class:M.label,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":a,tabIndex:0,"aria-checked":e.visible?"true":"false",title:o.layerVisibility,role:c,"aria-labelledby":i},d);return a===r||e.error?f.tsx("div",{key:`item-label-container-${e.uid}`,class:M.label},this.renderItemTitle(e,i),this.renderItemStatus(e,t)):u},l.renderPanelButton=function(e){const{className:t,open:i,title:n,image:s,disabled:o}=e,r=s||t?t:M.iconDefaultAction,l=this._getIconImageStyles(e),a={[M.actionsMenuItemActive]:i&&!o},c={[M.actionImage]:!!l["background-image"],[M.disabledElement]:e.disabled};return r&&(c[r]=!!r),f.tsx("div",{"aria-disabled":e.disabled.toString(),key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(M.actionsMenuItem,a),role:"button",tabindex:e.disabled?null:0,title:n,"aria-label":n},f.tsx("span",{class:this.classes(c),styles:l}))},l.renderActionsSections=function(e,t,i){const n=t.toArray().map(((t,i)=>f.tsx("ul",{key:`${e}-action-section-${i}`,class:M.actionsList},this.renderActionSection(e,t))));return f.tsx("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:i,class:M.actions,hidden:!e.actionsOpen||null},n)},l.renderActionSection=function(e,t){return(t&&t.toArray()).map((t=>this.renderAction({item:e,action:t})))},l.renderActionIcon=function(e){const{active:t,className:i}=e,n=this._getIconImageStyles(e),s="button"!==e.type||e.image||i?i:M.iconDefaultAction,o={[M.actionImage]:!t&&!!n["background-image"],[M.iconLoading]:t,[M.rotating]:t};return s&&!t&&(o[s]=!0),f.tsx("span",{key:"action-icon","aria-hidden":"true",class:this.classes(M.actionIcon,o),styles:n})},l.renderActionTitle=function(e,t){return t?null:f.tsx("span",{key:"action-title",class:M.actionTitle},e)},l.renderAction=function(e){const{item:t,action:i,singleAction:n}=e,{active:s,disabled:o,title:r}=i,l={[M.actionsMenuItem]:n&&"button"===i.type,[M.action]:s||!n&&"toggle"!==i.type,[M.actionToggle]:!s&&"toggle"===i.type,[M.actionToggleOn]:!s&&"toggle"===i.type&&i.value,[M.disabledElement]:o},a=[this.renderActionIcon(i),this.renderActionTitle(r,n)];return n?f.tsx("div",{bind:this,"data-item":t,"data-action":i,role:"button",key:`single-action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",title:r??void 0,"aria-label":r??void 0},a):f.tsx("li",{bind:this,"data-item":t,"data-action":i,key:`action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",role:"button",title:r??void 0,"aria-label":r??void 0},a)},l._setTooltipReference=function(e,t){this._tooltipReferenceMap.set(t.uid,e),this.scheduleRender()},l._hasMessage=function(e){return!!e.error||e.incompatible},l._hasChildren=function(e){return!!e.children.length&&!this._hasMessage(e)},l._sortNodeRemoved=function(e){const{_sortableMap:t}=this,i=e.dataset.group,n=t.get(i);n&&n.destroy(),t.delete(i)},l._destroySortables=function(){const{_sortableMap:e,_sortableNodes:t}=this;e.forEach((e=>e&&e.destroy())),e.clear(),t.clear()},l._moveLayerFromChildList=function({to:e,from:t,item:i,newIndex:n}){const s=V(i),o=V(e),r=V(t);this.viewModel.moveListItem(s,r,o,n)},l._sortLayers=function(e){if(!e)return;const t=V(e.el),i=e.toArray();t?p.sortChildLayersToIds(t,i):p.sortLayersToIds(this.view?.map?.layers,i)},l._toggleSorting=function(e,t){const{_sortableMap:i,selectionEnabled:n}=this,s=i.get(t),o=V(e),r=(t===U||o?.childrenSortable&&p.canSortSublayers(o))&&n;if(s)s.option("disabled",!r);else if(r){const n=v.Sortable.create(e,{dataIdAttr:x,group:{name:t,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${A}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!r,chosenClass:M.sortableChosen});i.set(t,n)}},l._toggleAllSorting=function(){this._sortableNodes.forEach(((e,t)=>this._toggleSorting(e,t)))},l._sortNodeCreated=function(e){const t=e.dataset.group;t&&(this._sortableNodes.set(t,e),this._toggleSorting(e,t))},l._setVisibleItems=function(e){this.visibleItems=e.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))},l._getSingleActionButton=function(e){return e.reduce((e=>e)).filter((e=>e&&"button"===e.type)).at(0)},l._focusListItem=function(e){const{_focusSortUid:t}=this;if(!e||!t)return;const i=V(e);i?.layer?.uid===t&&(e.focus(),this._focusSortUid=null)},l._watchActionSectionChanges=function(e){this.addHandles(e.on("change",this.scheduleRender.bind(this)),L.actionSection),e.forEach((e=>this._renderOnActionChanges(e)))},l._renderOnActionChanges=function(e){"toggle"!==e.type?"slider"!==e.type?this.addHandles(r.watch((()=>[e?.className,e?.image,e?.id,e?.title,e?.visible]),(()=>this.scheduleRender()),r.initial),L.actions):this.addHandles(r.watch((()=>[e?.className,e?.id,e?.title,e?.visible,e?.value,e?.displayValueEnabled,e?.max,e?.min,e?.step]),(()=>this.scheduleRender()),r.initial),L.actions):this.addHandles(r.watch((()=>[e?.className,e?.image,e?.id,e?.title,e?.visible,e?.value]),(()=>this.scheduleRender()),r.initial),L.actions)},l._renderOnItemChanges=function(e){this.addHandles([r.watch((()=>[e?.actionsOpen,e?.visible,e?.open,e?.updating,e?.connectionStatus,e?.publishing,e?.title,e?.visibleAtCurrentScale,e?.error,e?.visibilityMode,e?.panel,e?.panel?.title,e?.panel?.content,e?.panel?.className,e?.sortable,e?.childrenSortable]),(()=>this.scheduleRender()),r.syncAndInitial),r.watch((()=>[e?.hidden,e?.error]),(()=>this._setVisibleItems(this.operationalItems))),e.actionsSections.on("change",(()=>this.scheduleRender())),e.children.on("change",(()=>this.scheduleRender()))],L.items),e.children.forEach((e=>this._renderOnItemChanges(e))),e.actionsSections.forEach((e=>this._watchActionSectionChanges(e)))},l._itemsChanged=function(e){this.removeHandles(L.items),this.removeHandles(L.actions),this.removeHandles(L.actionSection),e.forEach((e=>this._renderOnItemChanges(e))),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()},l._filterActions=function(e){return e.map((e=>e.filter((e=>e.visible))))},l._countActions=function(e){return e.reduce(((e,t)=>e+t.length),0)},l._getIconImageStyles=function(e){const t="esri.widgets.LayerList.ListItemPanel"===e.declaredClass||"esri.support.Action.ActionButton"===e.declaredClass||"esri.support.Action.ActionToggle"===e.declaredClass?e.image:null;return{"background-image":t?`url("${t}")`:void 0}},l._selectionKeydown=function(e){const t=["ArrowDown","ArrowUp"],i=s.eventKey(e);if(!t.includes(i))return void this._toggleSelection(e);e.stopPropagation();const n=e.currentTarget,o=V(n),{_sortableMap:r,selectedItems:l}=this,a=n.dataset.group,c=r.get(a);if(!c||!o)return;const d=p.findSelectedItem(o,l),u=c.toArray(),h=e.target,g=u.indexOf(h.dataset[$]);if(-1!==g){if("ArrowDown"===i){const e=g+1;if(e>=u.length)return;d?(C(u,g,e),c.sort(u),this._sortLayers(c),this._focusSortUid=o.layer?.uid):(this._focusSortUid=o.layer?.uid,this.scheduleRender())}if("ArrowUp"===i){const e=g-1;if(e<=-1)return;d?(C(u,g,e),c.sort(u),this._sortLayers(c),this._focusSortUid=o.layer?.uid):(this._focusSortUid=o.layer?.uid,this.scheduleRender())}}},l._toggleActionsOpen=function(e){const t=V(e.currentTarget);if(!t)return;const{actionsOpen:i}=t,n=!i;n&&this.operationalItems.forEach((e=>R(e))),t.actionsOpen=n,e.stopPropagation()},l._triggerPanel=function(e){const t=P(e.currentTarget);e.stopPropagation(),t&&!t.disabled&&(t.open=!t.open)},l._triggerAction=function(e){const t=e.currentTarget,i=H(t),n=V(t);i&&n&&("toggle"===i.type&&(i.value=!i.value),this.triggerAction(i,n),e.stopPropagation())},l._toggleVisibility=function(e){const t=e.currentTarget,i=t.getAttribute("data-parent-visibility"),n=V(t);n&&(i===E.exclusive&&n.visible||(n.visible=!n.visible),e.stopPropagation())},l._toggleChildrenClick=function(e){const t=V(e.currentTarget);t&&(t.open=!t.open,e.stopPropagation())},l._toggleSelection=function(e){e.stopPropagation();const{multipleSelectionEnabled:t,selectedItems:i}=this,n=V(e.currentTarget);if(!n)return;const s=p.findSelectedItem(n,i),{length:o}=i;if(!t)return o&&!(s&&1===o)?(i.removeAll(),void i.add(n)):void(s?i.remove?.(s):i.add(n));s?i.remove?.(s):i.add(n)},t._createClass(n,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"listItemCreatedFunction",get:function(){return this.viewModel.listItemCreatedFunction},set:function(e){this.viewModel.listItemCreatedFunction=e}},{key:"operationalItems",get:function(){return this.viewModel.operationalItems},set:function(e){this.viewModel.operationalItems=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"test",get:function(){return{visibleItems:this.visibleItems}}}]),n}(u);function V(e){return e?.["data-item"]}function P(e){return e?.["data-panel"]}function H(e){return e?.["data-action"]}i.__decorate([l.property()],O.prototype,"visibleItems",void 0),i.__decorate([l.property()],O.prototype,"iconClass",void 0),i.__decorate([l.property()],O.prototype,"icon",void 0),i.__decorate([l.property()],O.prototype,"label",null),i.__decorate([l.property()],O.prototype,"listItemCanGiveFunction",void 0),i.__decorate([l.property()],O.prototype,"listItemCanReceiveFunction",void 0),i.__decorate([l.property()],O.prototype,"listItemCreatedFunction",null),i.__decorate([l.property(),_.messageBundle("esri/widgets/LayerList/t9n/LayerList")],O.prototype,"messages",void 0),i.__decorate([l.property(),_.messageBundle("esri/t9n/common")],O.prototype,"messagesCommon",void 0),i.__decorate([l.property()],O.prototype,"multipleSelectionEnabled",void 0),i.__decorate([l.property()],O.prototype,"operationalItems",null),i.__decorate([l.property()],O.prototype,"selectionEnabled",void 0),i.__decorate([l.property()],O.prototype,"selectedItems",void 0),i.__decorate([l.property()],O.prototype,"view",null),i.__decorate([y.vmEvent("trigger-action"),l.property({type:h})],O.prototype,"viewModel",void 0),i.__decorate([l.property()],O.prototype,"visibleElements",void 0),i.__decorate([a.cast("visibleElements")],O.prototype,"castVisibleElements",null),i.__decorate([b.accessibleHandler()],O.prototype,"_toggleActionsOpen",null),i.__decorate([b.accessibleHandler()],O.prototype,"_triggerPanel",null),i.__decorate([b.accessibleHandler()],O.prototype,"_triggerAction",null),i.__decorate([b.accessibleHandler()],O.prototype,"_toggleVisibility",null),i.__decorate([b.accessibleHandler()],O.prototype,"_toggleChildrenClick",null),i.__decorate([b.accessibleHandler()],O.prototype,"_toggleSelection",null),O=i.__decorate([d.subclass("esri.widgets.LayerList")],O);return O}));
