/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/has","../../../core/accessorSupport/decorators/subclass","../../Widget","../../support/widgetUtils","../../support/jsxFactory"],(function(e,t,s,r,o,a,i,n,c,h,u){"use strict";const l={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"},p="esri-building-phase-picker",d={container:`${p}`,phasesContainer:`${p}__phases-container`,phase:`${p}__phase`,phaseActive:`${p}__phase--active`,phaseCurrent:`${p}__phase--current`,divider:`${p}__divider`,dividerActive:`${p}__divider--active`,arrowLeft:`${p}__arrow-left`,arrowRight:`${p}__arrow-right`};let _=function(t){function r(s,r){var o;return(o=t.call(this,s,r)||this)._phasesContainer=null,o._shouldScrollCurrentPhaseIntoView=!0,o._shouldFocusCurrentPhase=!1,o._onKeyDown=t=>{const{vm:s}=e._assertThisInitialized(o);switch(t.key){case"ArrowDown":case"ArrowLeft":t.stopPropagation(),t.preventDefault(),s.previous(),o._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":t.stopPropagation(),t.preventDefault(),s.next(),o._shouldFocusCurrentPhase=!0}},o._onArrowLeftClick=()=>{o.vm.previous()},o._onArrowRightClick=()=>{o.vm.next()},o._onPhasesContainerAfterCreate=e=>{o._phasesContainer=e,requestAnimationFrame(o._scrollOrFocusPhase)},o._scrollOrFocusPhase=()=>{const e=o._phasesContainer;if(o.destroyed||null==e)return;const t=e.querySelector(`.${d.phaseCurrent}`);if(t){if(o._shouldScrollCurrentPhaseIntoView){const s=e.offsetWidth,r=t.offsetLeft,a=t.offsetWidth;e.scrollLeft=-s/2+r-a/2,o._shouldScrollCurrentPhaseIntoView=!1}o._shouldFocusCurrentPhase&&(t.focus(),o._shouldFocusCurrentPhase=!1)}},o}e._inherits(r,t);var o=r.prototype;return o.initialize=function(){this.addHandles(s.watch((()=>[this._currentPhase,this._phasesContainer,this.container]),(()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)}),s.initial))},o.render=function(){if(this._phases.length<2)return u.tsx("div",{key:"no-phases"});const{vm:e,container:t,messages:s}=this,{previousPhase:r,nextPhase:o}=s??l,a=h.isRTL(t);return u.tsx("div",{class:this.classes("esri-widget",d.container),key:this,onkeydown:this._onKeyDown},u.tsx("button",{type:"button",class:a?d.arrowRight:d.arrowLeft,disabled:!e.hasPrevious,"aria-label":r,title:r,onclick:this._onArrowLeftClick}),u.tsx("div",{class:d.phasesContainer,afterCreate:this._onPhasesContainerAfterCreate},this._renderPhaseButtons()),u.tsx("button",{type:"button",class:a?d.arrowLeft:d.arrowRight,disabled:!e.hasNext,"aria-label":o,title:o,onclick:this._onArrowRightClick}))},o._renderPhaseButtons=function(){const e=this._phases,t=this._currentPhase,s=[];for(let r=0;r<e.length;++r){const o=e[r],a={phase:o,active:null!=t&&o<=t,current:null!=t&&o===t};r>0&&s.push(this._renderDivider(a)),s.push(this._renderPhaseButton(a))}return s},o._renderPhaseButton=function({phase:e,active:t,current:s}){const{vm:r}=this,o=r.getValueLabel(e);return u.tsx("button",{key:`phase-${e}`,class:this.classes(d.phase,{[d.phaseActive]:t,[d.phaseCurrent]:s}),"aria-label":o,title:o,onclick:()=>r.select(e),type:"button"},e)},o._renderDivider=function({phase:e,active:t}){return u.tsx("div",{key:`phase-divider-${e}`,class:this.classes(d.divider,{[d.dividerActive]:t})})},e._createClass(r,[{key:"_phases",get:function(){return this.vm.allowedValues}},{key:"_currentPhase",get:function(){const{vm:e}=this;return e.enabled?e.value:null}}]),r}(c);t.__decorate([r.property({nonNullable:!0})],_.prototype,"vm",void 0),t.__decorate([r.property()],_.prototype,"messages",void 0),t.__decorate([r.property()],_.prototype,"_phases",null),t.__decorate([r.property()],_.prototype,"_currentPhase",null),t.__decorate([r.property()],_.prototype,"_phasesContainer",void 0),_=t.__decorate([n.subclass("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],_);return _}));
