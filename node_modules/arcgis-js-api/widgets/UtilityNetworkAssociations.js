/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Handles","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./support/componentsUtils","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./UtilityNetworkAssociations/UtilityNetworkAssociationsViewModel"],(function(t,s,i,e,o,n,a,c,l,r,d,h,u,w,A,p){"use strict";const b={widgetBlockContent:"esri-un-associations__widget-block-content",widgetBlockActions:"esri-un-associations__widget-block-actions",widgetBlockActionsSwitch:"esri-un-associations__widget-block-actions-switch",widgetSettingsContainer:"esri-un-associations__widget-settings-container",widgetControlsLabelAndToggle:"esri-un-associations__controls-label-and-toggle",widgetControlsLabelAndSlider:"esri-un-associations__controls-label-and-slider",widgetControlsLabel:"esri-un-associations__controls-label",widgetControlsSlider:"esri-un-associations__controls-slider"},g={maxAllowableAssociationsSlider:!1};let S=function(i){function n(t,s){var o;return(o=i.call(this,t,s)||this)._autoRefreshAssociations=!0,o._associationsOptionsEnabled=!1,o._handles=new e,o._maxAllowableAssociationsSliderMax=1e3,o._maxAllowableAssociationsSliderMin=250,o._maxAllowableAssociationsSliderStep=250,o.messages=null,o.showAssociationsEnabled=!1,o.viewModel=new p,o.visibleElements={...g},o}s._inherits(n,i);var a=n.prototype;return a.initialize=function(){this._handles.add([o.watch((()=>[this.view?.stationary,this.showAssociationsEnabled,this.includeConnectivityAssociations,this.includeStructuralAttachmentAssociations,this.maxAllowableAssociations]),(()=>{!0===this.autoRefreshAssociations&&(!0===this.showAssociationsEnabled?this.viewModel.showAssociations():this.viewModel.removeAssociations())}))])},a.castVisibleElements=function(t){return{...g,...t}},a.render=function(){const t=this.viewModel;return A.tsx("div",null,A.tsx("calcite-block",{heading:this.label,class:b.widgetBlockContent,collapsible:"disabled"!==t.state,open:"disabled"===t.state},this.renderShowStatusIcon(),this.autoRefreshAssociations?this.renderShowAssociationsSwitch():this.renderRefreshAssociationsAction(),this.renderSettings()),this.autoRefreshAssociations?this.renderShowAssociationsSwitchTooltip():this.renderRefreshAssociationsActionTooltip(),this.renderShowStatusIconTooltip())},a.loadDependencies=function(){return h.loadCalciteComponents({action:()=>new Promise(((s,i)=>t(["../chunks/calcite-action"],s,i))),block:()=>new Promise(((s,i)=>t(["../chunks/calcite-block"],s,i))),label:()=>new Promise(((s,i)=>t(["../chunks/calcite-label"],s,i))),notice:()=>new Promise(((s,i)=>t(["../chunks/calcite-notice"],s,i))),slider:()=>new Promise(((s,i)=>t(["../chunks/calcite-slider"],s,i))),switch:()=>new Promise(((s,i)=>t(["../chunks/calcite-switch"],s,i))),tooltip:()=>new Promise(((s,i)=>t(["../chunks/calcite-tooltip"],s,i)))})},a.renderConnectivityAssociationsToggle=function(){const{messages:t}=this;return A.tsx("div",{class:b.widgetControlsLabelAndToggle},A.tsx("calcite-label",{class:b.widgetControlsLabel},t.inputStrings.enableConnectivity),A.tsx("calcite-switch",{bind:this,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,checked:this.includeConnectivityAssociations,onCalciteSwitchChange:this._connectivityAssociationsSwitchChange}))},a.renderMaxAllowableAssociationsSlider=function(){const{messages:t,visibleElements:{maxAllowableAssociationsSlider:s}}=this;if(s)return A.tsx("div",{class:b.widgetControlsLabelAndSlider},A.tsx("calcite-label",{class:b.widgetControlsLabel},t.inputStrings.maxAllowableAssociations),A.tsx("calcite-slider",{bind:this,class:b.widgetControlsSlider,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,min:this.maxAllowableAssociationsSliderMin,max:this.maxAllowableAssociationsSliderMax,step:this.maxAllowableAssociationsSliderStep,ticks:this.maxAllowableAssociationsSliderStep,value:this.maxAllowableAssociations,labelTicks:!0,snap:!0,scale:"s",onCalciteSliderChange:this._maxAllowableAssociationsSliderChange}))},a.renderRefreshAssociationsAction=function(){if("disabled"!==this.viewModel.state)return A.tsx("div",{slot:"control",style:"--calcite-ui-icon-color: #077ac2"},A.tsx("calcite-action",{id:"refreshAssociations-action",bind:this,class:b.widgetBlockActions,icon:"refresh-",text:"",onclick:this._refreshAssociations}))},a.renderRefreshAssociationsActionTooltip=function(){const{messages:t}=this;return A.tsx("calcite-tooltip",{label:"refreshAssociations-action-tooltip-label",referenceElement:"refreshAssociations-action"},A.tsx("span",null,t.inputStrings.refreshAssociations))},a.renderSettings=function(){const t=this.viewModel;return"disabled"===t.state?A.tsx("calcite-notice",{open:!0,kind:"warning",scale:"s"},A.tsx("div",{slot:"message"},t.errorMessage)):A.tsx("div",{class:b.widgetSettingsContainer},this.renderConnectivityAssociationsToggle(),this.renderStructuralAttachmentAssociationsToggle(),this.renderMaxAllowableAssociationsSlider())},a.renderShowAssociationsSwitch=function(){return"disabled"===this.viewModel.state?A.tsx("div",{id:"showAssociations-switch"}):A.tsx("calcite-switch",{id:"showAssociations-switch",bind:this,class:b.widgetBlockActionsSwitch,checked:this.showAssociationsEnabled,onCalciteSwitchChange:this._showAssociationsSwitchChange,slot:"control"})},a.renderShowAssociationsSwitchTooltip=function(){const{messages:t}=this;return A.tsx("calcite-tooltip",{label:"showAssociations-switch-tooltip-label",referenceElement:"showAssociations-switch"},A.tsx("span",null,t.inputStrings.enableAssociations))},a.renderShowStatusIcon=function(){const t=this.viewModel,s=()=>{switch(t.state){case"disabled":case"failed":case"warning":return"exclamation-mark-triangle";default:return"blank"}},i=()=>{switch(t.state){case"disabled":case"failed":case"warning":return!1;default:return!0}};return A.tsx("div",{slot:"control",style:"--calcite-ui-icon-color: #edd317"},A.tsx("calcite-action",{id:"statusIcon-action",class:b.widgetBlockActions,icon:s(),disabled:i(),text:"",slot:"control"}))},a.renderShowStatusIconTooltip=function(){const t=this.viewModel,s=()=>{switch(t.state){case"failed":case"warning":return t.errorMessage;default:return""}};if("disabled"!==t.state)return A.tsx("calcite-tooltip",{label:"statusIcon-status-tooltip-label",referenceElement:"statusIcon-action"},A.tsx("span",null,s()))},a.renderStructuralAttachmentAssociationsToggle=function(){const{messages:t}=this;return A.tsx("div",{class:b.widgetControlsLabelAndToggle},A.tsx("calcite-label",{class:b.widgetControlsLabel},t.inputStrings.enableStructuralAttachment),A.tsx("calcite-switch",{bind:this,disabled:!this._associationsOptionsEnabled&&this.autoRefreshAssociations,checked:this.includeStructuralAttachmentAssociations,onCalciteSwitchChange:this._structuralAttAssociationsSwitchChange}))},a._connectivityAssociationsSwitchChange=function(t){this.includeConnectivityAssociations=t.target.checked},a._maxAllowableAssociationsSliderChange=function(t){this.maxAllowableAssociations=Number(t.target.value)},a._refreshAssociations=function(){this.viewModel.showAssociations()},a._showAssociationsSwitchChange=function(t){this.showAssociationsEnabled=t.target.checked,this._associationsOptionsEnabled=t.target.checked},a._structuralAttAssociationsSwitchChange=function(t){this.includeStructuralAttachmentAssociations=t.target.checked},s._createClass(n,[{key:"autoRefreshAssociations",get:function(){return this._autoRefreshAssociations},set:function(t){this._autoRefreshAssociations=t}},{key:"connectivityAssociationsLineSymbol",get:function(){return this.viewModel.connectivityAssociationsLineSymbol},set:function(t){this.viewModel.connectivityAssociationsLineSymbol=t}},{key:"includeConnectivityAssociations",get:function(){return this.viewModel.includeConnectivityAssociations},set:function(t){this.viewModel.includeConnectivityAssociations=t}},{key:"includeStructuralAttachmentAssociations",get:function(){return this.viewModel.includeStructuralAttachmentAssociations},set:function(t){this.viewModel.includeStructuralAttachmentAssociations=t}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(t){this._overrideIfSome("label",t)}},{key:"maxAllowableAssociations",get:function(){return this.viewModel.maxAllowableAssociations},set:function(t){this.viewModel.maxAllowableAssociations=t}},{key:"maxAllowableAssociationsSliderMax",get:function(){return this._maxAllowableAssociationsSliderMax},set:function(t){t<=this.maxAllowableAssociationsSliderMin||(this._maxAllowableAssociationsSliderMax=t)}},{key:"maxAllowableAssociationsSliderMin",get:function(){return this._maxAllowableAssociationsSliderMin},set:function(t){t<0||t>=this.maxAllowableAssociationsSliderMax||(this._maxAllowableAssociationsSliderMin=t)}},{key:"maxAllowableAssociationsSliderStep",get:function(){return this._maxAllowableAssociationsSliderStep},set:function(t){this._maxAllowableAssociationsSliderStep=t}},{key:"showArrowsConnectivity",get:function(){return this.viewModel.showArrowsConnectivity},set:function(t){this.viewModel.showArrowsConnectivity=t}},{key:"showArrowsStructuralAttachment",get:function(){return this.viewModel.showArrowsStructuralAttachment},set:function(t){this.viewModel.showArrowsStructuralAttachment=t}},{key:"structuralAttachmentAssociationsLineSymbol",get:function(){return this.viewModel.structuralAttachmentAssociationsLineSymbol},set:function(t){this.viewModel.structuralAttachmentAssociationsLineSymbol=t}},{key:"utilityNetwork",get:function(){return this.viewModel.utilityNetwork},set:function(t){this.viewModel.utilityNetwork=t}},{key:"view",get:function(){return this.viewModel.view},set:function(t){this.viewModel.view=t}}]),n}(d);i.__decorate([n.property()],S.prototype,"connectivityAssociationsLineSymbol",null),i.__decorate([n.property()],S.prototype,"includeConnectivityAssociations",null),i.__decorate([n.property()],S.prototype,"includeStructuralAttachmentAssociations",null),i.__decorate([n.property()],S.prototype,"label",null),i.__decorate([n.property()],S.prototype,"maxAllowableAssociations",null),i.__decorate([n.property()],S.prototype,"maxAllowableAssociationsSliderMax",null),i.__decorate([n.property()],S.prototype,"maxAllowableAssociationsSliderMin",null),i.__decorate([n.property()],S.prototype,"maxAllowableAssociationsSliderStep",null),i.__decorate([n.property(),w.messageBundle("esri/widgets/UtilityNetworkAssociations/t9n/UtilityNetworkAssociations")],S.prototype,"messages",void 0),i.__decorate([n.property()],S.prototype,"showArrowsConnectivity",null),i.__decorate([n.property()],S.prototype,"showArrowsStructuralAttachment",null),i.__decorate([n.property()],S.prototype,"showAssociationsEnabled",void 0),i.__decorate([n.property()],S.prototype,"structuralAttachmentAssociationsLineSymbol",null),i.__decorate([n.property()],S.prototype,"utilityNetwork",null),i.__decorate([n.property()],S.prototype,"view",null),i.__decorate([n.property({type:p})],S.prototype,"viewModel",void 0),i.__decorate([n.property()],S.prototype,"visibleElements",void 0),i.__decorate([a.cast("visibleElements")],S.prototype,"castVisibleElements",null),S=i.__decorate([r.subclass("esri.widgets.UtilityNetworkAssociations")],S);return S}));
