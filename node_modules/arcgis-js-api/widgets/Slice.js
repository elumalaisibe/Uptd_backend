/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./Slice/SliceViewModel","./support/componentsUtils","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,i,s,l,r,o,n,c,a,u,d,p,y,_,h){"use strict";const v="esri-slice",x={buttonDisabled:"esri-button--disabled",layerIncludeButton:`${v}__cross`,widgetIcon:"esri-icon-slice",base:`${v} esri-widget esri-widget--panel`,layerList:`${v}__settings`,layerListHeading:`${v}__settings-title`,layerItem:`${v}__layer-item`,layerItemTitle:`${v}__layer-item__title`,container:`${v}__container`,actionSection:`${v}__actions`,hint:`${v}__hint`,hintText:`${v}__hint-text`,panelError:`${v}__panel--error`,newSliceButton:`${v}__clear-button esri-button esri-button--primary`,excludeButton:`${v}__exclude-button esri-button esri-button--secondary`,cancelButton:`${v}__cancel-button esri-button esri-button--secondary`};let w=function(i){function l(e,t){var s;return(s=i.call(this,e,t)||this).headingLevel=3,s.iconClass=x.widgetIcon,s.icon=null,s.messages=null,s.viewModel=new u,s}t._inherits(l,i);var r=l.prototype;return r.loadDependencies=function(){return d.loadCalciteComponents({button:()=>new Promise(((t,i)=>e(["../chunks/calcite-button"],t,i)))})},r.render=function(){const e=this.viewModel.supported,t=this.viewModel.active,i="disabled"===this.viewModel.state,s="ready"===this.viewModel.state,l="slicing"===this.viewModel.state||"sliced"===this.viewModel.state,r="exclude"===this.viewModel.layersMode,{messages:o}=this,n=i&&x.buttonDisabled,c=null!=this.viewModel.view&&this.viewModel.view.allLayerViews.some((e=>"voxel-3d"===e.type)),a=t&&!l||r?null:h.tsx("button",{disabled:i,class:this.classes(x.newSliceButton,n),bind:this,onclick:this._onNewSliceClick,key:"esri-slice__clear",type:"button"},o.newSlice),u=l&&!r?h.tsx("button",{class:this.classes(x.excludeButton,n),bind:this,onclick:()=>{this.viewModel.enterExcludeLayerMode()},key:"esri-slice__exclude",type:"button"},o.excludeLayer):null,d=t&&r?h.tsx("button",{class:this.classes(x.cancelButton,n),bind:this,onclick:()=>{this.viewModel.exitExcludeLayerMode()},key:"esri-slice__cancel-exclude",type:"button"},o.cancel):null;let y=null;t&&(r?y=o.excludeHint:s&&(y=c?o.voxelHint:o.hint));const _=y?h.tsx("div",{class:x.hint,key:"esri-slice__hint"},h.tsx("p",{class:x.hintText},y),h.tsx("p",{class:x.hintText},o.verticalHint)):null,v=this.excludedLayers?this.excludedLayers.toArray().map((e=>this._renderLayerItem({uid:e.uid,title:e.title,onClick:()=>(this.excludedLayers.remove(e),!1)}))):[];this.excludeGroundSurface&&v.push(this._renderLayerItem({uid:"ground",title:o.ground,onClick:()=>(this.excludeGroundSurface=!1,!1)}));const w=!r&&l&&v.length>0?h.tsx("div",{class:x.layerList,key:"esri-slice__settings"},h.tsx(p.Heading,{class:x.layerListHeading,level:this.headingLevel},o.excludedLayers),h.tsx("ul",null,v)):null,b=h.tsx("div",{class:x.panelError,key:"esri-slice__unsupported"},h.tsx("p",null,o.unsupported)),g=h.tsx("div",{class:x.actionSection},u,d,a),M=this.visible?h.tsx("div",{class:x.container},e?[_,w,g]:b):null;return h.tsx("div",{class:x.base,role:"presentation"},M)},r._renderLayerItem=function(e){return h.tsx("li",{class:x.layerItem,key:e.uid},h.tsx("calcite-button",{appearance:"transparent",class:x.layerIncludeButton,iconStart:"x",scale:"s",title:this.messages.includeLayer,bind:this,onclick:e.onClick}),h.tsx("div",{class:x.layerItemTitle},e.title))},r._onNewSliceClick=function(){s.ignoreAbortErrors(this.viewModel.start())},t._createClass(l,[{key:"active",get:function(){return this.viewModel.active}},{key:"analysis",get:function(){return this.viewModel.analysis},set:function(e){this.viewModel.analysis=e}},{key:"excludedLayers",get:function(){return this.viewModel.excludedLayers},set:function(e){this.viewModel.excludedLayers=e}},{key:"excludeGroundSurface",get:function(){return this.viewModel.excludeGroundSurface},set:function(e){this.viewModel.excludeGroundSurface=e}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}}]),l}(a);i.__decorate([l.property()],w.prototype,"active",null),i.__decorate([l.property({constructOnly:!0,nonNullable:!0})],w.prototype,"analysis",null),i.__decorate([l.property()],w.prototype,"excludedLayers",null),i.__decorate([l.property()],w.prototype,"excludeGroundSurface",null),i.__decorate([l.property()],w.prototype,"headingLevel",void 0),i.__decorate([l.property()],w.prototype,"iconClass",void 0),i.__decorate([l.property()],w.prototype,"icon",void 0),i.__decorate([l.property()],w.prototype,"label",null),i.__decorate([l.property(),_.messageBundle("esri/widgets/Slice/t9n/Slice")],w.prototype,"messages",void 0),i.__decorate([l.property()],w.prototype,"view",null),i.__decorate([l.property({type:u})],w.prototype,"viewModel",void 0),i.__decorate([l.property()],w.prototype,"visible",null),w=i.__decorate([c.subclass("esri.widgets.Slice")],w);return w}));
