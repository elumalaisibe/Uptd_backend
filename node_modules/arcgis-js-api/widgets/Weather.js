/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/memoize","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","../views/3d/environment/weather","./Widget","./support/componentsUtils","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Weather/css","./Weather/enums","./Weather/LabeledSlider","./Weather/VisibleElements","./Weather/WeatherViewModel"],(function(e,t,r,o,n,s,a,i,l,c,d,u,p,h,g,y,v,b,C,w,S){"use strict";const _={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let m=function(r){function n(e){var t;return(t=r.call(this,e)||this).viewModel=new S,t.headingLevel=4,t.visibleElements=new w,t.iconClass=v.CSS.widgetIcon,t.icon=null,t._renderWeatherTypeButton=e=>{const r=t.viewModel,o=t.messages[e].label,n=r.state===b.WeatherState.Disabled,s=!n&&r.current.type===e;return y.tsx("calcite-button",{appearance:s?"solid":"outline","aria-checked":s?"true":"false",kind:s?"brand":"neutral",disabled:n,iconStart:_[e],key:`${e}-type-button`,label:o,scale:"l",title:o,onclick:()=>{s||r.setWeatherByType(e)}})},t._memoizedCallbacks=o.memoize((e=>({onCloudCoverChange:t=>{"cloudCover"in e&&(e.cloudCover=t)},onPrecipitationChange:t=>{"precipitation"in e&&(e.precipitation=t)},onFogStrengthChange:t=>{"fogStrength"in e&&(e.fogStrength=t)},onSnowCoverChange:e=>{t.viewModel.setSnowCoverEnabled(e.target.checked)}}))),t}t._inherits(n,r);var s=n.prototype;return s.render=function(){const e=this.viewModel.state===b.WeatherState.Disabled;return y.tsx("div",{class:this.classes(v.CSS.base,v.CSS.esriWidget,e&&v.CSS.esriWidgetDisabled),role:"region","aria-label":this.messages.widgetLabelAccessible},this._renderContent())},s.loadDependencies=function(){return u.loadCalciteComponents({button:()=>new Promise(((t,r)=>e(["../chunks/calcite-button"],t,r))),checkbox:()=>new Promise(((t,r)=>e(["../chunks/calcite-checkbox"],t,r))),icon:()=>new Promise(((t,r)=>e(["../chunks/calcite-icon"],t,r))),label:()=>new Promise(((t,r)=>e(["../chunks/calcite-label"],t,r)))})},s._renderContent=function(){const e=this.messages,t=this._warningMessage,r=this.viewModel.state===b.WeatherState.Error;return y.tsx(y.tsxFragment,null,this.visibleElements.header&&y.tsx(p.Heading,{level:this.headingLevel},e.widgetLabel),r&&y.tsx("div",{key:"error",class:v.CSS.error},this._errorMessage),y.tsx("div",{key:"content",class:h.classes({[v.CSS.content]:!0,[v.CSS.hasError]:r})},y.tsx("div",{class:v.CSS.selector,role:"radiogroup","aria-label":e.weatherType},c.weatherTypesArray.map(this._renderWeatherTypeButton)),y.tsx("div",{class:v.CSS.options},this._renderOptions()),null!=t?this._renderWarning(t):null))},s._renderOptions=function(){const{viewModel:e,messages:t}=this,r=e.state===b.WeatherState.Disabled,o=e.current,n=this._memoizedCallbacks(o);switch(o.type){case"sunny":return y.tsx(C.LabeledSlider,{key:"sunny-cover",disabled:r,label:t.sunny.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange});case"cloudy":return y.tsx(C.LabeledSlider,{key:"cloudy-cover",disabled:r,label:t.cloudy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange});case"rainy":return y.tsx(y.tsxFragment,null,y.tsx(C.LabeledSlider,{key:"rainy-cover",disabled:r,label:t.rainy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange}),y.tsx(C.LabeledSlider,{key:"rainy-precipitation",disabled:r,label:t.rainy.precipitation,value:o.precipitation,onChange:n.onPrecipitationChange}));case"snowy":return y.tsx(y.tsxFragment,null,y.tsx(C.LabeledSlider,{key:"snowy-cloud-cover",disabled:r,label:t.snowy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange}),y.tsx(C.LabeledSlider,{key:"snowy-precipitation",disabled:r,label:t.snowy.precipitation,value:o.precipitation,onChange:n.onPrecipitationChange}),y.tsx("calcite-label",{key:"snow-cover",scale:"s",layout:"inline",title:t.snowy.snowCoverTooltip},y.tsx("calcite-checkbox",{checked:"enabled"===o.snowCover,disabled:r,onCalciteCheckboxChange:n.onSnowCoverChange}),t.snowy.snowCover));case"foggy":return y.tsx(C.LabeledSlider,{key:"foggy-cover",disabled:r,label:t.foggy.fogStrength,value:o.fogStrength,onChange:n.onFogStrengthChange})}},s._renderWarning=function(e){return y.tsx("div",{key:"warning",class:v.CSS.warning},y.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)},t._createClass(n,[{key:"view",get:function(){return this.viewModel?.view},set:function(e){this.viewModel&&(this.viewModel.view=e)}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"_errorMessage",get:function(){const e=this.messages.error;switch(this.viewModel.error){case b.WeatherError.LocalScene:return e.localScene;case b.WeatherError.NoAtmosphere:return e.noAtmosphere;case b.WeatherError.UnsupportedView:return e.unsupported;default:return null}}},{key:"_warningMessage",get:function(){if(this.viewModel.error===b.WeatherError.NotVisible){return null!=this.view&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}return null}}]),n}(d);r.__decorate([n.property()],m.prototype,"viewModel",void 0),r.__decorate([n.property()],m.prototype,"view",null),r.__decorate([n.property()],m.prototype,"headingLevel",void 0),r.__decorate([n.property({type:w,nonNullable:!0})],m.prototype,"visibleElements",void 0),r.__decorate([n.property()],m.prototype,"iconClass",void 0),r.__decorate([n.property()],m.prototype,"icon",void 0),r.__decorate([n.property()],m.prototype,"label",null),r.__decorate([n.property(),g.messageBundle("esri/widgets/Weather/t9n/Weather")],m.prototype,"messages",void 0),r.__decorate([n.property()],m.prototype,"_errorMessage",null),r.__decorate([n.property()],m.prototype,"_warningMessage",null),m=r.__decorate([l.subclass("esri.widgets.Weather")],m);return m}));
