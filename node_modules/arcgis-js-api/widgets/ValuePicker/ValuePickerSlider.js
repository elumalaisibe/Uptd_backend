/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/promiseUtils","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../Slider","../support/componentsUtils","../support/widgetUtils","../support/jsxFactory","./ValuePickerBaseComponent","./ValuePickerSliderVisibleElements"],(function(e,t,i,s,o,r,l,n,a,u,c,p,d,h,_,v){"use strict";const m="esri-value-picker__slider",y={minorTick:`${m}__tick-minor`,majorTick:`${m}__tick-major`,stepsTick:`${m}__tick-steps`,tooltip:`${m}__tooltip`};function k(e){return(t,i)=>{i?.classList.add(e)}}let b=function(i){function r(e,t){var o;return(o=i.call(this,e,t)||this)._majorTickCreatedFunction=k(y.majorTick),o._minorTickCreatedFunction=k(y.minorTick),o._stepsTickCreatedFunction=k(y.stepsTick),o._thumbNode=null,o._tooltip=null,o._slider=new c({thumbCreatedFunction:(e,t,i)=>{o._thumbNode=i}}),o.labelFormatFunction=null,o.labels=null,o.min=null,o.minorTicks=null,o.majorTicks=null,o.max=null,o.reversed=!1,o.steps=null,o.type="slider",o.visibleElements=new v,o._thumbDragDebounced=s.debounce((async e=>{await(o._tooltip?.reposition(!1))})),o}t._inherits(r,i);var l=r.prototype;return l.initialize=function(){this.addHandles([o.watch((()=>this.viewModel?.values),(e=>{this._slider.values=e}),o.initial),o.watch((()=>this._slider.values),(e=>{this.viewModel&&this.viewModel.values!==e&&(this.viewModel.values=e)})),this._slider.on("thumb-drag",this._thumbDragDebounced)])},l.destroy=function(){this._slider.destroy()},l.loadDependencies=function(){return p.loadCalciteComponents({tooltip:()=>new Promise(((t,i)=>e(["../../chunks/calcite-tooltip"],t,i)))})},l.render=function(){const{labels:e,labelFormatFunction:t,min:i,max:s,steps:o,minorTicks:r,majorTicks:l,reversed:n,viewModel:a}=this;if(!a)return h.tsx("div",null);const{disabled:u,layout:c}=a,p=`${c}${n?"-reversed":""}`,d="position",_=[];return null!=i&&null!=s&&(r&&_.push({mode:d,values:r,tickCreatedFunction:this._minorTickCreatedFunction}),l&&_.push({mode:d,values:l,tickCreatedFunction:this._majorTickCreatedFunction}),e&&_.push({mode:d,values:e,labelsVisible:!0}),this.visibleElements.steps&&this.steps&&_.push({mode:d,values:this.steps,tickCreatedFunction:this._stepsTickCreatedFunction})),this._slider.set({disabled:u,labelFormatFunction:t,layout:p,min:i,max:s,steps:o,tickConfigs:_}),h.tsx("div",{class:m},this._slider.render(),this._renderToolTip())},l.animate=function(e){this._step(1,e)},l.next=function(){this._step(this._ascending?1:-1)},l.previous=function(){this._step(this._ascending?-1:1)},l._onTooltipAfterCreate=function(e){this._tooltip=e},l._renderToolTip=function(){if(!this.visibleElements.thumbTooltip||!this._thumbNode||!this._slider.values)return null;const e=this._slider.viewModel.getLabelForValue(this._slider.values[0],"value");return e?h.tsx("calcite-tooltip",{afterCreate:this._onTooltipAfterCreate,class:y.tooltip,label:e,referenceElement:this._thumbNode},e):null},l._step=function(e,t=!1){if(!this.viewModel||!this.steps?.length)return;if(!this.viewModel.values||!this.steps.includes(this.viewModel.values[0]))return void(this.viewModel.values=[this.steps[0]]);const i=this.steps.indexOf(this.viewModel.values[0])+e;i<0||i>=this.steps.length?this.viewModel.loop||t?this.viewModel.values=[this.steps[1===e?0:this.steps.length-1]]:"playing"===this.viewModel.state&&this.viewModel.pause():this.viewModel.values=[this.steps[i]]},t._createClass(r,[{key:"_ascending",get:function(){const{reversed:e,viewModel:t}=this;if(!t)return null;const{layout:i}=t;return"horizontal"===i&&!e||"vertical"===i&&e}},{key:"canNext",get:function(){const{_ascending:e,min:t,max:i,steps:s,viewModel:o}=this;if(null==e||null==t||null==i||!s?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(e?l!==s[s.length-1]:l!==s[0])}},{key:"canPlay",get:function(){return null!=this.viewModel&&!!this.steps?.length&&null!=this.min&&null!=this.max}},{key:"canPrevious",get:function(){const{_ascending:e,min:t,max:i,steps:s,viewModel:o}=this;if(null==e||null==t||null==i||!s?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(e?l!==s[0]:l!==s[s.length-1])}}]),r}(_);i.__decorate([r.property()],b.prototype,"_ascending",null),i.__decorate([r.property()],b.prototype,"canNext",null),i.__decorate([r.property()],b.prototype,"canPlay",null),i.__decorate([r.property()],b.prototype,"canPrevious",null),i.__decorate([r.property()],b.prototype,"labelFormatFunction",void 0),i.__decorate([r.property()],b.prototype,"labels",void 0),i.__decorate([r.property()],b.prototype,"min",void 0),i.__decorate([r.property()],b.prototype,"minorTicks",void 0),i.__decorate([r.property()],b.prototype,"majorTicks",void 0),i.__decorate([r.property()],b.prototype,"max",void 0),i.__decorate([r.property({nonNullable:!0})],b.prototype,"reversed",void 0),i.__decorate([r.property()],b.prototype,"steps",void 0),i.__decorate([r.property()],b.prototype,"type",void 0),i.__decorate([r.property({type:v,nonNullable:!0})],b.prototype,"visibleElements",void 0),b=i.__decorate([u.subclass("esri.widgets.ValuePicker.ValuePickerSlider")],b);return b}));
