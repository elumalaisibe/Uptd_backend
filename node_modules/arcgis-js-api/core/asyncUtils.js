/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./maybe","./promiseUtils","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(r,t,e,o,n,l,u,a){"use strict";function s(r,t,e){return l.eachAlways(r.map(((r,o)=>t.apply(e,[r,o]))))}async function c(r,t,e){return(await l.eachAlways(r.map(((r,o)=>t.apply(e,[r,o]))))).map((r=>r.value))}function i(r){return{ok:!0,value:r}}function p(r){return{ok:!1,error:r}}function _(r){return null!=r&&!0===r.ok?r.value:null}function y(r){return null!=r&&!1===r.ok?r.error:null}async function b(r){if(null==r)return{ok:!1,error:new Error("no promise provided")};try{return i(await r)}catch(t){return p(t)}}async function f(r){try{return i(await r)}catch(t){return l.throwIfAbortError(t),p(t)}}function d(r){if(!0===r.ok)return r.value;throw r.error}function h(r,t){return new k(r,t)}let k=function(r){function e(t,e){var o;(o=r.call(this,{})||this)._result=null,o._abortHandle=null,o.abort=()=>{o._abortController=n.abortMaybe(o._abortController)},o.remove=o.abort,o._abortController=new AbortController;const{signal:u}=o._abortController;return o.promise=t(u),o.promise.then((r=>{o._result=i(r),o._cleanup()}),(r=>{o._result=p(r),o._cleanup()})),o._abortHandle=l.onAbort(e,o.abort),o}t._inherits(e,r);var o=e.prototype;return o.normalizeCtorArgs=function(){return{}},o.destroy=function(){this.abort()},o._cleanup=function(){this._abortHandle=n.removeMaybe(this._abortHandle),this._abortController=null},t._createClass(e,[{key:"value",get:function(){return _(this._result)}},{key:"error",get:function(){return y(this._result)}},{key:"finished",get:function(){return null!=this._result}}]),e}(o);e.__decorate([u.property()],k.prototype,"value",null),e.__decorate([u.property()],k.prototype,"error",null),e.__decorate([u.property()],k.prototype,"finished",null),e.__decorate([u.property()],k.prototype,"promise",void 0),e.__decorate([u.property()],k.prototype,"_result",void 0),k=e.__decorate([a.subclass("esri.core.asyncUtils.ReactiveTask")],k),r.assertResult=d,r.createTask=h,r.forEach=s,r.makeResultError=p,r.makeResultOk=i,r.map=c,r.result=b,r.resultError=y,r.resultOrAbort=f,r.resultValue=_,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
