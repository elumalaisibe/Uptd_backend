/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./maybe","./promiseUtils","./accessorSupport/decorators/subclass"],(function(s,e,i,r,t,o,n){"use strict";var l;!function(s){s[s.PENDING=0]="PENDING",s[s.RESOLVED=1]="RESOLVED",s[s.REJECTED=2]="REJECTED"}(l||(l={}));let u=function(){function s(){this._resolver=o.createResolver(),this._status=l.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=l.RESOLVED,this._cleanUp()}),(()=>{this._status=l.REJECTED,this._cleanUp()})),this.promise=this._resolver.promise}var i=s.prototype;return i.destroy=function(){this._cleanUp()},i.addResolvingPromise=function(s){this._resolvingPromises.push(s),this._tryResolve()},i.isResolved=function(){return this._status===l.RESOLVED},i.isRejected=function(){return this._status===l.REJECTED},i.isFulfilled=function(){return this._status!==l.PENDING},i.abort=function(){this._resolver.reject(o.createAbortError())},i._cleanUp=function(){this._allPromise=null,this._resolvingPromises=null},i._tryResolve=function(){if(this.isFulfilled())return;const s=o.createResolver(),e=[...this._resolvingPromises,t.assumeNonNull(s.promise)],i=this._allPromise=Promise.all(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()}),(s=>{this.isFulfilled()||this._allPromise!==i||o.isAbortError(s)||this._resolver.reject(s)})),s.resolve()},e._createClass(s)}();const c=s=>{let r=function(s){function i(...e){var i;return(i=s.call(this,...e)||this)._promiseProps=new u,i.addResolvingPromise(Promise.resolve()),i}e._inherits(i,s);var r=i.prototype;return r.destroy=function(){this._promiseProps?.destroy()},r.isResolved=function(){return this._promiseProps.isResolved()},r.isRejected=function(){return this._promiseProps.isRejected()},r.isFulfilled=function(){return this._promiseProps.isFulfilled()},r.when=function(s,e){return this._promiseProps.promise.then((()=>this)).then(s,e)},r.catch=function(s){return this.when(null,s)},r.addResolvingPromise=function(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)},e._createClass(i)}(s);return r=i.__decorate([n.subclass("esri.core.Promise")],r),r};s.EsriPromise=function(s){function i(){return s.apply(this,arguments)||this}return e._inherits(i,s),e._createClass(i)}(c(r)),s.EsriPromise=i.__decorate([n.subclass("esri.core.Promise")],s.EsriPromise),s.EsriPromiseMixin=c,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})}));
