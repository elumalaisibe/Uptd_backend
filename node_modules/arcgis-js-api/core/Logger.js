/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../config","./has","./string"],(function(e,t,n,r){"use strict";const o={info:0,warn:1,error:2,none:3};let i=function(){function n(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,n._loggers.set(this.module,this);const t=this.module.lastIndexOf(".");-1!==t&&(this._parent=n.getLogger(this.module.slice(0,t)))}var i=n.prototype;return i.error=function(...e){this._log("error","always",...e)},i.warn=function(...e){this._log("warn","always",...e)},i.info=function(...e){this._log("info","always",...e)},i.errorOnce=function(...e){this._log("error","once",...e)},i.warnOnce=function(...e){this._log("warn","once",...e)},i.infoOnce=function(...e){this._log("info","once",...e)},i.errorOncePerTick=function(...e){this._log("error","oncePerTick",...e)},i.warnOncePerTick=function(...e){this._log("warn","oncePerTick",...e)},i.infoOncePerTick=function(...e){this._log("info","oncePerTick",...e)},n.getLogger=function(e){return e="string"!=typeof e?e.declaredClass:e,n._loggers.get(e)||new n({module:e})},i._log=function(e,r,...o){if(!this._matchLevel(e))return;if("always"!==r&&!n._throttlingDisabled){const t=this._argsToKey(o),i=this._loggedMessages[e].get(t);if("once"===r&&null!=i||"oncePerTick"===r&&i&&i>=n._tickCounter)return;this._loggedMessages[e].set(t,n._tickCounter),n._scheduleTickCounterIncrement()}for(const n of t.log.interceptors)if(n(e,this.module,...o))return;this._inheritedWriter()(e,this.module,...o)},i._parentWithMember=function(e,t){let n=this;for(;null!=n;){const t=n[e];if(null!=t)return t;n=n.parent}return t},i._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)},i._consoleWriter=function(e,t,...n){console[e](`[${t}]`,...n)},i._matchLevel=function(e){const n=t.log.level||"warn";return o[this._parentWithMember("level",n)]<=o[e]},i._argsToKey=function(...e){const t=(e,t)=>"object"!=typeof t||Array.isArray(t)?t:"[Object]";return r.numericHash(JSON.stringify(e,t))},n._scheduleTickCounterIncrement=function(){n._tickCounterScheduled||(n._tickCounterScheduled=!0,Promise.resolve().then((()=>{n._tickCounter++,n._tickCounterScheduled=!1})))},e._createClass(n,[{key:"module",get:function(){return this._module}},{key:"parent",get:function(){return this._parent}},{key:"test",get:function(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}}],[{key:"test",get:function(){return{resetLoggers(e=new Map){const t=n._loggers;return n._loggers=e,t},set throttlingDisabled(e){n._throttlingDisabled=e}}}}]),n}();return i._loggers=new Map,i._tickCounter=0,i._tickCounterScheduled=!1,i._throttlingDisabled=!1,i}));
