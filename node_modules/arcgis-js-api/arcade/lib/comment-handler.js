/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","./types"],(function(t,n,e){"use strict";function s(t,n){return!!n&&(n.loc.end.line===t.loc.start.line&&n.loc.end.column<=t.loc.start.column)}function i(t,n){return t.range[0]>=n.range[0]&&t.range[1]<=n.range[1]}let o=function(){function t(){this.comments=[],this._nodeStack=[],this._newComments=[]}var o=t.prototype;return o.insertInnerComments=function(t){if(!e.isBlockStatement(t)||0!==t.body.length)return;const n=[];for(let e=this._newComments.length-1;e>=0;--e){const s=this._newComments[e];t.range[1]>=s.range[0]&&(n.unshift(s),this._newComments.splice(e,1))}n.length&&(t.innerComments=n)},o.attachTrailingComments=function(t){if(!t)return;const n=this._nodeStack[this._nodeStack.length-1];if(e.isBlockStatement(t)&&i(n,t))for(let e=this._newComments.length-1;e>=0;--e){const s=this._newComments[e];i(s,t)&&(n.trailingComments=[...n.trailingComments??[],s],this._newComments.splice(e,1))}let o=[];if(this._newComments.length>0)for(let e=this._newComments.length-1;e>=0;--e){const i=this._newComments[e];s(i,n)?(n.trailingComments=[...n.trailingComments??[],i],this._newComments.splice(e,1)):s(i,t)&&(o.unshift(i),this._newComments.splice(e,1))}if(n?.trailingComments){s(n.trailingComments[0],t)&&(o=[...o,...n.trailingComments],delete n.trailingComments)}o.length>0&&(t.trailingComments=o)},o.attachLeadingComments=function(t){if(!t)return;let n;for(;this._nodeStack.length>0;){const e=this._nodeStack[this._nodeStack.length-1];if(!(t.range[0]<=e.range[0]))break;n=e,this._nodeStack.pop()}const s=[],i=[];if(n){for(let o=(n.leadingComments?.length??0)-1;o>=0;--o){const m=n.leadingComments[o];t.range[0]>=m.range[1]?(s.unshift(m),n.leadingComments.splice(o,1)):e.isVariableDeclarator(t)&&!e.isBlockComment(m)&&(i.unshift(m),n.leadingComments.splice(o,1))}return 0===n.leadingComments?.length&&delete n.leadingComments,s.length&&(t.leadingComments=s),void(i.length&&(t.trailingComments=[...i,...t.trailingComments??[]]))}for(let e=this._newComments.length-1;e>=0;--e){const n=this._newComments[e];t.range[0]>=n.range[0]&&(s.unshift(n),this._newComments.splice(e,1))}s.length&&(t.leadingComments=s)},o.attachComments=function(t){if(e.isProgram(t)&&t.body.length>0){const n=this._nodeStack[this._nodeStack.length-1];return n?(n.trailingComments=[...n.trailingComments??[],...this._newComments],this._newComments.length=0,void this._nodeStack.pop()):(t.trailingComments=[...this._newComments],void(this._newComments.length=0))}this.attachTrailingComments(t),this.attachLeadingComments(t),this.insertInnerComments(t),this._nodeStack.push(t)},o.collectComment=function(t){this.comments.push(t),this._newComments.push(t)},n._createClass(t)}();t.CommentHandler=o,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
