/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],(function(e,t,n,i,r){"use strict";const s=.001;let o=function(){function e(){}return e.local=function(){return null===e.instance&&(e.instance=new e),e.instance},e.prototype.execute=function(e,t,n,i,r){return new a(e,t,n)},t._createClass(e)}();o.instance=null;let a=function(e){function n(t,n,r){var o;return(o=e.call(this,t)||this)._curveHelper=new i.CurveHelper,o._angleToLine=void 0===n.angleToLine||n.angleToLine,o._offset=void 0!==n.offset?n.offset*r:0,o._relativeTo=n.relativeTo,o._position=void 0!==n.startPointOffset?n.startPointOffset*r:0,o._epsilon=s*r,o}t._inherits(n,e);var o=n.prototype;return o.processPath=function(e){const t=this._position;if(this._relativeTo===r.PlacementOnLineRelativeTo.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[t,n]=[e.x,e.y],[i,r]=[0,0];for(;e.nextPoint();){i=e.x,r=e.y;const s=this._curveHelper.getLength(t,n,i,r);if(s<this._epsilon){t=i,n=r;continue}const o=.5+this._position/s,[a,l]=this._curveHelper.getAngleCS(t,n,i,r,o),c=this._curveHelper.getCoord2D(t,n,i,r,o);return this.internalPlacement.setTranslate(c[0]-this._offset*l,c[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(a,l),this.internalPlacement}}return this.iteratePath=!1,null}const n=this._relativeTo===r.PlacementOnLineRelativeTo.LineEnd;return this.onLine(e,t,n)},o.onLine=function(e,t,n){let i,s=!1;switch(this._relativeTo){case r.PlacementOnLineRelativeTo.LineMiddle:default:e.seekPathStart(),i=e.pathLength()/2+t;break;case r.PlacementOnLineRelativeTo.LineBeginning:i=t;break;case r.PlacementOnLineRelativeTo.LineEnd:i=t,s=!0}n?e.seekPathEnd():e.seekPathStart();let o=0;if(n?e.prevPoint():e.nextPoint()){let[t,r]=[e.x,e.y],[a,l]=[0,0];for(;n?e.prevPoint():e.nextPoint();){a=e.x,l=e.y;const n=this._curveHelper.getLength(t,r,a,l);if(o+n>i){const e=(i-o)/n,[c,h]=this._curveHelper.getAngleCS(t,r,a,l,e),u=this._curveHelper.getCoord2D(t,r,a,l,e),f=s?-this._offset:this._offset;return this.internalPlacement.setTranslate(u[0]-f*h,u[1]+f*c),this._angleToLine&&(s?this.internalPlacement.setRotateCS(-c,-h):this.internalPlacement.setRotateCS(c,h)),this.internalPlacement}t=a,r=l,o+=n}}return null},t._createClass(n)}(n.PathTransformationCursor);e.PlacementOnLine=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
