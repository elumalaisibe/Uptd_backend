/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry/GeometryCursor","../enums","../GeometryWalker"],(function(t,e,i,s,n){"use strict";let h=function(){function t(){}return t.local=function(){return null===t.instance&&(t.instance=new t),t.instance},t.prototype.execute=function(t,e,i,s,n){return new r(t,e,i)},e._createClass(t)}();h.instance=null;let r=function(){function t(t,e,i){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*i,this._period=(void 0!==e.period?e.period:3)*i,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new n.DashPattern,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new n.GeometryWalker,this._walker.updateTolerance(i)}var h=t.prototype;return h.next=function(){let t=this._inputGeometries.next();for(;t;){if(0===this._height||0===this._period)return t;const e=this._processGeom(t);if(e)return e;t=this._inputGeometries.next()}return null},h._processGeom=function(t){const e=i.GeometryCursor.createEmptyOptimizedCIM(t.geometryType);for(;t.nextPath();){e.startPath();const i=t.pathLength();if(this._walker.init(t,this._pattern))switch(this._style){case s.GeometricEffectWaveform.Sinus:default:this._constructCurve(e,i,!1);break;case s.GeometricEffectWaveform.Square:this._constructSquare(e,i);break;case s.GeometricEffectWaveform.Triangle:this._constructTriangle(e,i);break;case s.GeometricEffectWaveform.Random:this._constructCurve(e,i,!0)}else for(;t.nextPoint();)e.pushXY(t.x,t.y)}return e},h._constructCurve=function(t,e,i){let s=Math.round(e/this._period);0===s&&(s=1);const h=s*16+1,r=e/s,o=this._period/16,a=1/h,u=2*Math.PI*e/r,c=2*Math.PI*Math.random(),p=2*Math.PI*Math.random(),_=2*Math.PI*Math.random(),l=.75-Math.random()/2,d=.75-Math.random()/2,f=new n.Pos;this._walker.curPointAndAngle(f),t.pushPoint(f.pt);let g=0;for(;;){if(!this._walker.nextPointAndAngle(o,f)){t.pushPoint(this._walker.getPathEnd());break}{const e=g;let s;if(g+=a,i){const t=this._height/2*(1+.3*Math.sin(l*u*e+c));s=t*Math.sin(u*e+p),s+=t*Math.sin(d*u*e+_),s/=2}else s=.5*this._height*Math.sin(.5*u*e);t.pushXY(f.pt[0]-s*f.sa,f.pt[1]+s*f.ca)}}},h._constructSquare=function(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new n.Pos;this._walker.curPointAndAngle(s);const h=new n.Pos;if(this._walker.nextPointAndAngle(this._period,h)){const r=new n.Pos;this._walker.nextPointAndAngle(this._period,r)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca),t.pushXY(h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca),t.pushXY(h.pt[0]+this._height/2*h.sa,h.pt[1]-this._height/2*h.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}},h._constructTriangle=function(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new n.Pos;this._walker.curPointAndAngle(s);const h=new n.Pos;if(this._walker.nextPointAndAngle(this._period/2,h)){const r=new n.Pos;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}},e._createClass(t)}();t.EffectWave=h,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
