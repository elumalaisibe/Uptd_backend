/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry","../../../geometry/GeometryCursor","../../../geometry/geometryCursorCollectUtils","../CIMEffects","../CurveHelper","../enums","../../../geometry/SpatialReference"],(function(e,t,i,r,n,s,o,u,l){"use strict";let f=function(){function e(){}return e.local=function(){return null===e.instance&&(e.instance=new e),e.instance},e.prototype.execute=function(e,t,i,r,n,s){return new c(e,t,i,r,n,s)},t._createClass(e)}();f.instance=null;let c=function(){function e(e,t,i,r,n,s){this._inputGeometries=e,this._tileKey=r,this._geometryEngine=n,this._curveHelper=new o.CurveHelper,this._size=(void 0!==t.size?t.size:1)*i,this._maxInflateSize=s*i,this._offsetFlattenError=o.PIXEL_TOLERANCE*i}return e.prototype.next=function(){let e;for(;e=this._inputGeometries.next();){if(0===this._size)return e;if("esriGeometryEnvelope"===e.geometryType)if(this._size>0){const t=r.GeometryCursor.createEmptyOptimizedCIM(e.geometryType),i=n.collectMultipath(e)[0],s=this._curveHelper.offset(i,this._size,u.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(s)return t.pushPath(s),t}else if(this._size<0){const t=e.asJSON();if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return r.GeometryCursor.fromJSONCIM({xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size})}const t=this._geometryEngine;if(null==t)return null;const i=this._tileKey?s.clipCursorToTileExtent(e,this._maxInflateSize):e;if(!i)continue;const o=t.buffer(l.WebMercator,i.asJSON(),this._size,1);return o?r.GeometryCursor.fromJSONCIM(o):null}return null},t._createClass(e)}();e.EffectBuffer=f,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
