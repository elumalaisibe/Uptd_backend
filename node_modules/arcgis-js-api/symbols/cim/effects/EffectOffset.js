/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry","../../../geometry/GeometryCursor","../../../geometry/geometryCursorCollectUtils","../../../geometry/support/jsonUtils","../CIMEffects","../CurveHelper","../enums","../../../geometry/SpatialReference"],(function(e,t,o,n,r,s,i,f,l,u){"use strict";let m=function(){function e(){}return e.local=function(){return null===e.instance&&(e.instance=new e),e.instance},e.prototype.execute=function(e,t,o,n,r,s){return new c(e,t,o,n,r,s)},t._createClass(e)}();m.instance=null;let c=function(){function e(e,t,o,n,r,s){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=r,this._curveHelper=new f.CurveHelper,this._offset=(t.offset??1)*o,this._method=t.method,this._maxInflateSize=s*o,this._option=t.option,this._offsetFlattenError=f.PIXEL_TOLERANCE*o}return e.prototype.next=function(){let e;for(;e=this._inputGeometries.next();){if(0===this._offset)return e.clone();if("esriGeometryEnvelope"===e.geometryType){if(this._method===l.GeometricEffectOffsetMethod.Rounded&&this._offset>0){const t=r.collectPath(e),o=this._curveHelper.offset(t,-this._offset,this._method,4,this._offsetFlattenError);if(o){const t=n.GeometryCursor.createEmptyOptimizedCIM(e.geometryType);return t.pushPath(o),t}return null}const t=e.asJSON();if(s.isExtent(t)&&Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._offset>0)return n.GeometryCursor.fromJSONCIM({xmin:t.xmin-this._offset,xmax:t.xmax+this._offset,ymin:t.ymin-this._offset,ymax:t.ymax+this._offset})}const t=this._geometryEngine;if(null==t)continue;const o=this._tileKey?i.clipCursorToTileExtent(e,this._maxInflateSize):e.clone();if(!o)continue;const f=t.offset(u.WebMercator,o.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return f?n.GeometryCursor.fromJSONCIM(f):null}return null},t._createClass(e)}();e.EffectOffset=m,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
