/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Logger","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","../portal/Portal","../chunks/persistableUrlUtils","./Symbol","./support/Thumbnail"],(function(e,t,r,o,l,s,n,a,c,i,p,y,u,h,m){"use strict";var b;let f=b=function(r){function s(e){var t;return(t=r.call(this,e)||this).styleName=null,t.portal=null,t.styleUrl=null,t.thumbnail=null,t.name=null,t.type="web-style",t}t._inherits(s,r);var n=s.prototype;return n.read=function(e,r){this.portal=r?.portal,t._get(t._getPrototypeOf(s.prototype),"read",this).call(this,e,r)},n.clone=function(){return new b({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})},n.fetchSymbol=function(e){return this._fetchSymbol("webRef",e)},n.fetchCIMSymbol=function(e){return this._fetchSymbol("cimRef",e)},n._fetchSymbol=async function(t,r){const s=null!=r?r.cache:null,n=s?this._fetchCacheKey:null;if(null!=s){const e=n&&s.get(n);if(e)return e.clone()}const{resolveWebStyleSymbol:a}=await new Promise(((t,r)=>e(["./support/webStyleSymbolUtils"],t,r)));l.throwIfAborted(r);const c=a(this,{portal:this.portal},t,r);c.catch((e=>{o.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",e)}));const i=await c;return"webRef"===t&&"point-3d"===i.type||"cimRef"===t&&"cim"===i.type?(null!=s&&s.set(n,i.clone()),i):null},t._createClass(s,[{key:"_fetchCacheKey",get:function(){const e=null!=this.portal?this.portal:y.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}}]),s}(h);r.__decorate([s.property({json:{write:!1}})],f.prototype,"color",void 0),r.__decorate([s.property({type:String,json:{write:!0}})],f.prototype,"styleName",void 0),r.__decorate([s.property({type:y,json:{write:!1}})],f.prototype,"portal",void 0),r.__decorate([s.property({type:String,json:{read:u.read,write:u.write}})],f.prototype,"styleUrl",void 0),r.__decorate([s.property({type:m.Thumbnail,json:{read:!1}})],f.prototype,"thumbnail",void 0),r.__decorate([s.property({type:String,json:{write:!0}})],f.prototype,"name",void 0),r.__decorate([i.enumeration({styleSymbolReference:"web-style"},{readOnly:!0})],f.prototype,"type",void 0),r.__decorate([s.property()],f.prototype,"_fetchCacheKey",null),f=b=r.__decorate([p.subclass("esri.symbols.WebStyleSymbol")],f);return f}));
